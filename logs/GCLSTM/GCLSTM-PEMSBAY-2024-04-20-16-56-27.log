PEMSBAY
Trainset:	x-(36465, 12, 325, 1)	y-(36465, 12, 325, 1)
Valset:  	x-(5209, 12, 325, 1)  	y-(5209, 12, 325, 1)
Testset:	x-(10419, 12, 325, 1)	y-(10419, 12, 325, 1)

Random seed = 233
--------- GCLSTM ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "lr": 0.001,
    "weight_decay": 0,
    "milestones": [
        12,
        50
    ],
    "clip_grad": 0,
    "batch_size": 64,
    "max_epochs": 200,
    "pass_device": true,
    "model_args": {
        "num_nodes": 325,
        "input_dim": 1,
        "output_dim": 1,
        "horizon": 12,
        "rnn_units": 64,
        "num_layers": 1,
        "cheb_k": 3,
        "adj_path": "../data/PEMSBAY/adj_mx_bay.pkl",
        "adj_type": "doubletransition",
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
GCLSTM                                   [64, 12, 325, 1]          --
├─Encoder: 1-1                           [64, 325, 64]             --
│    └─ModuleList: 2-1                   --                        --
│    │    └─LSTMCell: 3-1                [64, 325, 64]             100,096
│    │    └─LSTMCell: 3-2                [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-3                [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-4                [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-5                [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-6                [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-7                [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-8                [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-9                [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-10               [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-11               [64, 325, 64]             (recursive)
│    │    └─LSTMCell: 3-12               [64, 325, 64]             (recursive)
├─Decoder: 1-2                           [64, 325, 64]             --
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-13               [64, 325, 64]             100,096
├─Sequential: 1-3                        [64, 325, 1]              --
│    └─Linear: 2-3                       [64, 325, 1]              65
├─Decoder: 1-4                           [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-14               [64, 325, 64]             (recursive)
├─Sequential: 1-5                        [64, 325, 1]              (recursive)
│    └─Linear: 2-5                       [64, 325, 1]              (recursive)
├─Decoder: 1-6                           [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-15               [64, 325, 64]             (recursive)
├─Sequential: 1-7                        [64, 325, 1]              (recursive)
│    └─Linear: 2-7                       [64, 325, 1]              (recursive)
├─Decoder: 1-8                           [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-16               [64, 325, 64]             (recursive)
├─Sequential: 1-9                        [64, 325, 1]              (recursive)
│    └─Linear: 2-9                       [64, 325, 1]              (recursive)
├─Decoder: 1-10                          [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-17               [64, 325, 64]             (recursive)
├─Sequential: 1-11                       [64, 325, 1]              (recursive)
│    └─Linear: 2-11                      [64, 325, 1]              (recursive)
├─Decoder: 1-12                          [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-18               [64, 325, 64]             (recursive)
├─Sequential: 1-13                       [64, 325, 1]              (recursive)
│    └─Linear: 2-13                      [64, 325, 1]              (recursive)
├─Decoder: 1-14                          [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-19               [64, 325, 64]             (recursive)
├─Sequential: 1-15                       [64, 325, 1]              (recursive)
│    └─Linear: 2-15                      [64, 325, 1]              (recursive)
├─Decoder: 1-16                          [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-20               [64, 325, 64]             (recursive)
├─Sequential: 1-17                       [64, 325, 1]              (recursive)
│    └─Linear: 2-17                      [64, 325, 1]              (recursive)
├─Decoder: 1-18                          [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-21               [64, 325, 64]             (recursive)
├─Sequential: 1-19                       [64, 325, 1]              (recursive)
│    └─Linear: 2-19                      [64, 325, 1]              (recursive)
├─Decoder: 1-20                          [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-22               [64, 325, 64]             (recursive)
├─Sequential: 1-21                       [64, 325, 1]              (recursive)
│    └─Linear: 2-21                      [64, 325, 1]              (recursive)
├─Decoder: 1-22                          [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-23               [64, 325, 64]             (recursive)
├─Sequential: 1-23                       [64, 325, 1]              (recursive)
│    └─Linear: 2-23                      [64, 325, 1]              (recursive)
├─Decoder: 1-24                          [64, 325, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-24               [64, 325, 64]             (recursive)
├─Sequential: 1-25                       [64, 325, 1]              (recursive)
│    └─Linear: 2-25                      [64, 325, 1]              (recursive)
==========================================================================================
Total params: 200,257
Trainable params: 200,257
Non-trainable params: 0
Total mult-adds (M): 0.05
==========================================================================================
Input size (MB): 1.00
Forward/backward pass size (MB): 1024.36
Params size (MB): 0.80
Estimated Total Size (MB): 1026.16
==========================================================================================

Loss: MaskedMAELoss

2024-04-20 16:56:58.449717 Epoch 1  	Train Loss = 2.11194 Val Loss = 2.08859
2024-04-20 16:57:24.408416 Epoch 2  	Train Loss = 1.86133 Val Loss = 2.02019
2024-04-20 16:57:50.555772 Epoch 3  	Train Loss = 1.80212 Val Loss = 2.01646
2024-04-20 16:58:17.184155 Epoch 4  	Train Loss = 1.76124 Val Loss = 1.94099
2024-04-20 16:58:43.518630 Epoch 5  	Train Loss = 1.72078 Val Loss = 1.88963
2024-04-20 16:59:10.437521 Epoch 6  	Train Loss = 1.69059 Val Loss = 1.84017
2024-04-20 16:59:37.293975 Epoch 7  	Train Loss = 1.66119 Val Loss = 1.83448
2024-04-20 17:00:03.443163 Epoch 8  	Train Loss = 1.64236 Val Loss = 1.80297
2024-04-20 17:00:29.918355 Epoch 9  	Train Loss = 1.62213 Val Loss = 1.79869
2024-04-20 17:00:56.501085 Epoch 10  	Train Loss = 1.61044 Val Loss = 1.79033
2024-04-20 17:01:23.147159 Epoch 11  	Train Loss = 1.59538 Val Loss = 1.78139
2024-04-20 17:01:50.152338 Epoch 12  	Train Loss = 1.58206 Val Loss = 1.77650
2024-04-20 17:02:16.619759 Epoch 13  	Train Loss = 1.54387 Val Loss = 1.75016
2024-04-20 17:02:43.800225 Epoch 14  	Train Loss = 1.53890 Val Loss = 1.75076
2024-04-20 17:03:11.073791 Epoch 15  	Train Loss = 1.53637 Val Loss = 1.74699
2024-04-20 17:03:37.567545 Epoch 16  	Train Loss = 1.53396 Val Loss = 1.74862
2024-04-20 17:04:04.758866 Epoch 17  	Train Loss = 1.53227 Val Loss = 1.74534
2024-04-20 17:04:31.895449 Epoch 18  	Train Loss = 1.52969 Val Loss = 1.74765
2024-04-20 17:04:59.044536 Epoch 19  	Train Loss = 1.52773 Val Loss = 1.74773
2024-04-20 17:05:26.128861 Epoch 20  	Train Loss = 1.52583 Val Loss = 1.75344
2024-04-20 17:05:52.926733 Epoch 21  	Train Loss = 1.52421 Val Loss = 1.74622
2024-04-20 17:06:19.485068 Epoch 22  	Train Loss = 1.52214 Val Loss = 1.74552
2024-04-20 17:06:45.603441 Epoch 23  	Train Loss = 1.52000 Val Loss = 1.74377
2024-04-20 17:07:11.862099 Epoch 24  	Train Loss = 1.51858 Val Loss = 1.74860
2024-04-20 17:07:38.832768 Epoch 25  	Train Loss = 1.51688 Val Loss = 1.74983
2024-04-20 17:08:06.020952 Epoch 26  	Train Loss = 1.51521 Val Loss = 1.74767
2024-04-20 17:08:32.341166 Epoch 27  	Train Loss = 1.51372 Val Loss = 1.74413
2024-04-20 17:08:59.349694 Epoch 28  	Train Loss = 1.51195 Val Loss = 1.74731
2024-04-20 17:09:26.574317 Epoch 29  	Train Loss = 1.51074 Val Loss = 1.74870
2024-04-20 17:09:53.628679 Epoch 30  	Train Loss = 1.50964 Val Loss = 1.74520
2024-04-20 17:10:20.818489 Epoch 31  	Train Loss = 1.50766 Val Loss = 1.74518
2024-04-20 17:10:47.745904 Epoch 32  	Train Loss = 1.50607 Val Loss = 1.74433
2024-04-20 17:11:13.817008 Epoch 33  	Train Loss = 1.50492 Val Loss = 1.74761
Early stopping at epoch: 33
Best at epoch 23:
Train Loss = 1.52000
Train MAE = 1.51772, RMSE = 3.29667, MAPE = 3.23126
Val Loss = 1.74377
Val MAE = 1.73278, RMSE = 3.97310, MAPE = 3.98592
Model checkpoint saved to: ../saved_models/GCLSTM/GCLSTM-PEMSBAY-2024-04-20-16-56-27.pt
--------- Test ---------
All Steps (1-12) MAE = 1.68619, RMSE = 3.88226, MAPE = 3.82596
Step 1 MAE = 0.90811, RMSE = 1.64272, MAPE = 1.76271
Step 2 MAE = 1.18111, RMSE = 2.33557, MAPE = 2.38791
Step 3 MAE = 1.37361, RMSE = 2.87933, MAPE = 2.88041
Step 4 MAE = 1.52105, RMSE = 3.30589, MAPE = 3.28749
Step 5 MAE = 1.63750, RMSE = 3.64229, MAPE = 3.62740
Step 6 MAE = 1.73475, RMSE = 3.91570, MAPE = 3.92032
Step 7 MAE = 1.81745, RMSE = 4.14388, MAPE = 4.17678
Step 8 MAE = 1.89019, RMSE = 4.33704, MAPE = 4.40394
Step 9 MAE = 1.95574, RMSE = 4.50409, MAPE = 4.60752
Step 10 MAE = 2.01551, RMSE = 4.65069, MAPE = 4.78947
Step 11 MAE = 2.07149, RMSE = 4.78320, MAPE = 4.95424
Step 12 MAE = 2.12771, RMSE = 4.91075, MAPE = 5.11341
Inference time: 2.99 s
