PEMS08
Trainset:	x-(10700, 12, 170, 1)	y-(10700, 12, 170, 1)
Valset:  	x-(3567, 12, 170, 1)  	y-(3567, 12, 170, 1)
Testset:	x-(3566, 12, 170, 1)	y-(3566, 12, 170, 1)

Random seed = 233
--------- GCLSTM ---------
{
    "num_nodes": 170,
    "in_steps": 12,
    "out_steps": 12,
    "lr": 0.001,
    "weight_decay": 0,
    "milestones": [
        12,
        50
    ],
    "clip_grad": 0,
    "batch_size": 64,
    "max_epochs": 200,
    "pass_device": true,
    "model_args": {
        "num_nodes": 170,
        "input_dim": 1,
        "output_dim": 1,
        "horizon": 12,
        "rnn_units": 64,
        "num_layers": 1,
        "cheb_k": 3,
        "adj_path": "../data/PEMS08/adj_PEMS08.pkl",
        "adj_type": "doubletransition",
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
GCLSTM                                   [64, 12, 170, 1]          --
├─Encoder: 1-1                           [64, 170, 64]             --
│    └─ModuleList: 2-1                   --                        --
│    │    └─LSTMCell: 3-1                [64, 170, 64]             100,096
│    │    └─LSTMCell: 3-2                [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-3                [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-4                [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-5                [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-6                [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-7                [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-8                [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-9                [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-10               [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-11               [64, 170, 64]             (recursive)
│    │    └─LSTMCell: 3-12               [64, 170, 64]             (recursive)
├─Decoder: 1-2                           [64, 170, 64]             --
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-13               [64, 170, 64]             100,096
├─Sequential: 1-3                        [64, 170, 1]              --
│    └─Linear: 2-3                       [64, 170, 1]              65
├─Decoder: 1-4                           [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-14               [64, 170, 64]             (recursive)
├─Sequential: 1-5                        [64, 170, 1]              (recursive)
│    └─Linear: 2-5                       [64, 170, 1]              (recursive)
├─Decoder: 1-6                           [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-15               [64, 170, 64]             (recursive)
├─Sequential: 1-7                        [64, 170, 1]              (recursive)
│    └─Linear: 2-7                       [64, 170, 1]              (recursive)
├─Decoder: 1-8                           [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-16               [64, 170, 64]             (recursive)
├─Sequential: 1-9                        [64, 170, 1]              (recursive)
│    └─Linear: 2-9                       [64, 170, 1]              (recursive)
├─Decoder: 1-10                          [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-17               [64, 170, 64]             (recursive)
├─Sequential: 1-11                       [64, 170, 1]              (recursive)
│    └─Linear: 2-11                      [64, 170, 1]              (recursive)
├─Decoder: 1-12                          [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-18               [64, 170, 64]             (recursive)
├─Sequential: 1-13                       [64, 170, 1]              (recursive)
│    └─Linear: 2-13                      [64, 170, 1]              (recursive)
├─Decoder: 1-14                          [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-19               [64, 170, 64]             (recursive)
├─Sequential: 1-15                       [64, 170, 1]              (recursive)
│    └─Linear: 2-15                      [64, 170, 1]              (recursive)
├─Decoder: 1-16                          [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-20               [64, 170, 64]             (recursive)
├─Sequential: 1-17                       [64, 170, 1]              (recursive)
│    └─Linear: 2-17                      [64, 170, 1]              (recursive)
├─Decoder: 1-18                          [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-21               [64, 170, 64]             (recursive)
├─Sequential: 1-19                       [64, 170, 1]              (recursive)
│    └─Linear: 2-19                      [64, 170, 1]              (recursive)
├─Decoder: 1-20                          [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-22               [64, 170, 64]             (recursive)
├─Sequential: 1-21                       [64, 170, 1]              (recursive)
│    └─Linear: 2-21                      [64, 170, 1]              (recursive)
├─Decoder: 1-22                          [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-23               [64, 170, 64]             (recursive)
├─Sequential: 1-23                       [64, 170, 1]              (recursive)
│    └─Linear: 2-23                      [64, 170, 1]              (recursive)
├─Decoder: 1-24                          [64, 170, 64]             (recursive)
│    └─ModuleList: 2-24                  --                        (recursive)
│    │    └─LSTMCell: 3-24               [64, 170, 64]             (recursive)
├─Sequential: 1-25                       [64, 170, 1]              (recursive)
│    └─Linear: 2-25                      [64, 170, 1]              (recursive)
==========================================================================================
Total params: 200,257
Trainable params: 200,257
Non-trainable params: 0
Total mult-adds (M): 0.05
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 535.82
Params size (MB): 0.80
Estimated Total Size (MB): 537.14
==========================================================================================

Loss: HuberLoss

2024-04-20 17:18:20.433250 Epoch 1  	Train Loss = 36.35062 Val Loss = 22.40052
2024-04-20 17:18:27.930776 Epoch 2  	Train Loss = 21.46295 Val Loss = 20.78734
2024-04-20 17:18:35.444524 Epoch 3  	Train Loss = 20.72750 Val Loss = 21.09327
2024-04-20 17:18:43.094754 Epoch 4  	Train Loss = 20.22393 Val Loss = 21.23344
2024-04-20 17:18:50.618835 Epoch 5  	Train Loss = 19.89725 Val Loss = 20.18417
2024-04-20 17:18:58.180559 Epoch 6  	Train Loss = 19.85845 Val Loss = 20.26739
2024-04-20 17:19:05.781836 Epoch 7  	Train Loss = 19.47058 Val Loss = 19.86968
2024-04-20 17:19:13.428913 Epoch 8  	Train Loss = 19.36349 Val Loss = 19.46916
2024-04-20 17:19:21.089364 Epoch 9  	Train Loss = 19.18669 Val Loss = 20.22673
2024-04-20 17:19:28.729635 Epoch 10  	Train Loss = 18.95431 Val Loss = 19.61659
2024-04-20 17:19:36.381102 Epoch 11  	Train Loss = 18.86254 Val Loss = 19.35950
2024-04-20 17:19:44.025128 Epoch 12  	Train Loss = 18.66271 Val Loss = 18.88552
2024-04-20 17:19:52.269190 Epoch 13  	Train Loss = 18.07580 Val Loss = 18.44471
2024-04-20 17:19:59.980415 Epoch 14  	Train Loss = 18.03443 Val Loss = 18.38860
2024-04-20 17:20:07.548844 Epoch 15  	Train Loss = 18.00131 Val Loss = 18.36673
2024-04-20 17:20:15.099090 Epoch 16  	Train Loss = 17.95277 Val Loss = 18.47899
2024-04-20 17:20:22.601003 Epoch 17  	Train Loss = 17.93291 Val Loss = 18.29837
2024-04-20 17:20:30.105339 Epoch 18  	Train Loss = 17.89469 Val Loss = 18.34724
2024-04-20 17:20:37.617775 Epoch 19  	Train Loss = 17.87620 Val Loss = 18.32123
2024-04-20 17:20:45.103482 Epoch 20  	Train Loss = 17.86136 Val Loss = 18.28967
2024-04-20 17:20:52.602183 Epoch 21  	Train Loss = 17.83576 Val Loss = 18.26271
2024-04-20 17:21:00.117605 Epoch 22  	Train Loss = 17.82474 Val Loss = 18.26235
2024-04-20 17:21:07.610792 Epoch 23  	Train Loss = 17.75056 Val Loss = 18.18496
2024-04-20 17:21:15.110075 Epoch 24  	Train Loss = 17.74282 Val Loss = 18.19867
2024-04-20 17:21:22.333315 Epoch 25  	Train Loss = 17.71785 Val Loss = 18.22408
2024-04-20 17:21:29.609530 Epoch 26  	Train Loss = 17.71571 Val Loss = 18.07863
2024-04-20 17:21:36.889934 Epoch 27  	Train Loss = 17.65081 Val Loss = 18.07984
2024-04-20 17:21:43.921511 Epoch 28  	Train Loss = 17.62787 Val Loss = 18.17453
2024-04-20 17:21:51.207011 Epoch 29  	Train Loss = 17.56721 Val Loss = 18.00450
2024-04-20 17:21:58.517315 Epoch 30  	Train Loss = 17.56326 Val Loss = 17.92074
2024-04-20 17:22:05.772763 Epoch 31  	Train Loss = 17.53969 Val Loss = 18.27348
2024-04-20 17:22:12.699890 Epoch 32  	Train Loss = 17.48828 Val Loss = 17.90797
2024-04-20 17:22:19.995261 Epoch 33  	Train Loss = 17.45501 Val Loss = 17.86363
2024-04-20 17:22:27.343039 Epoch 34  	Train Loss = 17.44992 Val Loss = 17.92110
2024-04-20 17:22:34.750932 Epoch 35  	Train Loss = 17.38324 Val Loss = 17.92218
2024-04-20 17:22:42.067542 Epoch 36  	Train Loss = 17.37605 Val Loss = 18.06997
2024-04-20 17:22:49.400872 Epoch 37  	Train Loss = 17.36528 Val Loss = 17.74655
2024-04-20 17:22:56.704999 Epoch 38  	Train Loss = 17.29711 Val Loss = 17.74988
2024-04-20 17:23:04.019214 Epoch 39  	Train Loss = 17.28827 Val Loss = 17.82301
2024-04-20 17:23:11.303553 Epoch 40  	Train Loss = 17.29109 Val Loss = 18.08998
2024-04-20 17:23:18.560303 Epoch 41  	Train Loss = 17.24809 Val Loss = 17.77296
2024-04-20 17:23:25.899250 Epoch 42  	Train Loss = 17.23842 Val Loss = 17.83850
2024-04-20 17:23:33.110755 Epoch 43  	Train Loss = 17.19619 Val Loss = 17.61839
2024-04-20 17:23:40.343321 Epoch 44  	Train Loss = 17.16623 Val Loss = 17.65515
2024-04-20 17:23:47.860806 Epoch 45  	Train Loss = 17.15828 Val Loss = 17.59349
2024-04-20 17:23:54.902798 Epoch 46  	Train Loss = 17.13190 Val Loss = 17.50729
2024-04-20 17:24:02.300012 Epoch 47  	Train Loss = 17.10661 Val Loss = 17.68970
2024-04-20 17:24:09.819727 Epoch 48  	Train Loss = 17.07127 Val Loss = 17.58734
2024-04-20 17:24:17.095653 Epoch 49  	Train Loss = 17.06131 Val Loss = 17.61749
2024-04-20 17:24:24.420574 Epoch 50  	Train Loss = 17.03814 Val Loss = 17.59065
2024-04-20 17:24:31.611513 Epoch 51  	Train Loss = 16.94311 Val Loss = 17.45088
2024-04-20 17:24:38.839463 Epoch 52  	Train Loss = 16.94233 Val Loss = 17.46230
2024-04-20 17:24:46.247801 Epoch 53  	Train Loss = 16.94445 Val Loss = 17.45051
2024-04-20 17:24:53.561863 Epoch 54  	Train Loss = 16.93045 Val Loss = 17.47346
2024-04-20 17:25:00.783453 Epoch 55  	Train Loss = 16.93294 Val Loss = 17.44052
2024-04-20 17:25:07.939276 Epoch 56  	Train Loss = 16.92804 Val Loss = 17.43362
2024-04-20 17:25:15.047950 Epoch 57  	Train Loss = 16.91512 Val Loss = 17.47401
2024-04-20 17:25:22.316033 Epoch 58  	Train Loss = 16.93109 Val Loss = 17.42622
2024-04-20 17:25:29.442334 Epoch 59  	Train Loss = 16.92304 Val Loss = 17.43034
2024-04-20 17:25:36.643361 Epoch 60  	Train Loss = 16.92540 Val Loss = 17.42329
2024-04-20 17:25:43.856519 Epoch 61  	Train Loss = 16.91055 Val Loss = 17.44566
2024-04-20 17:25:51.074998 Epoch 62  	Train Loss = 16.90212 Val Loss = 17.43100
2024-04-20 17:25:58.149693 Epoch 63  	Train Loss = 16.91917 Val Loss = 17.44148
2024-04-20 17:26:05.388176 Epoch 64  	Train Loss = 16.89649 Val Loss = 17.42758
2024-04-20 17:26:12.666556 Epoch 65  	Train Loss = 16.89112 Val Loss = 17.44607
2024-04-20 17:26:19.962094 Epoch 66  	Train Loss = 16.90322 Val Loss = 17.40389
2024-04-20 17:26:27.287076 Epoch 67  	Train Loss = 16.89931 Val Loss = 17.43620
2024-04-20 17:26:34.581953 Epoch 68  	Train Loss = 16.89734 Val Loss = 17.42849
2024-04-20 17:26:41.698941 Epoch 69  	Train Loss = 16.89136 Val Loss = 17.40295
2024-04-20 17:26:48.901254 Epoch 70  	Train Loss = 16.88256 Val Loss = 17.43005
2024-04-20 17:26:55.879516 Epoch 71  	Train Loss = 16.88581 Val Loss = 17.38595
2024-04-20 17:27:02.756279 Epoch 72  	Train Loss = 16.87807 Val Loss = 17.42966
2024-04-20 17:27:09.935881 Epoch 73  	Train Loss = 16.88475 Val Loss = 17.40326
2024-04-20 17:27:17.472056 Epoch 74  	Train Loss = 16.87579 Val Loss = 17.38880
2024-04-20 17:27:25.038787 Epoch 75  	Train Loss = 16.87241 Val Loss = 17.40733
2024-04-20 17:27:32.749047 Epoch 76  	Train Loss = 16.85686 Val Loss = 17.39073
2024-04-20 17:27:40.241018 Epoch 77  	Train Loss = 16.87610 Val Loss = 17.38814
2024-04-20 17:27:47.565333 Epoch 78  	Train Loss = 16.86850 Val Loss = 17.40051
2024-04-20 17:27:54.805440 Epoch 79  	Train Loss = 16.87213 Val Loss = 17.39857
2024-04-20 17:28:01.946742 Epoch 80  	Train Loss = 16.85327 Val Loss = 17.39076
2024-04-20 17:28:09.154522 Epoch 81  	Train Loss = 16.87507 Val Loss = 17.38802
Early stopping at epoch: 81
Best at epoch 71:
Train Loss = 16.88581
Train MAE = 17.38246, RMSE = 27.74778, MAPE = 11.04769
Val Loss = 17.38595
Val MAE = 17.86417, RMSE = 28.06991, MAPE = 12.13346
Model checkpoint saved to: ../saved_models/GCLSTM/GCLSTM-PEMS08-2024-04-20-17-18-11.pt
--------- Test ---------
All Steps (1-12) MAE = 17.40918, RMSE = 27.00614, MAPE = 11.12953
Step 1 MAE = 13.87457, RMSE = 21.14571, MAPE = 9.26298
Step 2 MAE = 14.96158, RMSE = 22.98339, MAPE = 9.75133
Step 3 MAE = 15.77359, RMSE = 24.33730, MAPE = 10.02881
Step 4 MAE = 16.28959, RMSE = 25.24895, MAPE = 10.29229
Step 5 MAE = 16.74478, RMSE = 25.99405, MAPE = 10.59391
Step 6 MAE = 17.23082, RMSE = 26.74350, MAPE = 10.93326
Step 7 MAE = 17.78629, RMSE = 27.54538, MAPE = 11.28349
Step 8 MAE = 18.28930, RMSE = 28.26141, MAPE = 11.61174
Step 9 MAE = 18.71284, RMSE = 28.86767, MAPE = 11.90379
Step 10 MAE = 19.12363, RMSE = 29.46816, MAPE = 12.20221
Step 11 MAE = 19.67210, RMSE = 30.25247, MAPE = 12.57911
Step 12 MAE = 20.45116, RMSE = 31.32913, MAPE = 13.11135
Inference time: 0.69 s
