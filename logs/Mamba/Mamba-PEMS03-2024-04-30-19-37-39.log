PEMS03
Trainset:	x-(15711, 12, 358, 1)	y-(15711, 12, 358, 1)
Valset:  	x-(5237, 12, 358, 1)  	y-(5237, 12, 358, 1)
Testset:	x-(5237, 12, 358, 1)	y-(5237, 12, 358, 1)

Random seed = 233
--------- Mamba ---------
{
    "num_nodes": 358,
    "in_steps": 12,
    "out_steps": 12,
    "lr": 0.01,
    "weight_decay": 0.0001,
    "milestones": [
        10,
        20
    ],
    "clip_grad": 5,
    "batch_size": 64,
    "max_epochs": 200,
    "early_stop": 10,
    "model_args": {
        "num_nodes": 358,
        "seq_len": 12,
        "pred_len": 12,
        "input_dim": 1,
        "output_dim": 1,
        "hidden_dim": 256,
        "num_layers": 3
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Mamba                                    [64, 12, 358, 1]          --
├─Linear: 1-1                            [64, 12, 256]             91,904
├─MambaMain: 1-2                         [64, 12, 256]             --
│    └─ModuleList: 2-1                   --                        --
│    │    └─ResidualBlock: 3-1           [64, 12, 256]             438,016
│    │    └─ResidualBlock: 3-2           [64, 12, 256]             438,016
│    │    └─ResidualBlock: 3-3           [64, 12, 256]             438,016
├─Linear: 1-3                            [64, 12, 358]             92,006
├─Conv1d: 1-4                            [64, 12, 358]             156
==========================================================================================
Total params: 1,498,114
Trainable params: 1,498,114
Non-trainable params: 0
Total mult-adds (M): 102.98
==========================================================================================
Input size (MB): 1.10
Forward/backward pass size (MB): 46.96
Params size (MB): 5.78
Estimated Total Size (MB): 53.85
==========================================================================================

Loss: HuberLoss

2024-04-30 19:37:48.057356 Epoch 1  	Train Loss = 43.60441 Val Loss = 24.31019
2024-04-30 19:37:54.618577 Epoch 2  	Train Loss = 22.44909 Val Loss = 21.18774
2024-04-30 19:38:01.352463 Epoch 3  	Train Loss = 20.59868 Val Loss = 22.80306
2024-04-30 19:38:08.089527 Epoch 4  	Train Loss = 19.39131 Val Loss = 19.93247
2024-04-30 19:38:14.816978 Epoch 5  	Train Loss = 18.13888 Val Loss = 19.07285
2024-04-30 19:38:21.602642 Epoch 6  	Train Loss = 18.00101 Val Loss = 18.28115
2024-04-30 19:38:28.338619 Epoch 7  	Train Loss = 17.79512 Val Loss = 17.83047
2024-04-30 19:38:35.064102 Epoch 8  	Train Loss = 17.17578 Val Loss = 18.75418
2024-04-30 19:38:41.803982 Epoch 9  	Train Loss = 16.96666 Val Loss = 18.25131
2024-04-30 19:38:48.440895 Epoch 10  	Train Loss = 16.77713 Val Loss = 18.11911
2024-04-30 19:38:55.182263 Epoch 11  	Train Loss = 14.70525 Val Loss = 15.95586
2024-04-30 19:39:01.904045 Epoch 12  	Train Loss = 14.37948 Val Loss = 15.90270
2024-04-30 19:39:08.576705 Epoch 13  	Train Loss = 14.20964 Val Loss = 15.76096
2024-04-30 19:39:15.273391 Epoch 14  	Train Loss = 14.01078 Val Loss = 15.60210
2024-04-30 19:39:21.942345 Epoch 15  	Train Loss = 13.88599 Val Loss = 15.60607
2024-04-30 19:39:28.584927 Epoch 16  	Train Loss = 13.76110 Val Loss = 15.54879
2024-04-30 19:39:35.283885 Epoch 17  	Train Loss = 13.67450 Val Loss = 15.47815
2024-04-30 19:39:41.973527 Epoch 18  	Train Loss = 13.60119 Val Loss = 15.50217
2024-04-30 19:39:48.656755 Epoch 19  	Train Loss = 13.52734 Val Loss = 15.38433
2024-04-30 19:39:55.290949 Epoch 20  	Train Loss = 13.44556 Val Loss = 15.35317
2024-04-30 19:40:01.994769 Epoch 21  	Train Loss = 13.18528 Val Loss = 15.13706
2024-04-30 19:40:08.725492 Epoch 22  	Train Loss = 13.13845 Val Loss = 15.13911
2024-04-30 19:40:15.355131 Epoch 23  	Train Loss = 13.11500 Val Loss = 15.13060
2024-04-30 19:40:22.000615 Epoch 24  	Train Loss = 13.09466 Val Loss = 15.11049
2024-04-30 19:40:28.841937 Epoch 25  	Train Loss = 13.07884 Val Loss = 15.11318
2024-04-30 19:40:35.604262 Epoch 26  	Train Loss = 13.06459 Val Loss = 15.11130
2024-04-30 19:40:42.342812 Epoch 27  	Train Loss = 13.04862 Val Loss = 15.09863
2024-04-30 19:40:49.074084 Epoch 28  	Train Loss = 13.03580 Val Loss = 15.10476
2024-04-30 19:40:55.786105 Epoch 29  	Train Loss = 13.02197 Val Loss = 15.09006
2024-04-30 19:41:02.477458 Epoch 30  	Train Loss = 13.00701 Val Loss = 15.10442
2024-04-30 19:41:09.222597 Epoch 31  	Train Loss = 12.99648 Val Loss = 15.08202
2024-04-30 19:41:15.942157 Epoch 32  	Train Loss = 12.98660 Val Loss = 15.08049
2024-04-30 19:41:22.572989 Epoch 33  	Train Loss = 12.97470 Val Loss = 15.09402
2024-04-30 19:41:29.258238 Epoch 34  	Train Loss = 12.96591 Val Loss = 15.06955
2024-04-30 19:41:36.012060 Epoch 35  	Train Loss = 12.95048 Val Loss = 15.08990
2024-04-30 19:41:42.773961 Epoch 36  	Train Loss = 12.93798 Val Loss = 15.06476
2024-04-30 19:41:49.514161 Epoch 37  	Train Loss = 12.93120 Val Loss = 15.07161
2024-04-30 19:41:56.257947 Epoch 38  	Train Loss = 12.92096 Val Loss = 15.07971
2024-04-30 19:42:02.977388 Epoch 39  	Train Loss = 12.91239 Val Loss = 15.08671
2024-04-30 19:42:09.624457 Epoch 40  	Train Loss = 12.89907 Val Loss = 15.06073
2024-04-30 19:42:16.316307 Epoch 41  	Train Loss = 12.89533 Val Loss = 15.06736
2024-04-30 19:42:23.018939 Epoch 42  	Train Loss = 12.88008 Val Loss = 15.06838
2024-04-30 19:42:29.701092 Epoch 43  	Train Loss = 12.87770 Val Loss = 15.06488
2024-04-30 19:42:36.427499 Epoch 44  	Train Loss = 12.86679 Val Loss = 15.07296
2024-04-30 19:42:43.075682 Epoch 45  	Train Loss = 12.85810 Val Loss = 15.08780
2024-04-30 19:42:49.809948 Epoch 46  	Train Loss = 12.85578 Val Loss = 15.05706
2024-04-30 19:42:56.590256 Epoch 47  	Train Loss = 12.84397 Val Loss = 15.07097
2024-04-30 19:43:03.519301 Epoch 48  	Train Loss = 12.83204 Val Loss = 15.04183
2024-04-30 19:43:10.266699 Epoch 49  	Train Loss = 12.82194 Val Loss = 15.07748
2024-04-30 19:43:16.872195 Epoch 50  	Train Loss = 12.81705 Val Loss = 15.08707
2024-04-30 19:43:23.487429 Epoch 51  	Train Loss = 12.80987 Val Loss = 15.06263
2024-04-30 19:43:30.174555 Epoch 52  	Train Loss = 12.79868 Val Loss = 15.04844
2024-04-30 19:43:36.921327 Epoch 53  	Train Loss = 12.79316 Val Loss = 15.07462
2024-04-30 19:43:43.641823 Epoch 54  	Train Loss = 12.78454 Val Loss = 15.06804
2024-04-30 19:43:50.386683 Epoch 55  	Train Loss = 12.78084 Val Loss = 15.03318
2024-04-30 19:43:57.147948 Epoch 56  	Train Loss = 12.77083 Val Loss = 15.11818
2024-04-30 19:44:03.828650 Epoch 57  	Train Loss = 12.76400 Val Loss = 15.04687
2024-04-30 19:44:10.262168 Epoch 58  	Train Loss = 12.75347 Val Loss = 15.05946
2024-04-30 19:44:17.046826 Epoch 59  	Train Loss = 12.74736 Val Loss = 15.07050
2024-04-30 19:44:23.720784 Epoch 60  	Train Loss = 12.74227 Val Loss = 15.06216
2024-04-30 19:44:30.485770 Epoch 61  	Train Loss = 12.73398 Val Loss = 15.06914
2024-04-30 19:44:37.219219 Epoch 62  	Train Loss = 12.72479 Val Loss = 15.08543
2024-04-30 19:44:43.848519 Epoch 63  	Train Loss = 12.72334 Val Loss = 15.07630
2024-04-30 19:44:50.539450 Epoch 64  	Train Loss = 12.71252 Val Loss = 15.06870
2024-04-30 19:44:57.225236 Epoch 65  	Train Loss = 12.70651 Val Loss = 15.09307
Early stopping at epoch: 65
Best at epoch 55:
Train Loss = 12.78084
Train MAE = 13.26946, RMSE = 21.59945, MAPE = 12.79810
Val Loss = 15.03318
Val MAE = 15.51857, RMSE = 24.63857, MAPE = 14.73868
Model checkpoint saved to: ../saved_models/Mamba/Mamba-PEMS03-2024-04-30-19-37-39.pt
--------- Test ---------
All Steps (1-12) MAE = 18.37396, RMSE = 31.12041, MAPE = 19.06299
Step 1 MAE = 17.87472, RMSE = 30.14530, MAPE = 19.31157
Step 2 MAE = 17.98328, RMSE = 30.40809, MAPE = 18.93962
Step 3 MAE = 18.09803, RMSE = 30.64435, MAPE = 18.91485
Step 4 MAE = 18.16766, RMSE = 30.80822, MAPE = 18.85389
Step 5 MAE = 18.20860, RMSE = 30.90536, MAPE = 18.90283
Step 6 MAE = 18.26993, RMSE = 31.01589, MAPE = 18.99153
Step 7 MAE = 18.37734, RMSE = 31.18534, MAPE = 19.00289
Step 8 MAE = 18.48444, RMSE = 31.35124, MAPE = 18.96276
Step 9 MAE = 18.55730, RMSE = 31.45824, MAPE = 19.07846
Step 10 MAE = 18.62515, RMSE = 31.55755, MAPE = 19.06294
Step 11 MAE = 18.74375, RMSE = 31.72104, MAPE = 19.24609
Step 12 MAE = 19.09700, RMSE = 32.18494, MAPE = 19.48835
Inference time: 0.40 s
