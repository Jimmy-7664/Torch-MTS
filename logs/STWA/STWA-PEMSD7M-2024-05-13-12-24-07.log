PEMSD7M
Trainset:	x-(7589, 12, 228, 1)	y-(7589, 12, 228, 1)
Valset:  	x-(2530, 12, 228, 1)  	y-(2530, 12, 228, 1)
Testset:	x-(2530, 12, 228, 1)	y-(2530, 12, 228, 1)

Random seed = 233
--------- STWA ---------
{
    "in_steps": 12,
    "out_steps": 12,
    "lr": 0.001,
    "milestones": [],
    "clip_grad": false,
    "batch_size": 16,
    "max_epochs": 200,
    "early_stop": 15,
    "pass_device": true,
    "model_args": {
        "num_nodes": 228,
        "input_dim": 1,
        "output_dim": 1,
        "lag": 12,
        "horizon": 12,
        "device": "cuda:0",
        "channels": 16,
        "memory_size": 16,
        "dynamic": true
    }
}
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
STWA                                               [16, 12, 228, 1]          --
├─Sequential: 1-1                                  [16, 228, 16]             --
│    └─Linear: 2-1                                 [16, 228, 32]             416
│    └─Tanh: 2-2                                   [16, 228, 32]             --
│    └─Linear: 2-3                                 [16, 228, 32]             1,056
│    └─Tanh: 2-4                                   [16, 228, 32]             --
│    └─Linear: 2-5                                 [16, 228, 16]             528
├─Sequential: 1-2                                  [16, 228, 16]             --
│    └─Linear: 2-6                                 [16, 228, 32]             416
│    └─Tanh: 2-7                                   [16, 228, 32]             --
│    └─Linear: 2-8                                 [16, 228, 32]             1,056
│    └─Tanh: 2-9                                   [16, 228, 32]             --
│    └─Linear: 2-10                                [16, 228, 16]             528
├─Linear: 1-3                                      [16, 12, 228, 16]         32
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-11                                 [16, 12, 228, 16]         94,848
│    │    └─ModuleList: 3-1                        --                        6,100
│    │    └─ModuleList: 3-2                        --                        6,100
│    │    └─TemporalAttention: 3-3                 [16, 2, 228, 16]          544
│    │    └─SpatialAttention: 3-4                  [16, 2, 228, 16]          544
│    │    └─Sequential: 3-5                        [16, 2, 228, 16]          544
│    │    └─TemporalAttention: 3-6                 [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-7                  [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-8                        [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-9                 [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-10                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-11                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-12                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-13                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-14                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-15                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-16                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-17                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-18                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-19                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-20                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-21                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-22                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-23                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-24                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-25                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-26                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-27                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-28                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-29                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-30                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-31                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-32                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-33                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-34                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-35                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-36                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-37                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-38                       [16, 2, 228, 16]          (recursive)
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-12                                [16, 228, 256]            49,408
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-13                                 [16, 3, 228, 16]          29,184
│    │    └─ModuleList: 3-39                       --                        6,100
│    │    └─ModuleList: 3-40                       --                        6,100
│    │    └─TemporalAttention: 3-41                [16, 2, 228, 16]          544
│    │    └─SpatialAttention: 3-42                 [16, 2, 228, 16]          544
│    │    └─Sequential: 3-43                       [16, 2, 228, 16]          544
│    │    └─TemporalAttention: 3-44                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-45                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-46                       [16, 2, 228, 16]          (recursive)
│    │    └─TemporalAttention: 3-47                [16, 2, 228, 16]          (recursive)
│    │    └─SpatialAttention: 3-48                 [16, 2, 228, 16]          (recursive)
│    │    └─Sequential: 3-49                       [16, 2, 228, 16]          (recursive)
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-14                                [16, 228, 256]            12,544
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-15                                 [16, 1, 228, 16]          14,592
│    │    └─ModuleList: 3-50                       --                        6,100
│    │    └─ModuleList: 3-51                       --                        6,100
│    │    └─TemporalAttention: 3-52                [16, 2, 228, 16]          544
│    │    └─SpatialAttention: 3-53                 [16, 2, 228, 16]          544
│    │    └─Sequential: 3-54                       [16, 2, 228, 16]          544
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-16                                [16, 228, 256]            4,352
├─Sequential: 1-10                                 [16, 228, 12]             --
│    └─Linear: 2-17                                [16, 228, 512]            131,584
│    └─ReLU: 2-18                                  [16, 228, 512]            --
│    └─Linear: 2-19                                [16, 228, 12]             6,156
====================================================================================================
Total params: 388,196
Trainable params: 388,196
Non-trainable params: 0
Total mult-adds (M): 4.33
====================================================================================================
Input size (MB): 0.18
Forward/backward pass size (MB): 258.80
Params size (MB): 1.00
Estimated Total Size (MB): 259.98
====================================================================================================

Loss: MaskedMAELoss

2024-05-13 12:24:55.343996 Epoch 1  	Train Loss = 4.22359 Val Loss = 3.57141
2024-05-13 12:25:39.660183 Epoch 2  	Train Loss = 3.16744 Val Loss = 3.24730
2024-05-13 12:26:24.177293 Epoch 3  	Train Loss = 2.86744 Val Loss = 3.08472
2024-05-13 12:27:11.776568 Epoch 4  	Train Loss = 2.69045 Val Loss = 2.94445
2024-05-13 12:27:55.327953 Epoch 5  	Train Loss = 2.59184 Val Loss = 2.87928
2024-05-13 12:28:37.436263 Epoch 6  	Train Loss = 2.52727 Val Loss = 2.82354
2024-05-13 12:29:19.764220 Epoch 7  	Train Loss = 2.48026 Val Loss = 2.78667
2024-05-13 12:30:01.925650 Epoch 8  	Train Loss = 2.44714 Val Loss = 2.77885
2024-05-13 12:30:43.955503 Epoch 9  	Train Loss = 2.41357 Val Loss = 2.85591
2024-05-13 12:31:26.078663 Epoch 10  	Train Loss = 2.38257 Val Loss = 2.81491
2024-05-13 12:32:08.687304 Epoch 11  	Train Loss = 2.35873 Val Loss = 2.77977
2024-05-13 12:32:50.543790 Epoch 12  	Train Loss = 2.32438 Val Loss = 2.75306
2024-05-13 12:33:32.454490 Epoch 13  	Train Loss = 2.30616 Val Loss = 2.75884
2024-05-13 12:34:14.452636 Epoch 14  	Train Loss = 2.29733 Val Loss = 2.72103
2024-05-13 12:34:56.229426 Epoch 15  	Train Loss = 2.27654 Val Loss = 2.74294
2024-05-13 12:35:38.172366 Epoch 16  	Train Loss = 2.26141 Val Loss = 2.71963
2024-05-13 12:36:20.640030 Epoch 17  	Train Loss = 2.24462 Val Loss = 2.75591
2024-05-13 12:37:02.403194 Epoch 18  	Train Loss = 2.22368 Val Loss = 2.72087
2024-05-13 12:37:44.109578 Epoch 19  	Train Loss = 2.21583 Val Loss = 2.71503
2024-05-13 12:38:25.830753 Epoch 20  	Train Loss = 2.19754 Val Loss = 2.70799
2024-05-13 12:39:07.482272 Epoch 21  	Train Loss = 2.19051 Val Loss = 2.73153
2024-05-13 12:39:49.276158 Epoch 22  	Train Loss = 2.17123 Val Loss = 2.74369
2024-05-13 12:40:31.108727 Epoch 23  	Train Loss = 2.16388 Val Loss = 2.71872
2024-05-13 12:41:12.934920 Epoch 24  	Train Loss = 2.14594 Val Loss = 2.74274
2024-05-13 12:41:54.801279 Epoch 25  	Train Loss = 2.13630 Val Loss = 2.74005
2024-05-13 12:42:36.625276 Epoch 26  	Train Loss = 2.12436 Val Loss = 2.74144
2024-05-13 12:43:18.852834 Epoch 27  	Train Loss = 2.11649 Val Loss = 2.75183
2024-05-13 12:44:01.178479 Epoch 28  	Train Loss = 2.10311 Val Loss = 2.75716
2024-05-13 12:44:43.285422 Epoch 29  	Train Loss = 2.09184 Val Loss = 2.75482
2024-05-13 12:45:25.361576 Epoch 30  	Train Loss = 2.08764 Val Loss = 2.75099
2024-05-13 12:46:07.932963 Epoch 31  	Train Loss = 2.07252 Val Loss = 2.76175
2024-05-13 12:46:50.074367 Epoch 32  	Train Loss = 2.06496 Val Loss = 2.77498
2024-05-13 12:47:32.398479 Epoch 33  	Train Loss = 2.05817 Val Loss = 2.77105
2024-05-13 12:48:14.651836 Epoch 34  	Train Loss = 2.04275 Val Loss = 2.77613
2024-05-13 12:48:57.594274 Epoch 35  	Train Loss = 2.04518 Val Loss = 2.78843
Early stopping at epoch: 35
Best at epoch 20:
Train Loss = 2.19754
Train MAE = 2.17041, RMSE = 4.41336, MAPE = 5.16289
Val Loss = 2.70799
Val MAE = 2.71752, RMSE = 5.48718, MAPE = 7.05590
Model checkpoint saved to: ../saved_models/STWA/STWA-PEMSD7M-2024-05-13-12-24-07.pt
--------- Test ---------
All Steps (1-12) MAE = 2.66726, RMSE = 5.36171, MAPE = 6.65543
Step 1 MAE = 1.44955, RMSE = 2.47132, MAPE = 3.34409
Step 2 MAE = 1.88638, RMSE = 3.43314, MAPE = 4.42780
Step 3 MAE = 2.20246, RMSE = 4.16914, MAPE = 5.27671
Step 4 MAE = 2.44289, RMSE = 4.73088, MAPE = 5.95855
Step 5 MAE = 2.62333, RMSE = 5.15423, MAPE = 6.51114
Step 6 MAE = 2.77163, RMSE = 5.49538, MAPE = 6.94228
Step 7 MAE = 2.88876, RMSE = 5.75746, MAPE = 7.32225
Step 8 MAE = 2.98846, RMSE = 5.96481, MAPE = 7.58825
Step 9 MAE = 3.07760, RMSE = 6.14656, MAPE = 7.82693
Step 10 MAE = 3.15307, RMSE = 6.29676, MAPE = 8.04098
Step 11 MAE = 3.22351, RMSE = 6.42928, MAPE = 8.22124
Step 12 MAE = 3.29946, RMSE = 6.56206, MAPE = 8.40493
Inference time: 2.78 s
