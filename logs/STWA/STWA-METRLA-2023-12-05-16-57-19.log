METRLA
Trainset:	x-(23974, 12, 207, 1)	y-(23974, 12, 207, 1)
Valset:  	x-(3425, 12, 207, 1)  	y-(3425, 12, 207, 1)
Testset:	x-(6850, 12, 207, 1)	y-(6850, 12, 207, 1)

--------- STWA ---------
{
    "in_steps": 12,
    "out_steps": 12,
    "lr": 0.001,
    "milestones": [],
    "clip_grad": false,
    "batch_size": 16,
    "max_epochs": 200,
    "early_stop": 15,
    "pass_device": true,
    "model_args": {
        "num_nodes": 207,
        "input_dim": 1,
        "output_dim": 1,
        "lag": 12,
        "horizon": 12,
        "device": "cuda:0",
        "channels": 16,
        "memory_size": 16,
        "dynamic": true
    }
}
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
STWA                                               [16, 12, 207, 1]          --
├─Sequential: 1-1                                  [16, 207, 16]             --
│    └─Linear: 2-1                                 [16, 207, 32]             416
│    └─Tanh: 2-2                                   [16, 207, 32]             --
│    └─Linear: 2-3                                 [16, 207, 32]             1,056
│    └─Tanh: 2-4                                   [16, 207, 32]             --
│    └─Linear: 2-5                                 [16, 207, 16]             528
├─Sequential: 1-2                                  [16, 207, 16]             --
│    └─Linear: 2-6                                 [16, 207, 32]             416
│    └─Tanh: 2-7                                   [16, 207, 32]             --
│    └─Linear: 2-8                                 [16, 207, 32]             1,056
│    └─Tanh: 2-9                                   [16, 207, 32]             --
│    └─Linear: 2-10                                [16, 207, 16]             528
├─Linear: 1-3                                      [16, 12, 207, 16]         32
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-11                                 [16, 12, 207, 16]         86,112
│    │    └─ModuleList: 3-1                        --                        6,100
│    │    └─ModuleList: 3-2                        --                        6,100
│    │    └─TemporalAttention: 3-3                 [16, 2, 207, 16]          544
│    │    └─SpatialAttention: 3-4                  [16, 2, 207, 16]          544
│    │    └─Sequential: 3-5                        [16, 2, 207, 16]          544
│    │    └─TemporalAttention: 3-6                 [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-7                  [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-8                        [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-9                 [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-10                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-11                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-12                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-13                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-14                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-15                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-16                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-17                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-18                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-19                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-20                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-21                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-22                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-23                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-24                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-25                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-26                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-27                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-28                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-29                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-30                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-31                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-32                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-33                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-34                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-35                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-36                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-37                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-38                       [16, 2, 207, 16]          (recursive)
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-12                                [16, 207, 256]            49,408
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-13                                 [16, 3, 207, 16]          26,496
│    │    └─ModuleList: 3-39                       --                        6,100
│    │    └─ModuleList: 3-40                       --                        6,100
│    │    └─TemporalAttention: 3-41                [16, 2, 207, 16]          544
│    │    └─SpatialAttention: 3-42                 [16, 2, 207, 16]          544
│    │    └─Sequential: 3-43                       [16, 2, 207, 16]          544
│    │    └─TemporalAttention: 3-44                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-45                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-46                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-47                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-48                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-49                       [16, 2, 207, 16]          (recursive)
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-14                                [16, 207, 256]            12,544
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-15                                 [16, 1, 207, 16]          13,248
│    │    └─ModuleList: 3-50                       --                        6,100
│    │    └─ModuleList: 3-51                       --                        6,100
│    │    └─TemporalAttention: 3-52                [16, 2, 207, 16]          544
│    │    └─SpatialAttention: 3-53                 [16, 2, 207, 16]          544
│    │    └─Sequential: 3-54                       [16, 2, 207, 16]          544
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-16                                [16, 207, 256]            4,352
├─Sequential: 1-10                                 [16, 207, 12]             --
│    └─Linear: 2-17                                [16, 207, 512]            131,584
│    └─ReLU: 2-18                                  [16, 207, 512]            --
│    └─Linear: 2-19                                [16, 207, 12]             6,156
====================================================================================================
Total params: 375,428
Trainable params: 375,428
Non-trainable params: 0
Total mult-adds (M): 4.33
====================================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 168.83
Params size (MB): 1.00
Estimated Total Size (MB): 169.99
====================================================================================================

Loss: MaskedMAELoss

2023-12-05 17:00:21.295202 Epoch 1  	Train Loss = 3.94134 Val Loss = 3.22759
2023-12-05 17:03:22.036588 Epoch 2  	Train Loss = 3.34293 Val Loss = 3.08215
2023-12-05 17:06:17.335576 Epoch 3  	Train Loss = 3.19196 Val Loss = 2.98609
2023-12-05 17:09:17.525093 Epoch 4  	Train Loss = 3.11917 Val Loss = 3.02535
2023-12-05 17:12:18.453351 Epoch 5  	Train Loss = 3.06978 Val Loss = 2.97477
2023-12-05 17:15:20.438593 Epoch 6  	Train Loss = 3.03428 Val Loss = 2.97814
2023-12-05 17:18:21.598024 Epoch 7  	Train Loss = 3.00317 Val Loss = 2.99134
2023-12-05 17:21:22.153874 Epoch 8  	Train Loss = 2.98031 Val Loss = 2.92523
2023-12-05 17:24:21.552420 Epoch 9  	Train Loss = 2.95953 Val Loss = 2.98701
2023-12-05 17:27:26.069851 Epoch 10  	Train Loss = 2.93743 Val Loss = 2.93639
2023-12-05 17:30:21.996337 Epoch 11  	Train Loss = 2.91952 Val Loss = 2.91461
2023-12-05 17:33:20.847784 Epoch 12  	Train Loss = 2.90343 Val Loss = 2.90791
2023-12-05 17:36:18.475364 Epoch 13  	Train Loss = 2.88636 Val Loss = 2.89649
2023-12-05 17:39:17.289620 Epoch 14  	Train Loss = 2.87141 Val Loss = 2.93643
2023-12-05 17:42:16.620362 Epoch 15  	Train Loss = 2.85769 Val Loss = 2.89422
2023-12-05 17:45:12.712163 Epoch 16  	Train Loss = 2.84555 Val Loss = 2.90472
2023-12-05 17:48:10.846919 Epoch 17  	Train Loss = 2.83141 Val Loss = 2.91502
2023-12-05 17:51:03.145642 Epoch 18  	Train Loss = 2.82026 Val Loss = 2.89670
2023-12-05 17:54:01.712953 Epoch 19  	Train Loss = 2.80743 Val Loss = 2.93821
2023-12-05 17:57:01.188134 Epoch 20  	Train Loss = 2.79548 Val Loss = 2.91534
2023-12-05 17:59:57.693428 Epoch 21  	Train Loss = 2.78480 Val Loss = 2.90559
2023-12-05 18:03:03.517843 Epoch 22  	Train Loss = 2.77213 Val Loss = 2.89782
2023-12-05 18:05:59.179498 Epoch 23  	Train Loss = 2.76117 Val Loss = 2.91019
2023-12-05 18:08:59.484544 Epoch 24  	Train Loss = 2.75298 Val Loss = 2.91297
2023-12-05 18:11:56.286429 Epoch 25  	Train Loss = 2.74434 Val Loss = 2.90930
2023-12-05 18:14:55.923265 Epoch 26  	Train Loss = 2.73446 Val Loss = 2.91899
2023-12-05 18:17:51.918065 Epoch 27  	Train Loss = 2.72484 Val Loss = 2.93618
2023-12-05 18:20:45.371036 Epoch 28  	Train Loss = 2.71586 Val Loss = 2.90599
2023-12-05 18:23:39.204954 Epoch 29  	Train Loss = 2.70876 Val Loss = 2.91709
2023-12-05 18:26:38.187749 Epoch 30  	Train Loss = 2.70202 Val Loss = 2.90274
Early stopping at epoch: 30
Best at epoch 15:
Train Loss = 2.85769
Train RMSE = 5.34920, MAE = 2.68488, MAPE = 7.07895
Val Loss = 2.89422
Val RMSE = 6.18613, MAE = 2.95135, MAPE = 8.36267
--------- Test ---------
All Steps RMSE = 6.57937, MAE = 3.23750, MAPE = 8.84437
Step 1 RMSE = 4.25467, MAE = 2.40608, MAPE = 5.88945
Step 2 RMSE = 5.07104, MAE = 2.68521, MAPE = 6.78859
Step 3 RMSE = 5.61370, MAE = 2.88227, MAPE = 7.47838
Step 4 RMSE = 6.03986, MAE = 3.04406, MAPE = 8.07311
Step 5 RMSE = 6.39957, MAE = 3.17460, MAPE = 8.56010
Step 6 RMSE = 6.67633, MAE = 3.28141, MAPE = 8.98690
Step 7 RMSE = 6.91577, MAE = 3.37846, MAPE = 9.33889
Step 8 RMSE = 7.09589, MAE = 3.45891, MAPE = 9.68718
Step 9 RMSE = 7.27207, MAE = 3.53646, MAPE = 9.94647
Step 10 RMSE = 7.43324, MAE = 3.60997, MAPE = 10.18154
Step 11 RMSE = 7.54272, MAE = 3.66502, MAPE = 10.48126
Step 12 RMSE = 7.67547, MAE = 3.72763, MAPE = 10.72066
Inference time: 8.36 s
