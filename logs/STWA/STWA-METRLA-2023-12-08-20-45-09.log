METRLA
Trainset:	x-(23974, 12, 207, 1)	y-(23974, 12, 207, 1)
Valset:  	x-(3425, 12, 207, 1)  	y-(3425, 12, 207, 1)
Testset:	x-(6850, 12, 207, 1)	y-(6850, 12, 207, 1)

--------- STWA ---------
{
    "in_steps": 12,
    "out_steps": 12,
    "lr": 0.001,
    "milestones": [],
    "clip_grad": false,
    "batch_size": 16,
    "max_epochs": 200,
    "early_stop": 15,
    "pass_device": true,
    "model_args": {
        "num_nodes": 207,
        "input_dim": 1,
        "output_dim": 1,
        "lag": 12,
        "horizon": 12,
        "device": "cuda:0",
        "channels": 16,
        "memory_size": 16,
        "dynamic": true
    }
}
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
STWA                                               [16, 12, 207, 1]          --
├─Sequential: 1-1                                  [16, 207, 16]             --
│    └─Linear: 2-1                                 [16, 207, 32]             416
│    └─Tanh: 2-2                                   [16, 207, 32]             --
│    └─Linear: 2-3                                 [16, 207, 32]             1,056
│    └─Tanh: 2-4                                   [16, 207, 32]             --
│    └─Linear: 2-5                                 [16, 207, 16]             528
├─Sequential: 1-2                                  [16, 207, 16]             --
│    └─Linear: 2-6                                 [16, 207, 32]             416
│    └─Tanh: 2-7                                   [16, 207, 32]             --
│    └─Linear: 2-8                                 [16, 207, 32]             1,056
│    └─Tanh: 2-9                                   [16, 207, 32]             --
│    └─Linear: 2-10                                [16, 207, 16]             528
├─Linear: 1-3                                      [16, 12, 207, 16]         32
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-11                                 [16, 12, 207, 16]         86,112
│    │    └─ModuleList: 3-1                        --                        6,100
│    │    └─ModuleList: 3-2                        --                        6,100
│    │    └─TemporalAttention: 3-3                 [16, 2, 207, 16]          544
│    │    └─SpatialAttention: 3-4                  [16, 2, 207, 16]          544
│    │    └─Sequential: 3-5                        [16, 2, 207, 16]          544
│    │    └─TemporalAttention: 3-6                 [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-7                  [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-8                        [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-9                 [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-10                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-11                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-12                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-13                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-14                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-15                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-16                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-17                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-18                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-19                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-20                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-21                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-22                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-23                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-24                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-25                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-26                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-27                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-28                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-29                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-30                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-31                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-32                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-33                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-34                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-35                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-36                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-37                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-38                       [16, 2, 207, 16]          (recursive)
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-12                                [16, 207, 256]            49,408
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-13                                 [16, 3, 207, 16]          26,496
│    │    └─ModuleList: 3-39                       --                        6,100
│    │    └─ModuleList: 3-40                       --                        6,100
│    │    └─TemporalAttention: 3-41                [16, 2, 207, 16]          544
│    │    └─SpatialAttention: 3-42                 [16, 2, 207, 16]          544
│    │    └─Sequential: 3-43                       [16, 2, 207, 16]          544
│    │    └─TemporalAttention: 3-44                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-45                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-46                       [16, 2, 207, 16]          (recursive)
│    │    └─TemporalAttention: 3-47                [16, 2, 207, 16]          (recursive)
│    │    └─SpatialAttention: 3-48                 [16, 2, 207, 16]          (recursive)
│    │    └─Sequential: 3-49                       [16, 2, 207, 16]          (recursive)
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-14                                [16, 207, 256]            12,544
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-15                                 [16, 1, 207, 16]          13,248
│    │    └─ModuleList: 3-50                       --                        6,100
│    │    └─ModuleList: 3-51                       --                        6,100
│    │    └─TemporalAttention: 3-52                [16, 2, 207, 16]          544
│    │    └─SpatialAttention: 3-53                 [16, 2, 207, 16]          544
│    │    └─Sequential: 3-54                       [16, 2, 207, 16]          544
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-16                                [16, 207, 256]            4,352
├─Sequential: 1-10                                 [16, 207, 12]             --
│    └─Linear: 2-17                                [16, 207, 512]            131,584
│    └─ReLU: 2-18                                  [16, 207, 512]            --
│    └─Linear: 2-19                                [16, 207, 12]             6,156
====================================================================================================
Total params: 375,428
Trainable params: 375,428
Non-trainable params: 0
Total mult-adds (M): 4.33
====================================================================================================
Input size (MB): 0.16
Forward/backward pass size (MB): 234.97
Params size (MB): 1.00
Estimated Total Size (MB): 236.12
====================================================================================================

Loss: MaskedMAELoss

2023-12-08 20:48:36.675439 Epoch 1  	Train Loss = 3.93899 Val Loss = 3.22371
2023-12-08 20:52:00.908486 Epoch 2  	Train Loss = 3.32365 Val Loss = 3.05358
2023-12-08 20:55:21.758684 Epoch 3  	Train Loss = 3.17994 Val Loss = 2.98172
2023-12-08 20:58:45.067335 Epoch 4  	Train Loss = 3.11394 Val Loss = 2.99907
2023-12-08 21:02:05.948417 Epoch 5  	Train Loss = 3.06572 Val Loss = 2.97171
2023-12-08 21:05:31.407195 Epoch 6  	Train Loss = 3.03235 Val Loss = 2.96991
2023-12-08 21:08:57.057615 Epoch 7  	Train Loss = 3.00232 Val Loss = 2.92915
2023-12-08 21:12:20.363941 Epoch 8  	Train Loss = 2.98140 Val Loss = 2.91432
2023-12-08 21:15:44.424044 Epoch 9  	Train Loss = 2.96172 Val Loss = 2.91452
2023-12-08 21:19:07.720218 Epoch 10  	Train Loss = 2.94351 Val Loss = 2.90333
2023-12-08 21:22:31.005799 Epoch 11  	Train Loss = 2.92454 Val Loss = 2.89196
2023-12-08 21:25:57.634340 Epoch 12  	Train Loss = 2.90667 Val Loss = 2.89117
2023-12-08 21:29:20.937024 Epoch 13  	Train Loss = 3.27045 Val Loss = 3.93099
2023-12-08 21:32:48.783777 Epoch 14  	Train Loss = 3.82800 Val Loss = 3.54986
2023-12-08 21:36:12.511279 Epoch 15  	Train Loss = 3.61188 Val Loss = 3.38222
2023-12-08 21:39:36.023590 Epoch 16  	Train Loss = 3.54202 Val Loss = 3.34112
2023-12-08 21:42:59.497137 Epoch 17  	Train Loss = 3.49902 Val Loss = 3.36447
2023-12-08 21:46:20.642791 Epoch 18  	Train Loss = 3.47967 Val Loss = 3.26538
2023-12-08 21:49:44.924945 Epoch 19  	Train Loss = 3.44787 Val Loss = 3.26517
2023-12-08 21:53:11.118420 Epoch 20  	Train Loss = 3.41440 Val Loss = 3.22076
2023-12-08 21:56:36.667996 Epoch 21  	Train Loss = 3.40227 Val Loss = 3.24447
2023-12-08 21:59:59.987095 Epoch 22  	Train Loss = 3.36534 Val Loss = 3.16933
2023-12-08 22:03:22.532380 Epoch 23  	Train Loss = 3.34879 Val Loss = 3.22111
2023-12-08 22:06:47.217455 Epoch 24  	Train Loss = 3.35063 Val Loss = 3.21849
2023-12-08 22:10:08.895078 Epoch 25  	Train Loss = 3.32817 Val Loss = 3.15783
2023-12-08 22:13:31.759745 Epoch 26  	Train Loss = 3.30667 Val Loss = 3.14537
2023-12-08 22:16:55.706886 Epoch 27  	Train Loss = 3.29672 Val Loss = 3.17299
Early stopping at epoch: 27
Best at epoch 12:
Train Loss = 2.90667
Train RMSE = 5.89489, MAE = 2.88908, MAPE = 7.96340
Val Loss = 2.89117
Val RMSE = 6.17523, MAE = 2.94164, MAPE = 8.57081
--------- Test ---------
All Steps RMSE = 6.52869, MAE = 3.21266, MAPE = 9.00078
Step 1 RMSE = 4.27377, MAE = 2.41652, MAPE = 5.99123
Step 2 RMSE = 5.10023, MAE = 2.70037, MAPE = 6.94771
Step 3 RMSE = 5.62108, MAE = 2.88872, MAPE = 7.65527
Step 4 RMSE = 6.01161, MAE = 3.02410, MAPE = 8.25555
Step 5 RMSE = 6.33840, MAE = 3.14921, MAPE = 8.74909
Step 6 RMSE = 6.60969, MAE = 3.25163, MAPE = 9.21686
Step 7 RMSE = 6.85209, MAE = 3.34656, MAPE = 9.56113
Step 8 RMSE = 7.03825, MAE = 3.42123, MAPE = 9.86117
Step 9 RMSE = 7.19727, MAE = 3.49318, MAPE = 10.12534
Step 10 RMSE = 7.34693, MAE = 3.55940, MAPE = 10.29497
Step 11 RMSE = 7.46351, MAE = 3.62188, MAPE = 10.56768
Step 12 RMSE = 7.59216, MAE = 3.67920, MAPE = 10.78370
Inference time: 11.97 s
