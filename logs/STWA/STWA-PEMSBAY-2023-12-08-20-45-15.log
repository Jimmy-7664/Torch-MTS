PEMSBAY
Trainset:	x-(36465, 12, 325, 1)	y-(36465, 12, 325, 1)
Valset:  	x-(5209, 12, 325, 1)  	y-(5209, 12, 325, 1)
Testset:	x-(10419, 12, 325, 1)	y-(10419, 12, 325, 1)

--------- STWA ---------
{
    "in_steps": 12,
    "out_steps": 12,
    "lr": 0.001,
    "milestones": [],
    "clip_grad": false,
    "batch_size": 16,
    "max_epochs": 200,
    "early_stop": 15,
    "pass_device": true,
    "model_args": {
        "num_nodes": 325,
        "input_dim": 1,
        "output_dim": 1,
        "lag": 12,
        "horizon": 12,
        "device": "cuda:0",
        "channels": 16,
        "memory_size": 16,
        "dynamic": true
    }
}
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
STWA                                               [16, 12, 325, 1]          --
├─Sequential: 1-1                                  [16, 325, 16]             --
│    └─Linear: 2-1                                 [16, 325, 32]             416
│    └─Tanh: 2-2                                   [16, 325, 32]             --
│    └─Linear: 2-3                                 [16, 325, 32]             1,056
│    └─Tanh: 2-4                                   [16, 325, 32]             --
│    └─Linear: 2-5                                 [16, 325, 16]             528
├─Sequential: 1-2                                  [16, 325, 16]             --
│    └─Linear: 2-6                                 [16, 325, 32]             416
│    └─Tanh: 2-7                                   [16, 325, 32]             --
│    └─Linear: 2-8                                 [16, 325, 32]             1,056
│    └─Tanh: 2-9                                   [16, 325, 32]             --
│    └─Linear: 2-10                                [16, 325, 16]             528
├─Linear: 1-3                                      [16, 12, 325, 16]         32
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-11                                 [16, 12, 325, 16]         135,200
│    │    └─ModuleList: 3-1                        --                        6,100
│    │    └─ModuleList: 3-2                        --                        6,100
│    │    └─TemporalAttention: 3-3                 [16, 2, 325, 16]          544
│    │    └─SpatialAttention: 3-4                  [16, 2, 325, 16]          544
│    │    └─Sequential: 3-5                        [16, 2, 325, 16]          544
│    │    └─TemporalAttention: 3-6                 [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-7                  [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-8                        [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-9                 [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-10                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-11                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-12                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-13                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-14                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-15                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-16                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-17                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-18                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-19                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-20                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-21                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-22                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-23                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-24                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-25                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-26                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-27                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-28                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-29                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-30                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-31                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-32                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-33                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-34                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-35                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-36                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-37                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-38                       [16, 2, 325, 16]          (recursive)
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-12                                [16, 325, 256]            49,408
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-13                                 [16, 3, 325, 16]          41,600
│    │    └─ModuleList: 3-39                       --                        6,100
│    │    └─ModuleList: 3-40                       --                        6,100
│    │    └─TemporalAttention: 3-41                [16, 2, 325, 16]          544
│    │    └─SpatialAttention: 3-42                 [16, 2, 325, 16]          544
│    │    └─Sequential: 3-43                       [16, 2, 325, 16]          544
│    │    └─TemporalAttention: 3-44                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-45                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-46                       [16, 2, 325, 16]          (recursive)
│    │    └─TemporalAttention: 3-47                [16, 2, 325, 16]          (recursive)
│    │    └─SpatialAttention: 3-48                 [16, 2, 325, 16]          (recursive)
│    │    └─Sequential: 3-49                       [16, 2, 325, 16]          (recursive)
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-14                                [16, 325, 256]            12,544
├─ModuleList: 1-8                                  --                        (recursive)
│    └─Layer: 2-15                                 [16, 1, 325, 16]          20,800
│    │    └─ModuleList: 3-50                       --                        6,100
│    │    └─ModuleList: 3-51                       --                        6,100
│    │    └─TemporalAttention: 3-52                [16, 2, 325, 16]          544
│    │    └─SpatialAttention: 3-53                 [16, 2, 325, 16]          544
│    │    └─Sequential: 3-54                       [16, 2, 325, 16]          544
├─ModuleList: 1-9                                  --                        (recursive)
│    └─Linear: 2-16                                [16, 325, 256]            4,352
├─Sequential: 1-10                                 [16, 325, 12]             --
│    └─Linear: 2-17                                [16, 325, 512]            131,584
│    └─ReLU: 2-18                                  [16, 325, 512]            --
│    └─Linear: 2-19                                [16, 325, 12]             6,156
====================================================================================================
Total params: 447,172
Trainable params: 447,172
Non-trainable params: 0
Total mult-adds (M): 4.33
====================================================================================================
Input size (MB): 0.25
Forward/backward pass size (MB): 368.91
Params size (MB): 1.00
Estimated Total Size (MB): 370.16
====================================================================================================

Loss: MaskedMAELoss

2023-12-08 20:51:56.642468 Epoch 1  	Train Loss = 2.05949 Val Loss = 2.01120
2023-12-08 20:58:33.145156 Epoch 2  	Train Loss = 1.68913 Val Loss = 1.82186
2023-12-08 21:05:10.615278 Epoch 3  	Train Loss = 1.61334 Val Loss = 1.74625
2023-12-08 21:11:48.626526 Epoch 4  	Train Loss = 1.57340 Val Loss = 1.82492
2023-12-08 21:18:27.016851 Epoch 5  	Train Loss = 1.54455 Val Loss = 1.67967
2023-12-08 21:25:04.863466 Epoch 6  	Train Loss = 1.52022 Val Loss = 1.70940
2023-12-08 21:31:42.927896 Epoch 7  	Train Loss = 1.50395 Val Loss = 1.68186
2023-12-08 21:38:19.087912 Epoch 8  	Train Loss = 1.48533 Val Loss = 1.67365
2023-12-08 21:44:57.073949 Epoch 9  	Train Loss = 1.47077 Val Loss = 1.66267
2023-12-08 21:51:36.189975 Epoch 10  	Train Loss = 1.45850 Val Loss = 1.66464
2023-12-08 21:58:11.850423 Epoch 11  	Train Loss = 1.44768 Val Loss = 1.70416
2023-12-08 22:04:46.836671 Epoch 12  	Train Loss = 1.43779 Val Loss = 1.66654
2023-12-08 22:11:22.415390 Epoch 13  	Train Loss = 1.42877 Val Loss = 1.64738
2023-12-08 22:17:58.815000 Epoch 14  	Train Loss = 1.41814 Val Loss = 1.64888
2023-12-08 22:24:27.293869 Epoch 15  	Train Loss = 1.41351 Val Loss = 1.63103
2023-12-08 22:30:55.570042 Epoch 16  	Train Loss = 1.40480 Val Loss = 1.64239
2023-12-08 22:37:26.245807 Epoch 17  	Train Loss = 1.39844 Val Loss = 1.65924
2023-12-08 22:43:59.105892 Epoch 18  	Train Loss = 1.77185 Val Loss = 1.88938
2023-12-08 22:50:28.881887 Epoch 19  	Train Loss = 1.66553 Val Loss = 1.82423
2023-12-08 22:57:01.131982 Epoch 20  	Train Loss = 1.60719 Val Loss = 1.79710
2023-12-08 23:03:32.327213 Epoch 21  	Train Loss = 1.56740 Val Loss = 1.73702
2023-12-08 23:10:04.013661 Epoch 22  	Train Loss = 1.53500 Val Loss = 1.71713
2023-12-08 23:16:35.329343 Epoch 23  	Train Loss = 1.51031 Val Loss = 1.68988
2023-12-08 23:23:08.392841 Epoch 24  	Train Loss = 1.48878 Val Loss = 1.78209
2023-12-08 23:29:39.579370 Epoch 25  	Train Loss = 1.47295 Val Loss = 1.66320
2023-12-08 23:36:09.694545 Epoch 26  	Train Loss = 1.45975 Val Loss = 1.67424
2023-12-08 23:42:42.732952 Epoch 27  	Train Loss = 1.45117 Val Loss = 1.69262
2023-12-08 23:49:14.903484 Epoch 28  	Train Loss = 1.44067 Val Loss = 1.73297
2023-12-08 23:55:46.310585 Epoch 29  	Train Loss = 1.43138 Val Loss = 1.64103
2023-12-09 00:02:20.502757 Epoch 30  	Train Loss = 1.42272 Val Loss = 1.64290
Early stopping at epoch: 30
Best at epoch 15:
Train Loss = 1.41351
Train RMSE = 3.07968, MAE = 1.40037, MAPE = 2.95928
Val Loss = 1.63103
Val RMSE = 3.71209, MAE = 1.62953, MAPE = 3.66721
--------- Test ---------
All Steps RMSE = 3.69973, MAE = 1.63747, MAPE = 3.64749
Step 1 RMSE = 1.67916, MAE = 0.93041, MAPE = 1.84235
Step 2 RMSE = 2.36035, MAE = 1.18945, MAPE = 2.41010
Step 3 RMSE = 2.88134, MAE = 1.37193, MAPE = 2.85972
Step 4 RMSE = 3.27668, MAE = 1.51001, MAPE = 3.23556
Step 5 RMSE = 3.58037, MAE = 1.61603, MAPE = 3.54505
Step 6 RMSE = 3.81034, MAE = 1.70035, MAPE = 3.80570
Step 7 RMSE = 3.98775, MAE = 1.76835, MAPE = 4.01116
Step 8 RMSE = 4.11995, MAE = 1.82249, MAPE = 4.16048
Step 9 RMSE = 4.22921, MAE = 1.87051, MAPE = 4.30821
Step 10 RMSE = 4.32834, MAE = 1.91405, MAPE = 4.42903
Step 11 RMSE = 4.42369, MAE = 1.95600, MAPE = 4.52897
Step 12 RMSE = 4.51919, MAE = 2.00012, MAPE = 4.63358
Inference time: 27.69 s
