PEMS08
Trainset:	x-(10700, 12, 170, 2)	y-(10700, 12, 170, 1)
Valset:  	x-(3567, 12, 170, 2)  	y-(3567, 12, 170, 1)
Testset:	x-(3566, 12, 170, 2)	y-(3566, 12, 170, 1)

Random seed = 233
--------- Transformer ---------
{
    "num_nodes": 170,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "time_of_day": true,
    "lr": 0.001,
    "milestones": [
        10,
        60
    ],
    "batch_size": 64,
    "max_epochs": 200,
    "model_args": {
        "num_nodes": 170,
        "in_steps": 12,
        "out_steps": 12,
        "input_dim": 1,
        "output_dim": 1,
        "model_dim": 64,
        "feed_forward_dim": 256,
        "num_heads": 4,
        "num_layers": 3,
        "with_spatial": false
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Transformer                              [64, 12, 170, 1]          --
├─Linear: 1-1                            [64, 12, 170, 64]         128
├─Linear: 1-2                            [64, 12, 170, 64]         128
├─ModuleList: 1-3                        --                        --
│    └─SelfAttentionLayer: 2-1           [64, 12, 170, 64]         --
│    │    └─AttentionLayer: 3-1          [64, 170, 12, 64]         16,640
│    │    └─Dropout: 3-2                 [64, 170, 12, 64]         --
│    │    └─LayerNorm: 3-3               [64, 170, 12, 64]         128
│    │    └─Sequential: 3-4              [64, 170, 12, 64]         33,088
│    │    └─Dropout: 3-5                 [64, 170, 12, 64]         --
│    │    └─LayerNorm: 3-6               [64, 170, 12, 64]         128
│    └─SelfAttentionLayer: 2-2           [64, 12, 170, 64]         --
│    │    └─AttentionLayer: 3-7          [64, 170, 12, 64]         16,640
│    │    └─Dropout: 3-8                 [64, 170, 12, 64]         --
│    │    └─LayerNorm: 3-9               [64, 170, 12, 64]         128
│    │    └─Sequential: 3-10             [64, 170, 12, 64]         33,088
│    │    └─Dropout: 3-11                [64, 170, 12, 64]         --
│    │    └─LayerNorm: 3-12              [64, 170, 12, 64]         128
│    └─SelfAttentionLayer: 2-3           [64, 12, 170, 64]         --
│    │    └─AttentionLayer: 3-13         [64, 170, 12, 64]         16,640
│    │    └─Dropout: 3-14                [64, 170, 12, 64]         --
│    │    └─LayerNorm: 3-15              [64, 170, 12, 64]         128
│    │    └─Sequential: 3-16             [64, 170, 12, 64]         33,088
│    │    └─Dropout: 3-17                [64, 170, 12, 64]         --
│    │    └─LayerNorm: 3-18              [64, 170, 12, 64]         128
├─Linear: 1-4                            [64, 64, 170, 12]         156
├─Linear: 1-5                            [64, 12, 170, 1]          65
==========================================================================================
Total params: 150,429
Trainable params: 150,429
Non-trainable params: 0
Total mult-adds (M): 9.63
==========================================================================================
Input size (MB): 1.04
Forward/backward pass size (MB): 2407.53
Params size (MB): 0.60
Estimated Total Size (MB): 2409.17
==========================================================================================

Loss: HuberLoss

2024-04-20 09:49:23.473677 Epoch 1  	Train Loss = 34.15482 Val Loss = 24.33757
2024-04-20 09:49:31.973515 Epoch 2  	Train Loss = 22.63202 Val Loss = 22.05251
2024-04-20 09:49:40.496874 Epoch 3  	Train Loss = 21.08594 Val Loss = 23.61407
2024-04-20 09:49:49.044666 Epoch 4  	Train Loss = 20.69192 Val Loss = 21.31040
2024-04-20 09:49:57.639893 Epoch 5  	Train Loss = 20.50792 Val Loss = 21.34590
2024-04-20 09:50:06.284725 Epoch 6  	Train Loss = 20.37962 Val Loss = 21.64001
2024-04-20 09:50:14.921991 Epoch 7  	Train Loss = 20.16307 Val Loss = 20.19388
2024-04-20 09:50:23.566569 Epoch 8  	Train Loss = 20.05763 Val Loss = 20.59823
2024-04-20 09:50:32.189930 Epoch 9  	Train Loss = 19.91259 Val Loss = 20.88242
2024-04-20 09:50:40.771998 Epoch 10  	Train Loss = 19.62172 Val Loss = 19.51182
2024-04-20 09:50:49.366073 Epoch 11  	Train Loss = 18.91647 Val Loss = 19.22020
2024-04-20 09:50:57.963010 Epoch 12  	Train Loss = 18.90610 Val Loss = 19.06647
2024-04-20 09:51:06.583405 Epoch 13  	Train Loss = 18.87232 Val Loss = 19.10724
2024-04-20 09:51:15.169916 Epoch 14  	Train Loss = 18.80748 Val Loss = 19.06686
2024-04-20 09:51:23.803223 Epoch 15  	Train Loss = 18.79730 Val Loss = 19.06123
2024-04-20 09:51:32.482686 Epoch 16  	Train Loss = 18.76071 Val Loss = 18.94374
2024-04-20 09:51:41.088942 Epoch 17  	Train Loss = 18.74365 Val Loss = 19.11848
2024-04-20 09:51:49.679039 Epoch 18  	Train Loss = 18.70949 Val Loss = 18.89347
2024-04-20 09:51:58.269780 Epoch 19  	Train Loss = 18.69009 Val Loss = 18.88327
2024-04-20 09:52:06.865164 Epoch 20  	Train Loss = 18.67354 Val Loss = 18.86094
2024-04-20 09:52:15.462751 Epoch 21  	Train Loss = 18.65785 Val Loss = 18.85426
2024-04-20 09:52:24.061559 Epoch 22  	Train Loss = 18.61887 Val Loss = 18.78751
2024-04-20 09:52:32.657181 Epoch 23  	Train Loss = 18.57223 Val Loss = 18.75331
2024-04-20 09:52:41.247220 Epoch 24  	Train Loss = 18.55859 Val Loss = 18.72760
2024-04-20 09:52:49.840661 Epoch 25  	Train Loss = 18.53510 Val Loss = 18.73308
2024-04-20 09:52:58.438229 Epoch 26  	Train Loss = 18.51042 Val Loss = 18.69903
2024-04-20 09:53:07.039118 Epoch 27  	Train Loss = 18.47343 Val Loss = 18.84890
2024-04-20 09:53:15.626379 Epoch 28  	Train Loss = 18.49331 Val Loss = 18.64912
2024-04-20 09:53:24.272755 Epoch 29  	Train Loss = 18.46087 Val Loss = 18.76746
2024-04-20 09:53:32.878115 Epoch 30  	Train Loss = 18.46135 Val Loss = 18.75988
2024-04-20 09:53:41.471952 Epoch 31  	Train Loss = 18.46753 Val Loss = 18.59156
2024-04-20 09:53:50.064477 Epoch 32  	Train Loss = 18.41495 Val Loss = 18.72763
2024-04-20 09:53:58.653870 Epoch 33  	Train Loss = 18.39627 Val Loss = 18.57471
2024-04-20 09:54:07.248866 Epoch 34  	Train Loss = 18.39775 Val Loss = 18.71304
2024-04-20 09:54:15.861250 Epoch 35  	Train Loss = 18.34874 Val Loss = 18.66101
2024-04-20 09:54:24.464691 Epoch 36  	Train Loss = 18.37971 Val Loss = 18.56945
2024-04-20 09:54:33.059010 Epoch 37  	Train Loss = 18.35692 Val Loss = 18.51986
2024-04-20 09:54:41.714088 Epoch 38  	Train Loss = 18.32434 Val Loss = 18.56474
2024-04-20 09:54:50.380539 Epoch 39  	Train Loss = 18.34003 Val Loss = 18.45986
2024-04-20 09:54:59.055656 Epoch 40  	Train Loss = 18.32367 Val Loss = 18.69065
2024-04-20 09:55:07.719502 Epoch 41  	Train Loss = 18.32784 Val Loss = 18.47788
2024-04-20 09:55:16.380175 Epoch 42  	Train Loss = 18.27528 Val Loss = 18.48278
2024-04-20 09:55:25.047896 Epoch 43  	Train Loss = 18.27971 Val Loss = 18.42269
2024-04-20 09:55:33.717421 Epoch 44  	Train Loss = 18.25527 Val Loss = 18.45696
2024-04-20 09:55:42.325875 Epoch 45  	Train Loss = 18.27950 Val Loss = 18.49841
2024-04-20 09:55:50.919818 Epoch 46  	Train Loss = 18.24109 Val Loss = 18.42579
2024-04-20 09:55:59.512272 Epoch 47  	Train Loss = 18.23228 Val Loss = 18.39619
2024-04-20 09:56:08.119315 Epoch 48  	Train Loss = 18.22495 Val Loss = 18.45580
2024-04-20 09:56:16.714183 Epoch 49  	Train Loss = 18.21135 Val Loss = 18.31723
2024-04-20 09:56:25.312888 Epoch 50  	Train Loss = 18.23169 Val Loss = 18.45293
2024-04-20 09:56:33.954441 Epoch 51  	Train Loss = 18.18866 Val Loss = 18.32933
2024-04-20 09:56:42.621875 Epoch 52  	Train Loss = 18.18761 Val Loss = 18.31535
2024-04-20 09:56:51.290192 Epoch 53  	Train Loss = 18.19039 Val Loss = 18.36496
2024-04-20 09:56:59.902939 Epoch 54  	Train Loss = 18.20044 Val Loss = 18.32669
2024-04-20 09:57:08.500425 Epoch 55  	Train Loss = 18.17530 Val Loss = 18.37759
2024-04-20 09:57:17.098490 Epoch 56  	Train Loss = 18.13196 Val Loss = 18.26686
2024-04-20 09:57:25.763396 Epoch 57  	Train Loss = 18.18115 Val Loss = 18.33626
2024-04-20 09:57:34.439568 Epoch 58  	Train Loss = 18.14835 Val Loss = 18.59738
2024-04-20 09:57:43.111121 Epoch 59  	Train Loss = 18.15636 Val Loss = 18.22259
2024-04-20 09:57:51.787764 Epoch 60  	Train Loss = 18.12387 Val Loss = 18.27887
2024-04-20 09:58:00.461161 Epoch 61  	Train Loss = 18.02195 Val Loss = 18.18883
2024-04-20 09:58:09.132241 Epoch 62  	Train Loss = 18.01581 Val Loss = 18.20581
2024-04-20 09:58:17.740151 Epoch 63  	Train Loss = 18.00018 Val Loss = 18.20611
2024-04-20 09:58:26.336297 Epoch 64  	Train Loss = 18.00328 Val Loss = 18.20443
2024-04-20 09:58:34.946057 Epoch 65  	Train Loss = 18.00080 Val Loss = 18.17749
2024-04-20 09:58:43.621392 Epoch 66  	Train Loss = 17.99898 Val Loss = 18.18959
2024-04-20 09:58:52.291812 Epoch 67  	Train Loss = 17.98833 Val Loss = 18.19021
2024-04-20 09:59:00.958844 Epoch 68  	Train Loss = 18.00234 Val Loss = 18.17573
2024-04-20 09:59:09.587435 Epoch 69  	Train Loss = 17.97994 Val Loss = 18.17446
2024-04-20 09:59:18.191835 Epoch 70  	Train Loss = 17.99498 Val Loss = 18.18481
2024-04-20 09:59:26.851811 Epoch 71  	Train Loss = 18.00000 Val Loss = 18.15463
2024-04-20 09:59:35.458530 Epoch 72  	Train Loss = 17.98896 Val Loss = 18.17571
2024-04-20 09:59:44.062009 Epoch 73  	Train Loss = 17.98344 Val Loss = 18.18162
2024-04-20 09:59:52.662923 Epoch 74  	Train Loss = 17.98940 Val Loss = 18.16663
2024-04-20 10:00:01.258127 Epoch 75  	Train Loss = 17.99518 Val Loss = 18.16509
2024-04-20 10:00:09.879965 Epoch 76  	Train Loss = 17.99827 Val Loss = 18.17118
2024-04-20 10:00:18.527875 Epoch 77  	Train Loss = 17.97823 Val Loss = 18.16783
2024-04-20 10:00:27.203775 Epoch 78  	Train Loss = 17.99445 Val Loss = 18.14691
2024-04-20 10:00:35.880701 Epoch 79  	Train Loss = 17.97712 Val Loss = 18.16365
2024-04-20 10:00:44.548409 Epoch 80  	Train Loss = 17.99403 Val Loss = 18.17033
2024-04-20 10:00:53.139696 Epoch 81  	Train Loss = 17.97726 Val Loss = 18.14693
2024-04-20 10:01:01.741667 Epoch 82  	Train Loss = 17.96965 Val Loss = 18.14178
2024-04-20 10:01:10.341226 Epoch 83  	Train Loss = 17.98360 Val Loss = 18.17613
2024-04-20 10:01:18.976994 Epoch 84  	Train Loss = 17.97388 Val Loss = 18.15367
2024-04-20 10:01:27.637205 Epoch 85  	Train Loss = 17.98246 Val Loss = 18.14618
2024-04-20 10:01:36.314969 Epoch 86  	Train Loss = 17.96948 Val Loss = 18.14904
2024-04-20 10:01:44.993215 Epoch 87  	Train Loss = 17.96495 Val Loss = 18.16785
2024-04-20 10:01:53.668156 Epoch 88  	Train Loss = 17.98366 Val Loss = 18.13464
2024-04-20 10:02:02.291517 Epoch 89  	Train Loss = 17.97030 Val Loss = 18.15188
2024-04-20 10:02:10.895876 Epoch 90  	Train Loss = 17.96992 Val Loss = 18.16491
2024-04-20 10:02:19.497870 Epoch 91  	Train Loss = 17.96809 Val Loss = 18.14059
2024-04-20 10:02:28.098282 Epoch 92  	Train Loss = 17.95523 Val Loss = 18.18939
2024-04-20 10:02:36.733459 Epoch 93  	Train Loss = 17.96408 Val Loss = 18.14542
2024-04-20 10:02:45.414863 Epoch 94  	Train Loss = 17.95280 Val Loss = 18.13565
2024-04-20 10:02:54.087941 Epoch 95  	Train Loss = 17.97072 Val Loss = 18.14882
2024-04-20 10:03:02.746930 Epoch 96  	Train Loss = 17.97691 Val Loss = 18.11756
2024-04-20 10:03:11.408278 Epoch 97  	Train Loss = 17.94964 Val Loss = 18.13417
2024-04-20 10:03:20.046017 Epoch 98  	Train Loss = 17.96558 Val Loss = 18.16271
2024-04-20 10:03:28.647657 Epoch 99  	Train Loss = 17.95803 Val Loss = 18.17144
2024-04-20 10:03:37.242819 Epoch 100  	Train Loss = 17.96431 Val Loss = 18.13234
2024-04-20 10:03:45.839482 Epoch 101  	Train Loss = 17.95386 Val Loss = 18.11625
2024-04-20 10:03:54.437912 Epoch 102  	Train Loss = 17.95665 Val Loss = 18.15155
2024-04-20 10:04:03.030086 Epoch 103  	Train Loss = 17.94600 Val Loss = 18.13422
2024-04-20 10:04:11.620699 Epoch 104  	Train Loss = 17.95559 Val Loss = 18.13207
2024-04-20 10:04:20.208862 Epoch 105  	Train Loss = 17.94922 Val Loss = 18.13863
2024-04-20 10:04:28.862738 Epoch 106  	Train Loss = 17.95870 Val Loss = 18.14714
2024-04-20 10:04:37.488978 Epoch 107  	Train Loss = 17.94026 Val Loss = 18.12178
2024-04-20 10:04:46.088728 Epoch 108  	Train Loss = 17.95669 Val Loss = 18.13255
2024-04-20 10:04:54.744645 Epoch 109  	Train Loss = 17.94896 Val Loss = 18.12257
2024-04-20 10:05:03.412967 Epoch 110  	Train Loss = 17.92853 Val Loss = 18.13611
2024-04-20 10:05:12.081966 Epoch 111  	Train Loss = 17.94534 Val Loss = 18.11028
2024-04-20 10:05:20.745013 Epoch 112  	Train Loss = 17.94114 Val Loss = 18.13575
2024-04-20 10:05:29.420845 Epoch 113  	Train Loss = 17.93166 Val Loss = 18.10183
2024-04-20 10:05:38.101961 Epoch 114  	Train Loss = 17.93653 Val Loss = 18.11328
2024-04-20 10:05:46.765080 Epoch 115  	Train Loss = 17.94613 Val Loss = 18.11771
2024-04-20 10:05:55.396828 Epoch 116  	Train Loss = 17.93375 Val Loss = 18.11148
2024-04-20 10:06:04.003759 Epoch 117  	Train Loss = 17.93784 Val Loss = 18.11726
2024-04-20 10:06:12.636162 Epoch 118  	Train Loss = 17.94931 Val Loss = 18.12093
2024-04-20 10:06:21.296407 Epoch 119  	Train Loss = 17.92152 Val Loss = 18.10280
2024-04-20 10:06:29.974082 Epoch 120  	Train Loss = 17.91799 Val Loss = 18.12541
2024-04-20 10:06:38.649648 Epoch 121  	Train Loss = 17.93271 Val Loss = 18.10642
2024-04-20 10:06:47.325775 Epoch 122  	Train Loss = 17.93944 Val Loss = 18.12184
2024-04-20 10:06:55.996459 Epoch 123  	Train Loss = 17.93070 Val Loss = 18.10010
2024-04-20 10:07:04.672362 Epoch 124  	Train Loss = 17.91241 Val Loss = 18.11421
2024-04-20 10:07:13.301511 Epoch 125  	Train Loss = 17.92376 Val Loss = 18.12968
2024-04-20 10:07:21.927400 Epoch 126  	Train Loss = 17.92838 Val Loss = 18.13778
2024-04-20 10:07:30.533009 Epoch 127  	Train Loss = 17.91266 Val Loss = 18.11942
2024-04-20 10:07:39.194582 Epoch 128  	Train Loss = 17.90952 Val Loss = 18.10675
2024-04-20 10:07:47.860772 Epoch 129  	Train Loss = 17.92107 Val Loss = 18.11751
2024-04-20 10:07:56.528621 Epoch 130  	Train Loss = 17.91020 Val Loss = 18.09816
2024-04-20 10:08:05.202824 Epoch 131  	Train Loss = 17.89846 Val Loss = 18.10468
2024-04-20 10:08:13.873719 Epoch 132  	Train Loss = 17.92215 Val Loss = 18.09182
2024-04-20 10:08:22.516337 Epoch 133  	Train Loss = 17.90782 Val Loss = 18.07989
2024-04-20 10:08:31.142345 Epoch 134  	Train Loss = 17.89444 Val Loss = 18.09864
2024-04-20 10:08:39.736675 Epoch 135  	Train Loss = 17.90094 Val Loss = 18.11182
2024-04-20 10:08:48.334585 Epoch 136  	Train Loss = 17.92176 Val Loss = 18.09842
2024-04-20 10:08:56.932919 Epoch 137  	Train Loss = 17.91697 Val Loss = 18.11048
2024-04-20 10:09:05.528445 Epoch 138  	Train Loss = 17.92451 Val Loss = 18.09852
2024-04-20 10:09:14.131253 Epoch 139  	Train Loss = 17.91924 Val Loss = 18.09437
2024-04-20 10:09:22.726930 Epoch 140  	Train Loss = 17.90482 Val Loss = 18.08468
2024-04-20 10:09:31.337189 Epoch 141  	Train Loss = 17.91327 Val Loss = 18.10277
2024-04-20 10:09:39.958920 Epoch 142  	Train Loss = 17.90712 Val Loss = 18.07325
2024-04-20 10:09:48.566263 Epoch 143  	Train Loss = 17.90140 Val Loss = 18.09938
2024-04-20 10:09:57.164573 Epoch 144  	Train Loss = 17.89709 Val Loss = 18.08460
2024-04-20 10:10:05.802407 Epoch 145  	Train Loss = 17.92623 Val Loss = 18.08367
2024-04-20 10:10:14.438553 Epoch 146  	Train Loss = 17.90825 Val Loss = 18.11536
2024-04-20 10:10:23.023147 Epoch 147  	Train Loss = 17.89986 Val Loss = 18.09448
2024-04-20 10:10:31.602487 Epoch 148  	Train Loss = 17.90228 Val Loss = 18.06266
2024-04-20 10:10:40.191511 Epoch 149  	Train Loss = 17.89723 Val Loss = 18.07384
2024-04-20 10:10:48.777681 Epoch 150  	Train Loss = 17.89805 Val Loss = 18.10626
2024-04-20 10:10:57.372499 Epoch 151  	Train Loss = 17.89644 Val Loss = 18.08837
2024-04-20 10:11:05.968470 Epoch 152  	Train Loss = 17.90381 Val Loss = 18.06819
2024-04-20 10:11:14.566078 Epoch 153  	Train Loss = 17.90255 Val Loss = 18.05741
2024-04-20 10:11:23.165495 Epoch 154  	Train Loss = 17.88464 Val Loss = 18.07730
2024-04-20 10:11:31.753881 Epoch 155  	Train Loss = 17.90282 Val Loss = 18.09991
2024-04-20 10:11:40.346116 Epoch 156  	Train Loss = 17.89262 Val Loss = 18.12103
2024-04-20 10:11:48.942539 Epoch 157  	Train Loss = 17.88026 Val Loss = 18.08038
2024-04-20 10:11:57.533600 Epoch 158  	Train Loss = 17.89517 Val Loss = 18.06114
2024-04-20 10:12:06.128193 Epoch 159  	Train Loss = 17.88305 Val Loss = 18.07856
2024-04-20 10:12:14.726448 Epoch 160  	Train Loss = 17.89109 Val Loss = 18.07235
2024-04-20 10:12:23.322242 Epoch 161  	Train Loss = 17.89485 Val Loss = 18.09008
2024-04-20 10:12:31.969799 Epoch 162  	Train Loss = 17.87484 Val Loss = 18.06997
2024-04-20 10:12:40.625743 Epoch 163  	Train Loss = 17.89493 Val Loss = 18.08306
Early stopping at epoch: 163
Best at epoch 153:
Train Loss = 17.90255
Train MAE = 18.37586, RMSE = 29.53107, MAPE = 11.47939
Val Loss = 18.05741
Val MAE = 18.53930, RMSE = 29.80759, MAPE = 11.98851
Model checkpoint saved to: ../saved_models/Transformer/Transformer-PEMS08-2024-04-20-09-49-13.pt
--------- Test ---------
All Steps (1-12) MAE = 18.11585, RMSE = 28.72896, MAPE = 11.28305
Step 1 MAE = 14.06264, RMSE = 21.91558, MAPE = 8.86603
Step 2 MAE = 15.05316, RMSE = 23.56919, MAPE = 9.37220
Step 3 MAE = 15.96958, RMSE = 25.13908, MAPE = 9.89497
Step 4 MAE = 16.64795, RMSE = 26.29798, MAPE = 10.28531
Step 5 MAE = 17.31096, RMSE = 27.39581, MAPE = 10.69544
Step 6 MAE = 17.96566, RMSE = 28.40468, MAPE = 11.11993
Step 7 MAE = 18.55912, RMSE = 29.34554, MAPE = 11.49935
Step 8 MAE = 19.12612, RMSE = 30.20631, MAPE = 11.87033
Step 9 MAE = 19.67084, RMSE = 31.00595, MAPE = 12.26196
Step 10 MAE = 20.19664, RMSE = 31.76007, MAPE = 12.65260
Step 11 MAE = 20.93728, RMSE = 32.81298, MAPE = 13.14573
Step 12 MAE = 21.89020, RMSE = 34.16409, MAPE = 13.73271
Inference time: 0.88 s
