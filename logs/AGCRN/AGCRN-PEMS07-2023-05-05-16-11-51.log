PEMS07
Trainset:	x-(16921, 12, 883, 1)	y-(16921, 12, 883, 1)
Valset:  	x-(5640, 12, 883, 1)  	y-(5640, 12, 883, 1)
Testset:	x-(5640, 12, 883, 1)	y-(5640, 12, 883, 1)

--------- AGCRN ---------
{
    "num_nodes": 883,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "lr": 0.001,
    "weight_decay": 0,
    "milestones": [],
    "clip_grad": 0,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": false,
    "cl_step_size": 2500,
    "model_args": {
        "num_nodes": 883,
        "out_steps": 12,
        "input_dim": 1,
        "output_dim": 1,
        "embed_dim": 10,
        "rnn_units": 64,
        "num_layers": 2,
        "cheb_k": 2,
        "default_graph": true
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
AGCRN                                    [64, 12, 883, 1]          8,830
├─AVWDCRNN: 1-1                          [64, 12, 883, 64]         --
│    └─ModuleList: 2-1                   --                        --
│    │    └─AGCRNCell: 3-1               [64, 883, 64]             251,520
│    │    └─AGCRNCell: 3-2               [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-3               [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-4               [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-5               [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-6               [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-7               [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-8               [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-9               [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-10              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-11              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-12              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-13              [64, 883, 64]             493,440
│    │    └─AGCRNCell: 3-14              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-15              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-16              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-17              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-18              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-19              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-20              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-21              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-22              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-23              [64, 883, 64]             (recursive)
│    │    └─AGCRNCell: 3-24              [64, 883, 64]             (recursive)
├─Conv2d: 1-2                            [64, 12, 883, 1]          780
==========================================================================================
Total params: 754,570
Trainable params: 754,570
Non-trainable params: 0
Total mult-adds (G): 505.23
==========================================================================================
Input size (MB): 2.71
Forward/backward pass size (MB): 179.03
Params size (MB): 2.98
Estimated Total Size (MB): 184.73
==========================================================================================

Loss: HuberLoss

2023-05-05 16:13:32.897443 Epoch 1  	Train Loss = 42.35777 Val Loss = 27.99406
2023-05-05 16:15:04.537338 Epoch 2  	Train Loss = 27.37916 Val Loss = 26.57624
2023-05-05 16:16:36.165062 Epoch 3  	Train Loss = 26.23063 Val Loss = 25.49109
2023-05-05 16:18:07.153559 Epoch 4  	Train Loss = 25.62958 Val Loss = 24.92539
2023-05-05 16:19:38.683163 Epoch 5  	Train Loss = 24.97969 Val Loss = 24.69444
2023-05-05 16:21:11.143368 Epoch 6  	Train Loss = 24.65396 Val Loss = 24.23067
2023-05-05 16:22:43.241036 Epoch 7  	Train Loss = 24.18580 Val Loss = 24.06791
2023-05-05 16:24:15.478907 Epoch 8  	Train Loss = 23.88896 Val Loss = 24.13890
2023-05-05 16:25:47.079660 Epoch 9  	Train Loss = 23.60440 Val Loss = 23.45932
2023-05-05 16:27:18.376682 Epoch 10  	Train Loss = 23.25174 Val Loss = 23.57070
2023-05-05 16:28:49.626442 Epoch 11  	Train Loss = 23.04370 Val Loss = 23.60164
2023-05-05 16:30:20.927285 Epoch 12  	Train Loss = 22.85965 Val Loss = 23.00330
2023-05-05 16:31:52.019694 Epoch 13  	Train Loss = 22.58420 Val Loss = 22.89966
2023-05-05 16:33:24.234628 Epoch 14  	Train Loss = 22.46796 Val Loss = 22.74200
2023-05-05 16:34:55.805369 Epoch 15  	Train Loss = 22.23022 Val Loss = 22.97027
2023-05-05 16:36:26.910942 Epoch 16  	Train Loss = 22.11562 Val Loss = 22.73661
2023-05-05 16:37:57.564446 Epoch 17  	Train Loss = 21.95225 Val Loss = 22.66627
2023-05-05 16:39:28.236140 Epoch 18  	Train Loss = 21.76967 Val Loss = 22.30948
2023-05-05 16:40:58.902691 Epoch 19  	Train Loss = 21.64914 Val Loss = 22.29689
2023-05-05 16:42:30.325854 Epoch 20  	Train Loss = 21.55059 Val Loss = 22.35796
2023-05-05 16:44:01.281585 Epoch 21  	Train Loss = 21.44153 Val Loss = 22.07313
2023-05-05 16:45:34.170601 Epoch 22  	Train Loss = 21.36082 Val Loss = 22.07817
2023-05-05 16:47:07.378302 Epoch 23  	Train Loss = 21.21193 Val Loss = 22.34873
2023-05-05 16:48:40.225060 Epoch 24  	Train Loss = 21.18111 Val Loss = 21.95415
2023-05-05 16:50:11.833935 Epoch 25  	Train Loss = 21.05098 Val Loss = 22.01089
2023-05-05 16:51:43.410820 Epoch 26  	Train Loss = 20.95542 Val Loss = 22.34146
2023-05-05 16:53:15.131299 Epoch 27  	Train Loss = 20.86135 Val Loss = 21.68250
2023-05-05 16:54:46.647653 Epoch 28  	Train Loss = 20.82194 Val Loss = 21.76636
2023-05-05 16:56:17.699958 Epoch 29  	Train Loss = 20.78400 Val Loss = 21.64263
2023-05-05 16:57:48.604099 Epoch 30  	Train Loss = 20.64886 Val Loss = 21.69182
2023-05-05 16:59:19.881215 Epoch 31  	Train Loss = 20.58969 Val Loss = 21.70296
2023-05-05 17:00:51.545901 Epoch 32  	Train Loss = 20.57604 Val Loss = 21.73083
2023-05-05 17:02:22.947224 Epoch 33  	Train Loss = 20.49568 Val Loss = 21.50845
2023-05-05 17:03:54.340554 Epoch 34  	Train Loss = 20.46044 Val Loss = 21.44342
2023-05-05 17:05:26.538718 Epoch 35  	Train Loss = 20.38925 Val Loss = 21.42314
2023-05-05 17:06:58.013072 Epoch 36  	Train Loss = 20.33390 Val Loss = 21.60587
2023-05-05 17:08:29.203380 Epoch 37  	Train Loss = 20.29192 Val Loss = 21.42078
2023-05-05 17:10:00.609478 Epoch 38  	Train Loss = 20.25473 Val Loss = 21.48743
2023-05-05 17:11:31.684205 Epoch 39  	Train Loss = 20.17903 Val Loss = 21.37280
2023-05-05 17:13:03.029819 Epoch 40  	Train Loss = 20.18127 Val Loss = 21.51173
2023-05-05 17:14:34.163986 Epoch 41  	Train Loss = 20.06352 Val Loss = 21.30410
2023-05-05 17:16:05.459039 Epoch 42  	Train Loss = 20.08916 Val Loss = 21.28672
2023-05-05 17:17:36.902396 Epoch 43  	Train Loss = 20.00710 Val Loss = 21.14461
2023-05-05 17:19:08.412450 Epoch 44  	Train Loss = 19.94648 Val Loss = 21.19963
2023-05-05 17:20:41.131700 Epoch 45  	Train Loss = 19.99387 Val Loss = 21.20611
2023-05-05 17:22:11.990718 Epoch 46  	Train Loss = 19.89923 Val Loss = 21.13471
2023-05-05 17:23:43.127935 Epoch 47  	Train Loss = 19.88884 Val Loss = 21.25614
2023-05-05 17:25:15.693168 Epoch 48  	Train Loss = 19.83515 Val Loss = 21.14421
2023-05-05 17:26:46.830340 Epoch 49  	Train Loss = 19.78791 Val Loss = 21.05963
2023-05-05 17:28:18.341992 Epoch 50  	Train Loss = 19.82402 Val Loss = 21.20123
2023-05-05 17:29:49.540872 Epoch 51  	Train Loss = 19.76460 Val Loss = 21.06142
2023-05-05 17:31:21.178370 Epoch 52  	Train Loss = 19.68161 Val Loss = 21.04617
2023-05-05 17:32:52.454483 Epoch 53  	Train Loss = 19.71301 Val Loss = 21.06368
2023-05-05 17:34:25.744099 Epoch 54  	Train Loss = 19.63968 Val Loss = 21.07709
2023-05-05 17:35:57.250309 Epoch 55  	Train Loss = 19.62671 Val Loss = 21.05671
2023-05-05 17:37:28.316659 Epoch 56  	Train Loss = 19.58993 Val Loss = 20.95294
2023-05-05 17:38:59.687843 Epoch 57  	Train Loss = 19.61996 Val Loss = 20.91307
2023-05-05 17:40:30.351389 Epoch 58  	Train Loss = 19.55372 Val Loss = 20.88842
2023-05-05 17:42:01.749549 Epoch 59  	Train Loss = 19.53842 Val Loss = 21.01454
2023-05-05 17:43:37.118832 Epoch 60  	Train Loss = 19.52970 Val Loss = 21.03956
2023-05-05 17:45:08.737424 Epoch 61  	Train Loss = 19.45727 Val Loss = 20.85326
2023-05-05 17:46:40.328452 Epoch 62  	Train Loss = 19.42816 Val Loss = 20.95523
2023-05-05 17:48:11.450338 Epoch 63  	Train Loss = 19.42601 Val Loss = 20.93062
2023-05-05 17:49:41.967905 Epoch 64  	Train Loss = 19.46286 Val Loss = 21.11550
2023-05-05 17:51:13.000925 Epoch 65  	Train Loss = 19.42035 Val Loss = 20.83500
2023-05-05 17:52:44.254473 Epoch 66  	Train Loss = 19.40569 Val Loss = 20.89026
2023-05-05 17:54:15.602701 Epoch 67  	Train Loss = 19.33201 Val Loss = 20.93042
2023-05-05 17:55:47.158219 Epoch 68  	Train Loss = 19.31362 Val Loss = 20.78195
2023-05-05 17:57:18.503665 Epoch 69  	Train Loss = 19.28020 Val Loss = 20.84204
2023-05-05 17:58:50.944830 Epoch 70  	Train Loss = 19.27602 Val Loss = 20.78599
2023-05-05 18:00:22.164467 Epoch 71  	Train Loss = 19.26548 Val Loss = 20.91867
2023-05-05 18:01:53.432337 Epoch 72  	Train Loss = 19.27549 Val Loss = 20.82749
2023-05-05 18:03:24.607067 Epoch 73  	Train Loss = 19.29177 Val Loss = 20.78641
2023-05-05 18:04:55.842818 Epoch 74  	Train Loss = 19.20198 Val Loss = 20.78339
2023-05-05 18:06:26.936217 Epoch 75  	Train Loss = 19.18227 Val Loss = 20.76885
2023-05-05 18:07:58.173807 Epoch 76  	Train Loss = 19.20132 Val Loss = 20.75134
2023-05-05 18:09:29.291798 Epoch 77  	Train Loss = 19.14240 Val Loss = 20.75014
2023-05-05 18:11:00.855470 Epoch 78  	Train Loss = 19.14986 Val Loss = 20.78341
2023-05-05 18:12:31.778636 Epoch 79  	Train Loss = 19.15559 Val Loss = 20.70904
2023-05-05 18:14:03.042971 Epoch 80  	Train Loss = 19.11640 Val Loss = 20.82039
2023-05-05 18:15:34.396185 Epoch 81  	Train Loss = 19.10320 Val Loss = 20.72076
2023-05-05 18:17:06.082353 Epoch 82  	Train Loss = 19.05916 Val Loss = 20.84745
2023-05-05 18:18:37.670376 Epoch 83  	Train Loss = 19.08673 Val Loss = 20.71005
2023-05-05 18:20:10.061754 Epoch 84  	Train Loss = 19.02345 Val Loss = 20.70150
2023-05-05 18:21:41.548774 Epoch 85  	Train Loss = 19.00777 Val Loss = 20.66261
2023-05-05 18:23:13.125491 Epoch 86  	Train Loss = 19.06723 Val Loss = 20.69259
2023-05-05 18:24:44.605605 Epoch 87  	Train Loss = 19.02325 Val Loss = 20.66244
2023-05-05 18:26:16.188502 Epoch 88  	Train Loss = 19.00386 Val Loss = 20.70124
2023-05-05 18:27:47.416048 Epoch 89  	Train Loss = 18.97114 Val Loss = 20.67006
2023-05-05 18:29:18.654471 Epoch 90  	Train Loss = 18.95879 Val Loss = 20.68998
2023-05-05 18:30:49.857210 Epoch 91  	Train Loss = 18.91393 Val Loss = 20.71092
2023-05-05 18:32:20.385490 Epoch 92  	Train Loss = 18.99288 Val Loss = 20.69333
2023-05-05 18:33:51.296152 Epoch 93  	Train Loss = 18.92643 Val Loss = 20.70366
2023-05-05 18:35:22.740876 Epoch 94  	Train Loss = 18.88878 Val Loss = 20.72828
2023-05-05 18:36:54.148902 Epoch 95  	Train Loss = 18.92172 Val Loss = 20.61582
2023-05-05 18:38:25.643043 Epoch 96  	Train Loss = 18.85368 Val Loss = 20.59709
2023-05-05 18:39:57.174014 Epoch 97  	Train Loss = 18.88005 Val Loss = 20.76519
2023-05-05 18:41:28.652925 Epoch 98  	Train Loss = 18.83409 Val Loss = 20.74513
2023-05-05 18:43:00.210916 Epoch 99  	Train Loss = 18.86382 Val Loss = 20.64191
2023-05-05 18:44:31.458569 Epoch 100  	Train Loss = 18.83456 Val Loss = 20.60236
2023-05-05 18:46:04.687084 Epoch 101  	Train Loss = 18.78452 Val Loss = 20.70807
2023-05-05 18:47:35.881808 Epoch 102  	Train Loss = 18.87794 Val Loss = 20.59234
2023-05-05 18:49:06.882023 Epoch 103  	Train Loss = 18.82293 Val Loss = 20.62350
2023-05-05 18:50:38.110597 Epoch 104  	Train Loss = 18.77643 Val Loss = 20.67516
2023-05-05 18:52:10.482138 Epoch 105  	Train Loss = 18.78540 Val Loss = 20.62562
2023-05-05 18:53:41.783710 Epoch 106  	Train Loss = 18.76874 Val Loss = 20.62824
2023-05-05 18:55:13.269954 Epoch 107  	Train Loss = 18.74768 Val Loss = 20.62950
2023-05-05 18:56:44.663247 Epoch 108  	Train Loss = 18.75553 Val Loss = 20.62797
2023-05-05 18:58:15.834993 Epoch 109  	Train Loss = 18.73897 Val Loss = 20.58110
2023-05-05 18:59:46.698906 Epoch 110  	Train Loss = 18.71930 Val Loss = 20.66940
2023-05-05 19:01:17.518428 Epoch 111  	Train Loss = 18.71428 Val Loss = 20.59402
2023-05-05 19:02:49.005678 Epoch 112  	Train Loss = 18.71379 Val Loss = 20.58259
2023-05-05 19:04:21.314843 Epoch 113  	Train Loss = 18.71850 Val Loss = 20.73326
2023-05-05 19:05:52.704360 Epoch 114  	Train Loss = 18.68552 Val Loss = 20.65474
2023-05-05 19:07:25.815566 Epoch 115  	Train Loss = 18.67642 Val Loss = 20.60575
2023-05-05 19:08:58.056130 Epoch 116  	Train Loss = 18.68250 Val Loss = 20.53825
2023-05-05 19:10:29.553006 Epoch 117  	Train Loss = 18.65163 Val Loss = 20.59273
2023-05-05 19:12:02.137362 Epoch 118  	Train Loss = 18.62254 Val Loss = 20.52802
2023-05-05 19:13:37.114899 Epoch 119  	Train Loss = 18.61477 Val Loss = 20.66178
2023-05-05 19:15:08.481752 Epoch 120  	Train Loss = 18.63146 Val Loss = 20.59939
2023-05-05 19:16:40.735308 Epoch 121  	Train Loss = 18.61055 Val Loss = 20.57363
2023-05-05 19:18:11.740068 Epoch 122  	Train Loss = 18.63630 Val Loss = 20.53269
2023-05-05 19:19:43.334394 Epoch 123  	Train Loss = 18.58183 Val Loss = 20.57893
2023-05-05 19:21:14.455161 Epoch 124  	Train Loss = 18.62339 Val Loss = 20.60021
2023-05-05 19:22:45.837543 Epoch 125  	Train Loss = 18.58808 Val Loss = 20.58941
2023-05-05 19:24:17.254764 Epoch 126  	Train Loss = 18.55215 Val Loss = 20.56585
2023-05-05 19:25:48.205470 Epoch 127  	Train Loss = 18.57387 Val Loss = 20.58714
2023-05-05 19:27:19.761988 Epoch 128  	Train Loss = 18.59348 Val Loss = 20.61878
Early stopping at epoch: 128
Best at epoch 118:
Train Loss = 18.62254
Train RMSE = 31.19755, MAE = 19.11471, MAPE = 8.51634
Val Loss = 20.52802
Val RMSE = 34.58862, MAE = 21.11591, MAPE = 9.30177
--------- Test ---------
All Steps RMSE = 35.20430, MAE = 21.58842, MAPE = 9.24339
Step 1 RMSE = 29.29064, MAE = 18.57289, MAPE = 8.10507
Step 2 RMSE = 30.88259, MAE = 19.27869, MAPE = 8.37136
Step 3 RMSE = 32.27328, MAE = 20.08464, MAPE = 8.59355
Step 4 RMSE = 33.39061, MAE = 20.68106, MAPE = 8.81169
Step 5 RMSE = 34.35577, MAE = 21.16387, MAPE = 8.99013
Step 6 RMSE = 35.24274, MAE = 21.60897, MAPE = 9.19606
Step 7 RMSE = 36.05070, MAE = 22.04658, MAPE = 9.34832
Step 8 RMSE = 36.78373, MAE = 22.46618, MAPE = 9.51024
Step 9 RMSE = 37.35969, MAE = 22.78148, MAPE = 9.66528
Step 10 RMSE = 37.79179, MAE = 22.99653, MAPE = 9.90162
Step 11 RMSE = 38.31875, MAE = 23.32998, MAPE = 10.15014
Step 12 RMSE = 39.19717, MAE = 24.04725, MAPE = 10.27603
Inference time: 10.16 s
