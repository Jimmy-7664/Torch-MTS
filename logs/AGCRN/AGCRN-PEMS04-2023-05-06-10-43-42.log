PEMS04
Trainset:	x-(10181, 12, 307, 1)	y-(10181, 12, 307, 1)
Valset:  	x-(3394, 12, 307, 1)  	y-(3394, 12, 307, 1)
Testset:	x-(3394, 12, 307, 1)	y-(3394, 12, 307, 1)

--------- AGCRN ---------
{
    "num_nodes": 307,
    "in_steps": 12,
    "out_steps": 12,
    "train_size": 0.7,
    "val_size": 0.1,
    "lr": 0.003,
    "milestones": [
        50
    ],
    "lr_decay_rate": 0.3,
    "clip_grad": 0,
    "batch_size": 64,
    "max_epochs": 200,
    "early_stop": 20,
    "use_cl": false,
    "cl_step_size": 2500,
    "model_args": {
        "num_nodes": 307,
        "out_steps": 12,
        "input_dim": 1,
        "output_dim": 1,
        "embed_dim": 10,
        "rnn_units": 64,
        "num_layers": 2,
        "cheb_k": 2,
        "default_graph": true
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
AGCRN                                    [64, 12, 307, 1]          3,070
├─AVWDCRNN: 1-1                          [64, 12, 307, 64]         --
│    └─ModuleList: 2-1                   --                        --
│    │    └─AGCRNCell: 3-1               [64, 307, 64]             251,520
│    │    └─AGCRNCell: 3-2               [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-3               [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-4               [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-5               [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-6               [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-7               [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-8               [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-9               [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-10              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-11              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-12              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-13              [64, 307, 64]             493,440
│    │    └─AGCRNCell: 3-14              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-15              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-16              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-17              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-18              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-19              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-20              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-21              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-22              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-23              [64, 307, 64]             (recursive)
│    │    └─AGCRNCell: 3-24              [64, 307, 64]             (recursive)
├─Conv2d: 1-2                            [64, 12, 307, 1]          780
==========================================================================================
Total params: 748,810
Trainable params: 748,810
Non-trainable params: 0
Total mult-adds (G): 175.66
==========================================================================================
Input size (MB): 0.94
Forward/backward pass size (MB): 62.24
Params size (MB): 2.98
Estimated Total Size (MB): 66.17
==========================================================================================

Loss: HuberLoss

2023-05-06 10:44:03.723492 Epoch 1  	Train Loss = 33.89197 Val Loss = 25.82200
2023-05-06 10:44:19.469750 Epoch 2  	Train Loss = 23.17322 Val Loss = 23.11090
2023-05-06 10:44:35.136346 Epoch 3  	Train Loss = 22.21021 Val Loss = 22.63420
2023-05-06 10:44:50.877926 Epoch 4  	Train Loss = 21.45034 Val Loss = 24.42759
2023-05-06 10:45:06.596722 Epoch 5  	Train Loss = 21.01867 Val Loss = 21.61736
2023-05-06 10:45:22.419599 Epoch 6  	Train Loss = 20.53144 Val Loss = 21.42484
2023-05-06 10:45:38.213099 Epoch 7  	Train Loss = 20.25537 Val Loss = 21.79547
2023-05-06 10:45:53.987785 Epoch 8  	Train Loss = 20.04356 Val Loss = 20.56017
2023-05-06 10:46:09.811453 Epoch 9  	Train Loss = 19.65143 Val Loss = 21.12760
2023-05-06 10:46:25.624486 Epoch 10  	Train Loss = 19.49948 Val Loss = 20.37355
2023-05-06 10:46:41.395068 Epoch 11  	Train Loss = 19.34490 Val Loss = 20.31696
2023-05-06 10:46:57.198696 Epoch 12  	Train Loss = 19.16895 Val Loss = 20.13930
2023-05-06 10:47:13.179254 Epoch 13  	Train Loss = 18.98850 Val Loss = 20.08492
2023-05-06 10:47:29.029856 Epoch 14  	Train Loss = 18.95988 Val Loss = 19.83105
2023-05-06 10:47:44.864543 Epoch 15  	Train Loss = 18.71208 Val Loss = 20.19885
2023-05-06 10:48:00.700284 Epoch 16  	Train Loss = 18.61094 Val Loss = 20.09732
2023-05-06 10:48:16.488209 Epoch 17  	Train Loss = 18.50510 Val Loss = 20.17929
2023-05-06 10:48:32.312290 Epoch 18  	Train Loss = 18.52833 Val Loss = 20.51434
2023-05-06 10:48:48.133722 Epoch 19  	Train Loss = 18.32152 Val Loss = 19.68058
2023-05-06 10:49:03.966216 Epoch 20  	Train Loss = 18.27526 Val Loss = 19.50451
2023-05-06 10:49:19.733727 Epoch 21  	Train Loss = 18.14676 Val Loss = 19.50921
2023-05-06 10:49:35.656956 Epoch 22  	Train Loss = 18.01658 Val Loss = 20.48855
2023-05-06 10:49:51.534454 Epoch 23  	Train Loss = 18.07367 Val Loss = 19.46469
2023-05-06 10:50:07.388791 Epoch 24  	Train Loss = 17.91496 Val Loss = 19.84295
2023-05-06 10:50:23.215759 Epoch 25  	Train Loss = 17.95900 Val Loss = 19.37052
2023-05-06 10:50:39.140720 Epoch 26  	Train Loss = 17.76031 Val Loss = 19.26008
2023-05-06 10:50:55.039470 Epoch 27  	Train Loss = 17.70061 Val Loss = 19.19768
2023-05-06 10:51:10.896376 Epoch 28  	Train Loss = 17.71174 Val Loss = 19.26869
2023-05-06 10:51:26.691299 Epoch 29  	Train Loss = 17.63570 Val Loss = 19.19095
2023-05-06 10:51:42.545259 Epoch 30  	Train Loss = 17.55288 Val Loss = 19.22784
2023-05-06 10:51:58.353090 Epoch 31  	Train Loss = 17.47051 Val Loss = 19.28017
2023-05-06 10:52:14.245018 Epoch 32  	Train Loss = 17.45423 Val Loss = 19.11835
2023-05-06 10:52:30.009905 Epoch 33  	Train Loss = 17.38626 Val Loss = 19.19348
2023-05-06 10:52:45.868817 Epoch 34  	Train Loss = 17.38746 Val Loss = 19.08739
2023-05-06 10:53:01.631163 Epoch 35  	Train Loss = 17.30216 Val Loss = 19.19223
2023-05-06 10:53:17.423674 Epoch 36  	Train Loss = 17.23941 Val Loss = 19.06952
2023-05-06 10:53:33.193889 Epoch 37  	Train Loss = 17.22367 Val Loss = 18.91759
2023-05-06 10:53:49.007803 Epoch 38  	Train Loss = 17.13346 Val Loss = 19.11499
2023-05-06 10:54:04.896968 Epoch 39  	Train Loss = 17.07036 Val Loss = 19.04637
2023-05-06 10:54:20.661820 Epoch 40  	Train Loss = 17.04890 Val Loss = 19.51625
2023-05-06 10:54:36.510684 Epoch 41  	Train Loss = 17.08087 Val Loss = 18.91424
2023-05-06 10:54:52.352215 Epoch 42  	Train Loss = 17.14491 Val Loss = 19.07563
2023-05-06 10:55:08.301378 Epoch 43  	Train Loss = 16.94034 Val Loss = 18.97534
2023-05-06 10:55:24.364185 Epoch 44  	Train Loss = 16.92881 Val Loss = 18.84385
2023-05-06 10:55:40.188254 Epoch 45  	Train Loss = 16.84717 Val Loss = 18.90158
2023-05-06 10:55:56.017621 Epoch 46  	Train Loss = 16.83327 Val Loss = 19.00889
2023-05-06 10:56:11.878075 Epoch 47  	Train Loss = 16.86227 Val Loss = 18.98112
2023-05-06 10:56:27.854429 Epoch 48  	Train Loss = 16.81965 Val Loss = 19.00591
2023-05-06 10:56:44.020281 Epoch 49  	Train Loss = 16.73203 Val Loss = 18.95971
2023-05-06 10:57:00.337268 Epoch 50  	Train Loss = 16.67814 Val Loss = 18.90601
2023-05-06 10:57:16.264334 Epoch 51  	Train Loss = 16.30033 Val Loss = 18.49595
2023-05-06 10:57:32.147570 Epoch 52  	Train Loss = 16.21873 Val Loss = 18.53185
2023-05-06 10:57:48.035200 Epoch 53  	Train Loss = 16.17004 Val Loss = 18.55791
2023-05-06 10:58:03.826970 Epoch 54  	Train Loss = 16.16963 Val Loss = 18.57308
2023-05-06 10:58:19.762482 Epoch 55  	Train Loss = 16.18071 Val Loss = 18.56810
2023-05-06 10:58:35.575112 Epoch 56  	Train Loss = 16.15404 Val Loss = 18.63183
2023-05-06 10:58:51.618789 Epoch 57  	Train Loss = 16.15097 Val Loss = 18.61194
2023-05-06 10:59:07.482995 Epoch 58  	Train Loss = 16.12991 Val Loss = 18.57790
2023-05-06 10:59:23.369803 Epoch 59  	Train Loss = 16.11586 Val Loss = 18.61199
2023-05-06 10:59:39.371814 Epoch 60  	Train Loss = 16.08687 Val Loss = 18.62026
2023-05-06 10:59:55.188615 Epoch 61  	Train Loss = 16.06224 Val Loss = 18.64129
2023-05-06 11:00:10.987840 Epoch 62  	Train Loss = 16.05853 Val Loss = 18.63835
2023-05-06 11:00:26.839295 Epoch 63  	Train Loss = 16.05283 Val Loss = 18.62399
2023-05-06 11:00:42.818044 Epoch 64  	Train Loss = 16.03502 Val Loss = 18.65413
2023-05-06 11:00:58.734844 Epoch 65  	Train Loss = 16.00586 Val Loss = 18.67779
2023-05-06 11:01:14.866308 Epoch 66  	Train Loss = 16.01519 Val Loss = 18.72421
2023-05-06 11:01:30.743174 Epoch 67  	Train Loss = 15.97390 Val Loss = 18.63949
2023-05-06 11:01:46.744978 Epoch 68  	Train Loss = 15.97525 Val Loss = 18.66575
2023-05-06 11:02:02.531547 Epoch 69  	Train Loss = 15.96331 Val Loss = 18.65230
2023-05-06 11:02:18.325013 Epoch 70  	Train Loss = 15.94985 Val Loss = 18.71806
2023-05-06 11:02:34.191524 Epoch 71  	Train Loss = 15.91569 Val Loss = 18.66487
Early stopping at epoch: 71
Best at epoch 51:
Train Loss = 16.30033
Train RMSE = 27.06155, MAE = 16.52574, MAPE = 11.98769
Val Loss = 18.49595
Val RMSE = 31.62605, MAE = 19.41548, MAPE = 12.53135
--------- Test ---------
All Steps RMSE = 31.67685, MAE = 19.71862, MAPE = 12.99480
Step 1 RMSE = 28.59196, MAE = 17.92856, MAPE = 11.90304
Step 2 RMSE = 29.30157, MAE = 18.29258, MAPE = 12.13847
Step 3 RMSE = 30.05592, MAE = 18.74635, MAPE = 12.42111
Step 4 RMSE = 30.71367, MAE = 19.13671, MAPE = 12.65671
Step 5 RMSE = 31.29728, MAE = 19.46744, MAPE = 12.84180
Step 6 RMSE = 31.79994, MAE = 19.74696, MAPE = 12.96683
Step 7 RMSE = 32.24263, MAE = 20.02483, MAPE = 13.08349
Step 8 RMSE = 32.56596, MAE = 20.24764, MAPE = 13.25941
Step 9 RMSE = 32.82347, MAE = 20.43977, MAPE = 13.48074
Step 10 RMSE = 33.05106, MAE = 20.58787, MAPE = 13.58315
Step 11 RMSE = 33.32697, MAE = 20.79072, MAPE = 13.70962
Step 12 RMSE = 33.86666, MAE = 21.21347, MAPE = 13.89297
Inference time: 1.80 s
