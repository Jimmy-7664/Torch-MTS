PEMSBAY
Trainset:	x-(36465, 12, 325, 3)	y-(36465, 12, 325, 1)
Valset:  	x-(5209, 12, 325, 3)  	y-(5209, 12, 325, 1)
Testset:	x-(10419, 12, 325, 3)	y-(10419, 12, 325, 1)

--------- STMetaGCGRU ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.0001,
    "weight_decay": 0,
    "milestones": [
        30,
        60
    ],
    "clip_grad": false,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": false,
    "pass_device": true,
    "model_args": {
        "num_nodes": 325,
        "node_emb_file": "../data/PEMSBAY/spatial_embeddings.npz",
        "adj_path": "../data/PEMSBAY/adj_mx_bay.pkl",
        "adj_type": "doubletransition",
        "in_steps": 12,
        "out_steps": 12,
        "input_dim": 1,
        "output_dim": 1,
        "gru_hidden_dim": 32,
        "tod_embedding_dim": 24,
        "dow_embedding_dim": 7,
        "node_embedding_dim": 64,
        "learner_hidden_dim": 128,
        "z_dim": 32,
        "num_layers": 1,
        "cheb_k": 3,
        "seq2seq": false,
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STMetaGCGRU                              [64, 12, 325, 1]          20,800
├─Sequential: 1-1                        [64, 325, 32]             --
│    └─Linear: 2-1                       [64, 325, 32]             416
│    └─Tanh: 2-2                         [64, 325, 32]             --
│    └─Linear: 2-3                       [64, 325, 32]             1,056
│    └─Tanh: 2-4                         [64, 325, 32]             --
│    └─Linear: 2-5                       [64, 325, 32]             1,056
├─Sequential: 1-2                        [64, 325, 32]             --
│    └─Linear: 2-6                       [64, 325, 32]             416
│    └─Tanh: 2-7                         [64, 325, 32]             --
│    └─Linear: 2-8                       [64, 325, 32]             1,056
│    └─Tanh: 2-9                         [64, 325, 32]             --
│    └─Linear: 2-10                      [64, 325, 32]             1,056
├─ModuleList: 1-3                        --                        --
│    └─STMetaGCGRUEncoder: 2-11          [64, 12, 325, 32]         --
│    │    └─Sequential: 3-1              [64, 325, 12672]          1,651,072
│    │    └─Sequential: 3-2              [64, 325, 64]             24,640
│    │    └─Sequential: 3-3              [64, 325, 6336]           833,728
│    │    └─Sequential: 3-4              [64, 325, 32]             20,512
│    │    └─STMetaGCGRUCell: 3-5         [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-6         [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-7         [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-8         [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-9         [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-10        [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-11        [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-12        [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-13        [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-14        [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-15        [64, 325, 32]             --
│    │    └─STMetaGCGRUCell: 3-16        [64, 325, 32]             --
├─Linear: 1-4                            [64, 325, 12]             396
==========================================================================================
Total params: 2,556,204
Trainable params: 2,556,204
Non-trainable params: 0
Total mult-adds (M): 162.27
==========================================================================================
Input size (MB): 3.00
Forward/backward pass size (MB): 3298.05
Params size (MB): 10.14
Estimated Total Size (MB): 3311.18
==========================================================================================

Loss: MaskedMAELoss

2023-04-20 09:35:54.189506 Epoch 1  	Train Loss = 3.52236 Val Loss = 3.26878
2023-04-20 09:39:02.172209 Epoch 2  	Train Loss = 2.61669 Val Loss = 2.79862
2023-04-20 09:42:09.175137 Epoch 3  	Train Loss = 2.33962 Val Loss = 2.53959
2023-04-20 09:45:16.925339 Epoch 4  	Train Loss = 2.23359 Val Loss = 2.49475
2023-04-20 09:48:27.768141 Epoch 5  	Train Loss = 2.15157 Val Loss = 2.35474
2023-04-20 09:51:35.953021 Epoch 6  	Train Loss = 2.07592 Val Loss = 2.30851
2023-04-20 09:54:43.500932 Epoch 7  	Train Loss = 2.14688 Val Loss = 2.36135
2023-04-20 09:57:51.106463 Epoch 8  	Train Loss = 2.10075 Val Loss = 2.31567
2023-04-20 10:01:00.706559 Epoch 9  	Train Loss = 2.06882 Val Loss = 2.28407
2023-04-20 10:04:12.250894 Epoch 10  	Train Loss = 2.03225 Val Loss = 2.25018
2023-04-20 10:07:20.348416 Epoch 11  	Train Loss = 2.00428 Val Loss = 2.21829
2023-04-20 10:10:27.028507 Epoch 12  	Train Loss = 1.98782 Val Loss = 2.20162
2023-04-20 10:13:34.601313 Epoch 13  	Train Loss = 1.97730 Val Loss = 2.18994
2023-04-20 10:16:45.198629 Epoch 14  	Train Loss = 1.97300 Val Loss = 2.19131
2023-04-20 10:19:55.850997 Epoch 15  	Train Loss = 1.97679 Val Loss = 2.18942
2023-04-20 10:23:03.727048 Epoch 16  	Train Loss = 1.96056 Val Loss = 2.18159
2023-04-20 10:26:12.118320 Epoch 17  	Train Loss = 1.95280 Val Loss = 2.16072
2023-04-20 10:29:20.062371 Epoch 18  	Train Loss = 1.93759 Val Loss = 2.15078
2023-04-20 10:32:27.597694 Epoch 19  	Train Loss = 1.93651 Val Loss = 2.14444
2023-04-20 10:35:36.711753 Epoch 20  	Train Loss = 1.98307 Val Loss = 2.24216
2023-04-20 10:38:46.667885 Epoch 21  	Train Loss = 2.01310 Val Loss = 2.24621
2023-04-20 10:41:56.260673 Epoch 22  	Train Loss = 2.09125 Val Loss = 2.34098
2023-04-20 10:45:05.129464 Epoch 23  	Train Loss = 2.11479 Val Loss = 2.34327
2023-04-20 10:48:16.708627 Epoch 24  	Train Loss = 2.12594 Val Loss = 2.34789
2023-04-20 10:51:26.808266 Epoch 25  	Train Loss = 2.13626 Val Loss = 2.37147
2023-04-20 10:54:38.007447 Epoch 26  	Train Loss = 2.15187 Val Loss = 2.39178
2023-04-20 10:57:46.551696 Epoch 27  	Train Loss = 2.16724 Val Loss = 2.42762
2023-04-20 11:00:56.249856 Epoch 28  	Train Loss = 2.19683 Val Loss = 2.41691
2023-04-20 11:04:07.130527 Epoch 29  	Train Loss = 2.17409 Val Loss = 2.41610
Early stopping at epoch: 29
Best at epoch 19:
Train Loss = 1.93651
Train RMSE = 4.55471, MAE = 2.17743, MAPE = 4.99683
Val Loss = 2.14444
Val RMSE = 5.07034, MAE = 2.39747, MAPE = 5.85836
--------- Test ---------
All Steps RMSE = 4.66284, MAE = 2.21391, MAPE = 5.19083
Step 1 RMSE = 2.80513, MAE = 1.47327, MAPE = 3.30348
Step 2 RMSE = 3.23806, MAE = 1.67857, MAPE = 3.76187
Step 3 RMSE = 3.65367, MAE = 1.84552, MAPE = 4.16472
Step 4 RMSE = 4.02095, MAE = 1.98583, MAPE = 4.52139
Step 5 RMSE = 4.33886, MAE = 2.10681, MAPE = 4.84941
Step 6 RMSE = 4.61582, MAE = 2.21703, MAPE = 5.15261
Step 7 RMSE = 4.86205, MAE = 2.31909, MAPE = 5.43969
Step 8 RMSE = 5.08287, MAE = 2.41539, MAPE = 5.71108
Step 9 RMSE = 5.28414, MAE = 2.50521, MAPE = 5.97457
Step 10 RMSE = 5.46843, MAE = 2.59034, MAPE = 6.22343
Step 11 RMSE = 5.64244, MAE = 2.67386, MAPE = 6.47000
Step 12 RMSE = 5.81066, MAE = 2.75594, MAPE = 6.71784
Inference time: 11.41 s
