METRLA
Trainset:	x-(23974, 12, 207, 3)	y-(23974, 12, 207, 1)
Valset:  	x-(3425, 12, 207, 3)  	y-(3425, 12, 207, 1)
Testset:	x-(6850, 12, 207, 3)	y-(6850, 12, 207, 1)

--------- STMetaGCGRU ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "time_of_day": true,
    "day_of_week": true,
    "lr": 0.0001,
    "weight_decay": 0,
    "early_stop": 20,
    "milestones": [
        40,
        80
    ],
    "clip_grad": false,
    "batch_size": 64,
    "max_epochs": 200,
    "use_cl": false,
    "pass_device": true,
    "model_args": {
        "num_nodes": 207,
        "node_emb_file": "../data/METRLA/spatial_embeddings.npz",
        "adj_path": "../data/METRLA/adj_mx.pkl",
        "adj_type": "doubletransition",
        "in_steps": 12,
        "out_steps": 12,
        "input_dim": 1,
        "output_dim": 1,
        "gru_hidden_dim": 32,
        "tod_embedding_dim": 24,
        "dow_embedding_dim": 7,
        "node_embedding_dim": 64,
        "learner_hidden_dim": 128,
        "z_dim": 32,
        "num_layers": 1,
        "cheb_k": 1,
        "seq2seq": false,
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STMetaGCGRU                              [64, 12, 207, 1]          13,248
├─Sequential: 1-1                        [64, 207, 32]             --
│    └─Linear: 2-1                       [64, 207, 32]             416
│    └─Tanh: 2-2                         [64, 207, 32]             --
│    └─Linear: 2-3                       [64, 207, 32]             1,056
│    └─Tanh: 2-4                         [64, 207, 32]             --
│    └─Linear: 2-5                       [64, 207, 32]             1,056
├─Sequential: 1-2                        [64, 207, 32]             --
│    └─Linear: 2-6                       [64, 207, 32]             416
│    └─Tanh: 2-7                         [64, 207, 32]             --
│    └─Linear: 2-8                       [64, 207, 32]             1,056
│    └─Tanh: 2-9                         [64, 207, 32]             --
│    └─Linear: 2-10                      [64, 207, 32]             1,056
├─ModuleList: 1-3                        --                        --
│    └─STMetaGCGRUEncoder: 2-11          [64, 12, 207, 32]         --
│    │    └─Sequential: 3-1              [64, 207, 8448]           1,106,176
│    │    └─Sequential: 3-2              [64, 207, 64]             24,640
│    │    └─Sequential: 3-3              [64, 207, 4224]           561,280
│    │    └─Sequential: 3-4              [64, 207, 32]             20,512
│    │    └─STMetaGCGRUCell: 3-5         [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-6         [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-7         [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-8         [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-9         [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-10        [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-11        [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-12        [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-13        [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-14        [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-15        [64, 207, 32]             --
│    │    └─STMetaGCGRUCell: 3-16        [64, 207, 32]             --
├─Linear: 1-4                            [64, 207, 12]             396
==========================================================================================
Total params: 1,731,308
Trainable params: 1,731,308
Non-trainable params: 0
Total mult-adds (M): 109.96
==========================================================================================
Input size (MB): 1.91
Forward/backward pass size (MB): 1429.09
Params size (MB): 6.87
Estimated Total Size (MB): 1437.87
==========================================================================================

Loss: MaskedMAELoss

2023-04-20 16:07:57.604567 Epoch 1  	Train Loss = 5.62871 Val Loss = 4.36372
2023-04-20 16:08:49.042616 Epoch 2  	Train Loss = 4.10817 Val Loss = 3.75523
2023-04-20 16:09:41.216252 Epoch 3  	Train Loss = 3.79567 Val Loss = 3.56318
2023-04-20 16:10:33.679347 Epoch 4  	Train Loss = 3.65715 Val Loss = 3.44699
2023-04-20 16:11:26.224024 Epoch 5  	Train Loss = 3.58459 Val Loss = 3.39721
2023-04-20 16:12:18.793942 Epoch 6  	Train Loss = 3.52957 Val Loss = 3.36018
2023-04-20 16:13:11.471821 Epoch 7  	Train Loss = 3.48423 Val Loss = 3.31716
2023-04-20 16:14:04.089676 Epoch 8  	Train Loss = 3.44925 Val Loss = 3.29224
2023-04-20 16:14:56.709689 Epoch 9  	Train Loss = 3.41651 Val Loss = 3.25812
2023-04-20 16:15:49.333491 Epoch 10  	Train Loss = 3.38968 Val Loss = 3.22261
2023-04-20 16:16:41.948961 Epoch 11  	Train Loss = 3.36055 Val Loss = 3.20294
2023-04-20 16:17:34.621409 Epoch 12  	Train Loss = 3.33838 Val Loss = 3.17241
2023-04-20 16:18:27.397302 Epoch 13  	Train Loss = 3.31113 Val Loss = 3.15641
2023-04-20 16:19:20.209160 Epoch 14  	Train Loss = 3.28598 Val Loss = 3.12730
2023-04-20 16:20:13.083750 Epoch 15  	Train Loss = 3.26202 Val Loss = 3.12148
2023-04-20 16:21:05.997983 Epoch 16  	Train Loss = 3.23577 Val Loss = 3.10585
2023-04-20 16:21:59.022844 Epoch 17  	Train Loss = 3.21505 Val Loss = 3.07729
2023-04-20 16:22:52.004514 Epoch 18  	Train Loss = 3.19353 Val Loss = 3.09058
2023-04-20 16:23:44.791692 Epoch 19  	Train Loss = 3.17766 Val Loss = 3.06452
2023-04-20 16:24:37.501714 Epoch 20  	Train Loss = 3.15680 Val Loss = 3.05867
2023-04-20 16:25:30.141203 Epoch 21  	Train Loss = 3.13698 Val Loss = 3.02980
2023-04-20 16:26:22.746545 Epoch 22  	Train Loss = 3.12293 Val Loss = 3.00982
2023-04-20 16:27:15.380170 Epoch 23  	Train Loss = 3.10877 Val Loss = 3.04839
2023-04-20 16:28:08.054565 Epoch 24  	Train Loss = 3.09748 Val Loss = 2.99707
2023-04-20 16:29:00.734436 Epoch 25  	Train Loss = 3.08143 Val Loss = 2.98781
2023-04-20 16:29:53.445586 Epoch 26  	Train Loss = 3.06945 Val Loss = 2.99232
2023-04-20 16:30:46.224092 Epoch 27  	Train Loss = 3.05527 Val Loss = 2.97160
2023-04-20 16:31:38.977531 Epoch 28  	Train Loss = 3.04898 Val Loss = 2.95633
2023-04-20 16:32:31.625277 Epoch 29  	Train Loss = 3.03552 Val Loss = 2.96187
2023-04-20 16:33:24.189866 Epoch 30  	Train Loss = 3.02638 Val Loss = 2.95744
2023-04-20 16:34:16.766870 Epoch 31  	Train Loss = 3.01093 Val Loss = 2.95670
2023-04-20 16:35:09.371767 Epoch 32  	Train Loss = 3.00321 Val Loss = 2.95786
2023-04-20 16:36:02.037766 Epoch 33  	Train Loss = 2.99269 Val Loss = 2.93729
2023-04-20 16:36:54.774315 Epoch 34  	Train Loss = 2.98405 Val Loss = 2.93813
2023-04-20 16:37:47.484697 Epoch 35  	Train Loss = 2.97703 Val Loss = 2.93690
2023-04-20 16:38:40.248681 Epoch 36  	Train Loss = 2.96570 Val Loss = 2.93560
2023-04-20 16:39:33.066160 Epoch 37  	Train Loss = 2.95535 Val Loss = 2.92406
2023-04-20 16:40:25.758181 Epoch 38  	Train Loss = 2.94814 Val Loss = 2.94095
2023-04-20 16:41:18.490632 Epoch 39  	Train Loss = 2.93996 Val Loss = 2.91616
2023-04-20 16:42:11.198990 Epoch 40  	Train Loss = 2.93246 Val Loss = 2.91297
2023-04-20 16:43:03.970335 Epoch 41  	Train Loss = 2.90548 Val Loss = 2.90342
2023-04-20 16:43:56.731128 Epoch 42  	Train Loss = 2.90236 Val Loss = 2.90615
2023-04-20 16:44:49.411157 Epoch 43  	Train Loss = 2.90075 Val Loss = 2.90030
2023-04-20 16:45:41.988039 Epoch 44  	Train Loss = 2.89925 Val Loss = 2.90447
2023-04-20 16:46:34.549690 Epoch 45  	Train Loss = 2.89732 Val Loss = 2.89789
2023-04-20 16:47:27.136487 Epoch 46  	Train Loss = 2.89496 Val Loss = 2.89648
2023-04-20 16:48:19.750747 Epoch 47  	Train Loss = 2.89488 Val Loss = 2.89100
2023-04-20 16:49:12.380985 Epoch 48  	Train Loss = 2.89314 Val Loss = 2.89399
2023-04-20 16:50:05.197973 Epoch 49  	Train Loss = 2.89217 Val Loss = 2.89467
2023-04-20 16:50:57.929604 Epoch 50  	Train Loss = 2.89073 Val Loss = 2.89126
2023-04-20 16:51:50.688589 Epoch 51  	Train Loss = 2.88949 Val Loss = 2.89890
2023-04-20 16:52:43.483565 Epoch 52  	Train Loss = 2.88868 Val Loss = 2.89482
2023-04-20 16:53:36.239312 Epoch 53  	Train Loss = 2.88677 Val Loss = 2.90123
2023-04-20 16:54:29.016837 Epoch 54  	Train Loss = 2.88539 Val Loss = 2.89858
2023-04-20 16:55:21.825600 Epoch 55  	Train Loss = 2.88517 Val Loss = 2.89215
2023-04-20 16:56:14.722713 Epoch 56  	Train Loss = 2.88443 Val Loss = 2.89915
2023-04-20 16:57:07.696599 Epoch 57  	Train Loss = 2.88427 Val Loss = 2.89574
2023-04-20 16:58:00.696139 Epoch 58  	Train Loss = 2.88154 Val Loss = 2.89725
2023-04-20 16:58:53.644788 Epoch 59  	Train Loss = 2.88036 Val Loss = 2.89406
2023-04-20 16:59:46.545256 Epoch 60  	Train Loss = 2.87940 Val Loss = 2.89510
2023-04-20 17:00:39.469325 Epoch 61  	Train Loss = 2.87901 Val Loss = 2.90346
2023-04-20 17:01:32.356632 Epoch 62  	Train Loss = 2.87775 Val Loss = 2.89163
2023-04-20 17:02:25.183222 Epoch 63  	Train Loss = 2.87686 Val Loss = 2.88934
2023-04-20 17:03:18.161911 Epoch 64  	Train Loss = 2.87588 Val Loss = 2.88976
2023-04-20 17:04:11.072312 Epoch 65  	Train Loss = 2.87393 Val Loss = 2.89621
2023-04-20 17:05:04.002585 Epoch 66  	Train Loss = 2.87301 Val Loss = 2.88991
2023-04-20 17:05:56.987122 Epoch 67  	Train Loss = 2.87218 Val Loss = 2.89360
2023-04-20 17:06:49.995022 Epoch 68  	Train Loss = 2.87210 Val Loss = 2.89373
2023-04-20 17:07:42.961237 Epoch 69  	Train Loss = 2.87197 Val Loss = 2.89245
2023-04-20 17:08:35.890716 Epoch 70  	Train Loss = 2.87039 Val Loss = 2.89775
2023-04-20 17:09:28.824021 Epoch 71  	Train Loss = 2.86930 Val Loss = 2.89572
2023-04-20 17:10:21.771459 Epoch 72  	Train Loss = 2.86851 Val Loss = 2.90080
2023-04-20 17:11:14.798857 Epoch 73  	Train Loss = 2.86690 Val Loss = 2.89237
2023-04-20 17:12:07.836548 Epoch 74  	Train Loss = 2.86662 Val Loss = 2.89708
2023-04-20 17:13:00.826067 Epoch 75  	Train Loss = 2.86525 Val Loss = 2.89062
2023-04-20 17:13:53.789054 Epoch 76  	Train Loss = 2.86334 Val Loss = 2.89333
2023-04-20 17:14:46.714044 Epoch 77  	Train Loss = 2.86397 Val Loss = 2.89587
2023-04-20 17:15:39.604857 Epoch 78  	Train Loss = 2.86223 Val Loss = 2.89945
2023-04-20 17:16:32.552735 Epoch 79  	Train Loss = 2.86180 Val Loss = 2.89417
2023-04-20 17:17:25.525773 Epoch 80  	Train Loss = 2.85944 Val Loss = 2.89723
2023-04-20 17:18:18.440130 Epoch 81  	Train Loss = 2.85685 Val Loss = 2.89579
2023-04-20 17:19:11.359306 Epoch 82  	Train Loss = 2.85621 Val Loss = 2.88991
2023-04-20 17:20:04.268012 Epoch 83  	Train Loss = 2.85668 Val Loss = 2.89378
Early stopping at epoch: 83
Best at epoch 63:
Train Loss = 2.87686
Train RMSE = 5.65614, MAE = 2.85603, MAPE = 7.66699
Val Loss = 2.88934
Val RMSE = 6.03930, MAE = 2.92950, MAPE = 8.27251
--------- Test ---------
All Steps RMSE = 6.38661, MAE = 3.16567, MAPE = 8.92318
Step 1 RMSE = 4.10310, MAE = 2.35396, MAPE = 5.85459
Step 2 RMSE = 4.87511, MAE = 2.62777, MAPE = 6.80462
Step 3 RMSE = 5.40480, MAE = 2.82350, MAPE = 7.55610
Step 4 RMSE = 5.81822, MAE = 2.97371, MAPE = 8.13044
Step 5 RMSE = 6.14743, MAE = 3.09733, MAPE = 8.66038
Step 6 RMSE = 6.43462, MAE = 3.20556, MAPE = 9.05486
Step 7 RMSE = 6.67530, MAE = 3.30147, MAPE = 9.47256
Step 8 RMSE = 6.88538, MAE = 3.38107, MAPE = 9.78647
Step 9 RMSE = 7.07123, MAE = 3.45167, MAPE = 10.05878
Step 10 RMSE = 7.23629, MAE = 3.51868, MAPE = 10.29269
Step 11 RMSE = 7.40543, MAE = 3.59101, MAPE = 10.56583
Step 12 RMSE = 7.57842, MAE = 3.66246, MAPE = 10.84096
Inference time: 3.29 s
