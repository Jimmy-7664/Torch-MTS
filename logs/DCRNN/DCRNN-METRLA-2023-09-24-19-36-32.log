METRLA
Trainset:	x-(23974, 12, 207, 2)	y-(23974, 12, 207, 1)
Valset:  	x-(3425, 12, 207, 2)  	y-(3425, 12, 207, 1)
Testset:	x-(6850, 12, 207, 2)	y-(6850, 12, 207, 1)

--------- DCRNN ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "time_of_day": true,
    "runner": "dcrnn",
    "lr": 0.01,
    "eps": 0.001,
    "milestones": [
        20,
        30,
        40,
        50
    ],
    "clip_grad": 5,
    "batch_size": 64,
    "max_epochs": 200,
    "early_stop": 20,
    "pass_device": true,
    "model_args": {
        "num_nodes": 207,
        "adj_path": "../data/METRLA/adj_mx.pkl",
        "input_dim": 2,
        "output_dim": 1,
        "seq_len": 12,
        "horizon": 12,
        "rnn_units": 64,
        "num_rnn_layers": 2,
        "max_diffusion_step": 2,
        "filter_type": "dual_random_walk",
        "tf_decay_steps": 2000,
        "use_teacher_forcing": true,
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
DCRNN                                    [64, 12, 207, 1]          --
├─EncoderModel: 1-1                      [64, 13248]               --
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-1               [64, 13248]               --
│    │    └─DCGRUCell: 3-2               [64, 13248]               --
├─EncoderModel: 1-2                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-3               [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-4               [64, 13248]               (recursive)
├─EncoderModel: 1-3                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-5               [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-6               [64, 13248]               (recursive)
├─EncoderModel: 1-4                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-7               [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-8               [64, 13248]               (recursive)
├─EncoderModel: 1-5                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-9               [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-10              [64, 13248]               (recursive)
├─EncoderModel: 1-6                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-11              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-12              [64, 13248]               (recursive)
├─EncoderModel: 1-7                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-13              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-14              [64, 13248]               (recursive)
├─EncoderModel: 1-8                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-15              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-16              [64, 13248]               (recursive)
├─EncoderModel: 1-9                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-17              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-18              [64, 13248]               (recursive)
├─EncoderModel: 1-10                     [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-19              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-20              [64, 13248]               (recursive)
├─EncoderModel: 1-11                     [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-21              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-22              [64, 13248]               (recursive)
├─EncoderModel: 1-12                     [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-23              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-24              [64, 13248]               (recursive)
├─DecoderModel: 1-13                     [64, 207]                 --
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-25              [64, 13248]               --
│    │    └─DCGRUCell: 3-26              [64, 13248]               --
│    └─Linear: 2-14                      [13248, 1]                65
├─DecoderModel: 1-14                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-27              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-28              [64, 13248]               (recursive)
│    └─Linear: 2-16                      [13248, 1]                (recursive)
├─DecoderModel: 1-15                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-29              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-30              [64, 13248]               (recursive)
│    └─Linear: 2-18                      [13248, 1]                (recursive)
├─DecoderModel: 1-16                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-31              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-32              [64, 13248]               (recursive)
│    └─Linear: 2-20                      [13248, 1]                (recursive)
├─DecoderModel: 1-17                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-33              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-34              [64, 13248]               (recursive)
│    └─Linear: 2-22                      [13248, 1]                (recursive)
├─DecoderModel: 1-18                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-35              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-36              [64, 13248]               (recursive)
│    └─Linear: 2-24                      [13248, 1]                (recursive)
├─DecoderModel: 1-19                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-37              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-38              [64, 13248]               (recursive)
│    └─Linear: 2-26                      [13248, 1]                (recursive)
├─DecoderModel: 1-20                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-39              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-40              [64, 13248]               (recursive)
│    └─Linear: 2-28                      [13248, 1]                (recursive)
├─DecoderModel: 1-21                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-41              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-42              [64, 13248]               (recursive)
│    └─Linear: 2-30                      [13248, 1]                (recursive)
├─DecoderModel: 1-22                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-43              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-44              [64, 13248]               (recursive)
│    └─Linear: 2-32                      [13248, 1]                (recursive)
├─DecoderModel: 1-23                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-45              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-46              [64, 13248]               (recursive)
│    └─Linear: 2-34                      [13248, 1]                (recursive)
├─DecoderModel: 1-24                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-47              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-48              [64, 13248]               (recursive)
│    └─Linear: 2-36                      [13248, 1]                (recursive)
==========================================================================================
Total params: 65
Trainable params: 65
Non-trainable params: 0
Total mult-adds (T): 3.79
==========================================================================================
Input size (MB): 1.27
Forward/backward pass size (MB): 299.72
Params size (MB): 0.00
Estimated Total Size (MB): 300.99
==========================================================================================

Loss: MaskedMAELoss

2023-09-24 19:39:08.826642 Epoch 1  	Train Loss = 4.43815 Val Loss = 4.74215
2023-09-24 19:41:42.585437 Epoch 2  	Train Loss = 3.51213 Val Loss = 4.70886
2023-09-24 19:44:15.905342 Epoch 3  	Train Loss = 3.45304 Val Loss = 4.76072
2023-09-24 19:46:49.353628 Epoch 4  	Train Loss = 3.43155 Val Loss = 4.74720
2023-09-24 19:49:23.579688 Epoch 5  	Train Loss = 3.42268 Val Loss = 4.82856
2023-09-24 19:51:57.594580 Epoch 6  	Train Loss = 3.41921 Val Loss = 4.79585
2023-09-24 19:54:31.750780 Epoch 7  	Train Loss = 3.41756 Val Loss = 4.72520
2023-09-24 19:57:05.612964 Epoch 8  	Train Loss = 3.41609 Val Loss = 4.79407
2023-09-24 19:59:39.056483 Epoch 9  	Train Loss = 3.41511 Val Loss = 4.76308
2023-09-24 20:02:12.734828 Epoch 10  	Train Loss = 3.41453 Val Loss = 4.78065
2023-09-24 20:04:46.382093 Epoch 11  	Train Loss = 3.41567 Val Loss = 4.80512
2023-09-24 20:07:19.928723 Epoch 12  	Train Loss = 3.41504 Val Loss = 4.80601
2023-09-24 20:09:54.074990 Epoch 13  	Train Loss = 3.41485 Val Loss = 4.72410
2023-09-24 20:12:28.236127 Epoch 14  	Train Loss = 3.41813 Val Loss = 4.85680
2023-09-24 20:15:02.233267 Epoch 15  	Train Loss = 3.41786 Val Loss = 5.01368
2023-09-24 20:17:34.635254 Epoch 16  	Train Loss = 3.41958 Val Loss = 4.77823
2023-09-24 20:20:06.701357 Epoch 17  	Train Loss = 3.42026 Val Loss = 4.82600
2023-09-24 20:22:41.069278 Epoch 18  	Train Loss = 3.42158 Val Loss = 4.78714
2023-09-24 20:25:14.942071 Epoch 19  	Train Loss = 3.42162 Val Loss = 4.72028
2023-09-24 20:27:48.068506 Epoch 20  	Train Loss = 3.42201 Val Loss = 4.74309
2023-09-24 20:30:21.545218 Epoch 21  	Train Loss = 3.42287 Val Loss = 4.77350
2023-09-24 20:32:55.408098 Epoch 22  	Train Loss = 3.42363 Val Loss = 4.75046
Early stopping at epoch: 22
Best at epoch 2:
Train Loss = 3.51213
Train RMSE = 8.68829, MAE = 4.75351, MAPE = 12.91026
Val Loss = 4.70886
Val RMSE = 8.75225, MAE = 4.72742, MAPE = 13.63810
--------- Test ---------
All Steps RMSE = 9.40457, MAE = 5.31792, MAPE = 14.88559
Step 1 RMSE = 6.94935, MAE = 3.97066, MAPE = 11.01046
Step 2 RMSE = 7.40839, MAE = 4.11150, MAPE = 11.27491
Step 3 RMSE = 7.92435, MAE = 4.34375, MAPE = 11.94464
Step 4 RMSE = 8.39879, MAE = 4.60503, MAPE = 12.78888
Step 5 RMSE = 8.82484, MAE = 4.87613, MAPE = 13.68188
Step 6 RMSE = 9.21698, MAE = 5.14509, MAPE = 14.56094
Step 7 RMSE = 9.58807, MAE = 5.41106, MAPE = 15.39767
Step 8 RMSE = 9.94708, MAE = 5.67948, MAPE = 16.18431
Step 9 RMSE = 10.29952, MAE = 5.95625, MAPE = 16.92115
Step 10 RMSE = 10.65341, MAE = 6.24675, MAPE = 17.61505
Step 11 RMSE = 11.01916, MAE = 6.56177, MAPE = 18.28774
Step 12 RMSE = 11.40797, MAE = 6.90779, MAPE = 18.96000
Inference time: 23.18 s
