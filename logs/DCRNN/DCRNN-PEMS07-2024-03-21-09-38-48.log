PEMS07
Trainset:	x-(16921, 12, 883, 2)	y-(16921, 12, 883, 1)
Valset:  	x-(5640, 12, 883, 2)  	y-(5640, 12, 883, 1)
Testset:	x-(5640, 12, 883, 2)	y-(5640, 12, 883, 1)

--------- DCRNN ---------
{
    "num_nodes": 883,
    "in_steps": 12,
    "out_steps": 12,
    "time_of_day": true,
    "runner": "dcrnn",
    "lr": 0.003,
    "eps": 0.001,
    "milestones": [
        80
    ],
    "lr_decay_rate": 0.3,
    "batch_size": 64,
    "max_epochs": 200,
    "early_stop": 20,
    "pass_device": true,
    "model_args": {
        "num_nodes": 883,
        "adj_path": "../data/PEMS07/adj_PEMS07.pkl",
        "input_dim": 2,
        "output_dim": 1,
        "seq_len": 12,
        "horizon": 12,
        "rnn_units": 64,
        "num_rnn_layers": 2,
        "max_diffusion_step": 2,
        "filter_type": "dual_random_walk",
        "tf_decay_steps": 2000,
        "use_teacher_forcing": true,
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
DCRNN                                    [64, 12, 883, 1]          --
├─EncoderModel: 1-1                      [64, 56512]               --
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-1               [64, 56512]               --
│    │    └─DCGRUCell: 3-2               [64, 56512]               --
├─EncoderModel: 1-2                      [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-3               [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-4               [64, 56512]               (recursive)
├─EncoderModel: 1-3                      [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-5               [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-6               [64, 56512]               (recursive)
├─EncoderModel: 1-4                      [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-7               [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-8               [64, 56512]               (recursive)
├─EncoderModel: 1-5                      [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-9               [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-10              [64, 56512]               (recursive)
├─EncoderModel: 1-6                      [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-11              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-12              [64, 56512]               (recursive)
├─EncoderModel: 1-7                      [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-13              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-14              [64, 56512]               (recursive)
├─EncoderModel: 1-8                      [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-15              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-16              [64, 56512]               (recursive)
├─EncoderModel: 1-9                      [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-17              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-18              [64, 56512]               (recursive)
├─EncoderModel: 1-10                     [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-19              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-20              [64, 56512]               (recursive)
├─EncoderModel: 1-11                     [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-21              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-22              [64, 56512]               (recursive)
├─EncoderModel: 1-12                     [64, 56512]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-23              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-24              [64, 56512]               (recursive)
├─DecoderModel: 1-13                     [64, 883]                 --
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-25              [64, 56512]               --
│    │    └─DCGRUCell: 3-26              [64, 56512]               --
│    └─Linear: 2-14                      [56512, 1]                65
├─DecoderModel: 1-14                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-27              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-28              [64, 56512]               (recursive)
│    └─Linear: 2-16                      [56512, 1]                (recursive)
├─DecoderModel: 1-15                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-29              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-30              [64, 56512]               (recursive)
│    └─Linear: 2-18                      [56512, 1]                (recursive)
├─DecoderModel: 1-16                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-31              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-32              [64, 56512]               (recursive)
│    └─Linear: 2-20                      [56512, 1]                (recursive)
├─DecoderModel: 1-17                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-33              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-34              [64, 56512]               (recursive)
│    └─Linear: 2-22                      [56512, 1]                (recursive)
├─DecoderModel: 1-18                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-35              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-36              [64, 56512]               (recursive)
│    └─Linear: 2-24                      [56512, 1]                (recursive)
├─DecoderModel: 1-19                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-37              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-38              [64, 56512]               (recursive)
│    └─Linear: 2-26                      [56512, 1]                (recursive)
├─DecoderModel: 1-20                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-39              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-40              [64, 56512]               (recursive)
│    └─Linear: 2-28                      [56512, 1]                (recursive)
├─DecoderModel: 1-21                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-41              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-42              [64, 56512]               (recursive)
│    └─Linear: 2-30                      [56512, 1]                (recursive)
├─DecoderModel: 1-22                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-43              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-44              [64, 56512]               (recursive)
│    └─Linear: 2-32                      [56512, 1]                (recursive)
├─DecoderModel: 1-23                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-45              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-46              [64, 56512]               (recursive)
│    └─Linear: 2-34                      [56512, 1]                (recursive)
├─DecoderModel: 1-24                     [64, 883]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-47              [64, 56512]               (recursive)
│    │    └─DCGRUCell: 3-48              [64, 56512]               (recursive)
│    └─Linear: 2-36                      [56512, 1]                (recursive)
==========================================================================================
Total params: 65
Trainable params: 65
Non-trainable params: 0
Total mult-adds (T): 16.16
==========================================================================================
Input size (MB): 5.43
Forward/backward pass size (MB): 1278.53
Params size (MB): 0.00
Estimated Total Size (MB): 1283.95
==========================================================================================

Loss: HuberLoss

2024-03-21 09:45:11.434711 Epoch 1  	Train Loss = 23.68706 Val Loss = 30.03635
2024-03-21 09:51:24.379961 Epoch 2  	Train Loss = 18.45692 Val Loss = 27.33474
2024-03-21 09:57:37.391508 Epoch 3  	Train Loss = 18.36212 Val Loss = 27.19808
2024-03-21 10:03:50.216384 Epoch 4  	Train Loss = 18.17939 Val Loss = 27.28044
2024-03-21 10:10:02.388690 Epoch 5  	Train Loss = 17.98821 Val Loss = 27.00163
2024-03-21 10:16:14.234758 Epoch 6  	Train Loss = 17.96643 Val Loss = 29.82048
2024-03-21 10:22:27.122810 Epoch 7  	Train Loss = 17.84445 Val Loss = 27.31083
2024-03-21 10:28:39.681669 Epoch 8  	Train Loss = 17.77276 Val Loss = 25.88239
2024-03-21 10:34:51.839519 Epoch 9  	Train Loss = 17.79616 Val Loss = 26.07482
2024-03-21 10:41:04.286263 Epoch 10  	Train Loss = 17.67420 Val Loss = 26.76691
2024-03-21 10:47:17.562236 Epoch 11  	Train Loss = 17.59365 Val Loss = 26.82404
2024-03-21 10:53:29.727248 Epoch 12  	Train Loss = 17.56307 Val Loss = 25.09975
2024-03-21 10:59:41.316429 Epoch 13  	Train Loss = 17.46884 Val Loss = 25.45193
2024-03-21 11:05:53.674232 Epoch 14  	Train Loss = 17.39621 Val Loss = 24.97943
2024-03-21 11:12:06.468286 Epoch 15  	Train Loss = 17.41694 Val Loss = 24.58643
2024-03-21 11:18:19.471483 Epoch 16  	Train Loss = 17.31895 Val Loss = 25.48680
2024-03-21 11:24:31.897502 Epoch 17  	Train Loss = 17.27832 Val Loss = 24.01955
2024-03-21 11:30:45.810889 Epoch 18  	Train Loss = 17.23653 Val Loss = 24.62012
2024-03-21 11:36:58.926144 Epoch 19  	Train Loss = 17.13847 Val Loss = 26.02522
2024-03-21 11:43:11.378464 Epoch 20  	Train Loss = 17.11349 Val Loss = 26.19839
2024-03-21 11:49:23.527502 Epoch 21  	Train Loss = 17.03603 Val Loss = 23.94182
2024-03-21 11:55:36.127849 Epoch 22  	Train Loss = 16.97309 Val Loss = 23.83267
2024-03-21 12:01:49.724187 Epoch 23  	Train Loss = 16.89519 Val Loss = 25.02845
2024-03-21 12:08:03.468662 Epoch 24  	Train Loss = 16.87699 Val Loss = 26.17851
2024-03-21 12:14:16.981235 Epoch 25  	Train Loss = 16.78852 Val Loss = 24.21462
2024-03-21 12:20:28.845464 Epoch 26  	Train Loss = 16.70051 Val Loss = 23.66730
2024-03-21 12:26:41.035443 Epoch 27  	Train Loss = 16.68009 Val Loss = 23.26309
2024-03-21 12:32:52.629910 Epoch 28  	Train Loss = 16.58681 Val Loss = 24.30522
2024-03-21 12:39:05.065286 Epoch 29  	Train Loss = 16.65230 Val Loss = 23.25719
2024-03-21 12:45:16.884281 Epoch 30  	Train Loss = 16.52184 Val Loss = 23.46047
2024-03-21 12:51:28.915566 Epoch 31  	Train Loss = 16.54581 Val Loss = 22.85714
2024-03-21 12:57:40.494841 Epoch 32  	Train Loss = 16.47297 Val Loss = 23.37151
2024-03-21 13:03:52.202584 Epoch 33  	Train Loss = 16.42304 Val Loss = 24.69036
2024-03-21 13:10:05.313996 Epoch 34  	Train Loss = 16.44353 Val Loss = 22.94707
2024-03-21 13:16:17.395293 Epoch 35  	Train Loss = 16.42280 Val Loss = 22.60646
2024-03-21 13:22:29.795261 Epoch 36  	Train Loss = 16.35905 Val Loss = 23.44713
2024-03-21 13:28:42.082212 Epoch 37  	Train Loss = 16.59805 Val Loss = 22.35020
2024-03-21 13:34:54.204133 Epoch 38  	Train Loss = 16.45106 Val Loss = 23.09983
2024-03-21 13:41:06.166787 Epoch 39  	Train Loss = 16.35079 Val Loss = 24.22775
2024-03-21 13:47:19.299003 Epoch 40  	Train Loss = 16.41660 Val Loss = 21.98072
2024-03-21 13:53:31.419536 Epoch 41  	Train Loss = 16.40100 Val Loss = 23.57026
2024-03-21 13:59:42.878316 Epoch 42  	Train Loss = 16.46103 Val Loss = 22.71788
2024-03-21 14:05:54.745490 Epoch 43  	Train Loss = 16.51779 Val Loss = 25.47239
2024-03-21 14:12:07.390325 Epoch 44  	Train Loss = 16.65607 Val Loss = 23.29777
2024-03-21 14:18:18.743141 Epoch 45  	Train Loss = 16.45343 Val Loss = 22.53974
2024-03-21 14:24:31.465582 Epoch 46  	Train Loss = 16.74283 Val Loss = 32.67020
2024-03-21 14:30:44.240539 Epoch 47  	Train Loss = 16.64294 Val Loss = 21.80130
2024-03-21 14:36:54.935055 Epoch 48  	Train Loss = 16.67179 Val Loss = 21.93045
2024-03-21 14:43:07.136901 Epoch 49  	Train Loss = 16.75716 Val Loss = 22.80153
2024-03-21 14:49:19.225833 Epoch 50  	Train Loss = 16.79550 Val Loss = 21.93055
2024-03-21 14:55:29.585925 Epoch 51  	Train Loss = 17.67149 Val Loss = 21.78008
2024-03-21 15:01:41.430114 Epoch 52  	Train Loss = 16.88442 Val Loss = 22.14405
2024-03-21 15:07:53.193980 Epoch 53  	Train Loss = 17.21254 Val Loss = 22.14978
2024-03-21 15:14:05.714311 Epoch 54  	Train Loss = 17.10093 Val Loss = 22.20716
2024-03-21 15:20:16.914260 Epoch 55  	Train Loss = 17.28587 Val Loss = 21.63201
2024-03-21 15:26:28.540633 Epoch 56  	Train Loss = 17.49094 Val Loss = 23.12749
2024-03-21 15:32:40.138558 Epoch 57  	Train Loss = 17.81737 Val Loss = 22.47826
2024-03-21 15:38:53.063332 Epoch 58  	Train Loss = 17.64677 Val Loss = 21.85666
2024-03-21 15:45:05.376250 Epoch 59  	Train Loss = 17.78978 Val Loss = 27.96345
2024-03-21 15:51:17.238508 Epoch 60  	Train Loss = 18.48324 Val Loss = 25.09727
2024-03-21 15:57:29.837597 Epoch 61  	Train Loss = 18.37968 Val Loss = 22.03109
2024-03-21 16:03:41.834709 Epoch 62  	Train Loss = 18.70406 Val Loss = 22.07439
2024-03-21 16:09:53.627963 Epoch 63  	Train Loss = 18.61025 Val Loss = 21.47727
2024-03-21 16:16:05.003880 Epoch 64  	Train Loss = 18.60006 Val Loss = 21.25838
2024-03-21 16:22:16.491707 Epoch 65  	Train Loss = 18.90490 Val Loss = 21.89988
2024-03-21 16:28:29.173122 Epoch 66  	Train Loss = 19.01048 Val Loss = 22.08708
2024-03-21 16:34:40.201118 Epoch 67  	Train Loss = 18.99526 Val Loss = 21.20725
2024-03-21 16:40:52.350774 Epoch 68  	Train Loss = 18.81260 Val Loss = 23.09685
2024-03-21 16:47:04.163115 Epoch 69  	Train Loss = 18.99236 Val Loss = 23.08902
2024-03-21 16:53:14.087390 Epoch 70  	Train Loss = 19.10789 Val Loss = 21.44325
2024-03-21 16:59:25.233526 Epoch 71  	Train Loss = 19.25129 Val Loss = 20.83338
2024-03-21 17:05:37.178783 Epoch 72  	Train Loss = 19.39432 Val Loss = 21.29740
2024-03-21 17:11:50.723043 Epoch 73  	Train Loss = 19.42955 Val Loss = 21.85612
2024-03-21 17:18:03.344453 Epoch 74  	Train Loss = 19.40065 Val Loss = 20.80879
2024-03-21 17:24:14.500832 Epoch 75  	Train Loss = 19.30341 Val Loss = 20.80429
2024-03-21 17:30:26.119332 Epoch 76  	Train Loss = 19.41189 Val Loss = 20.59124
2024-03-21 17:36:38.648239 Epoch 77  	Train Loss = 19.38267 Val Loss = 20.68812
2024-03-21 17:42:49.511130 Epoch 78  	Train Loss = 19.39456 Val Loss = 21.07983
2024-03-21 17:49:02.712669 Epoch 79  	Train Loss = 19.30532 Val Loss = 20.69245
2024-03-21 17:55:12.908345 Epoch 80  	Train Loss = 19.28658 Val Loss = 20.57781
2024-03-21 18:01:24.030433 Epoch 81  	Train Loss = 18.85297 Val Loss = 20.28446
2024-03-21 18:07:35.837609 Epoch 82  	Train Loss = 18.82932 Val Loss = 20.31264
2024-03-21 18:14:15.289741 Epoch 83  	Train Loss = 18.85717 Val Loss = 20.30692
2024-03-21 18:20:53.860059 Epoch 84  	Train Loss = 18.88656 Val Loss = 20.25229
2024-03-21 18:27:42.040140 Epoch 85  	Train Loss = 18.85356 Val Loss = 20.27927
2024-03-21 18:34:25.574226 Epoch 86  	Train Loss = 18.90489 Val Loss = 20.30260
2024-03-21 18:41:24.212655 Epoch 87  	Train Loss = 18.89397 Val Loss = 20.37710
2024-03-21 18:48:09.000546 Epoch 88  	Train Loss = 18.91236 Val Loss = 20.34268
2024-03-21 18:54:41.591764 Epoch 89  	Train Loss = 18.91183 Val Loss = 20.35760
2024-03-21 19:01:26.934220 Epoch 90  	Train Loss = 18.88463 Val Loss = 20.27573
2024-03-21 19:08:09.190986 Epoch 91  	Train Loss = 18.86365 Val Loss = 20.47952
2024-03-21 19:15:02.335913 Epoch 92  	Train Loss = 18.85671 Val Loss = 20.29807
2024-03-21 19:21:50.415647 Epoch 93  	Train Loss = 18.84176 Val Loss = 20.29118
2024-03-21 19:28:44.054383 Epoch 94  	Train Loss = 18.83937 Val Loss = 20.28098
2024-03-21 19:35:26.972350 Epoch 95  	Train Loss = 18.83006 Val Loss = 20.36423
2024-03-21 19:42:17.070261 Epoch 96  	Train Loss = 18.83095 Val Loss = 20.27200
2024-03-21 19:48:29.734452 Epoch 97  	Train Loss = 18.79629 Val Loss = 20.22846
2024-03-21 19:54:40.300812 Epoch 98  	Train Loss = 18.77661 Val Loss = 20.34857
2024-03-21 20:00:50.890942 Epoch 99  	Train Loss = 18.79446 Val Loss = 20.42501
2024-03-21 20:07:01.193216 Epoch 100  	Train Loss = 18.76388 Val Loss = 20.25360
2024-03-21 20:13:11.140099 Epoch 101  	Train Loss = 18.74001 Val Loss = 20.30749
2024-03-21 20:19:21.758399 Epoch 102  	Train Loss = 18.73571 Val Loss = 20.31895
2024-03-21 20:25:31.299866 Epoch 103  	Train Loss = 18.75561 Val Loss = 20.43077
2024-03-21 20:31:41.733391 Epoch 104  	Train Loss = 18.71328 Val Loss = 20.47604
2024-03-21 20:37:51.700443 Epoch 105  	Train Loss = 18.68980 Val Loss = 20.33782
2024-03-21 20:44:05.656452 Epoch 106  	Train Loss = 18.68809 Val Loss = 20.34470
2024-03-21 20:50:18.995679 Epoch 107  	Train Loss = 18.67766 Val Loss = 20.37452
2024-03-21 20:56:33.580021 Epoch 108  	Train Loss = 18.65929 Val Loss = 20.40393
2024-03-21 21:02:47.248925 Epoch 109  	Train Loss = 18.65739 Val Loss = 20.37565
2024-03-21 21:08:58.034108 Epoch 110  	Train Loss = 18.66109 Val Loss = 20.36336
2024-03-21 21:15:09.257041 Epoch 111  	Train Loss = 18.61486 Val Loss = 20.34065
2024-03-21 21:21:19.138371 Epoch 112  	Train Loss = 18.61815 Val Loss = 20.32920
2024-03-21 21:27:29.549823 Epoch 113  	Train Loss = 18.60081 Val Loss = 20.26384
2024-03-21 21:33:40.326642 Epoch 114  	Train Loss = 18.58314 Val Loss = 20.32380
2024-03-21 21:39:50.631137 Epoch 115  	Train Loss = 18.59144 Val Loss = 20.32601
2024-03-21 21:46:02.572485 Epoch 116  	Train Loss = 18.59707 Val Loss = 20.37799
2024-03-21 21:52:12.645660 Epoch 117  	Train Loss = 18.56488 Val Loss = 20.40452
Early stopping at epoch: 117
Best at epoch 97:
Train Loss = 18.79629
Train RMSE = 31.46307, MAE = 19.31013, MAPE = 8.74373
Val Loss = 20.22846
Val RMSE = 33.87610, MAE = 20.70892, MAPE = 9.23728
--------- Test ---------
All Steps RMSE = 34.14117, MAE = 21.14427, MAPE = 9.05127
Step 1 RMSE = 27.14694, MAE = 17.20046, MAPE = 7.46491
Step 2 RMSE = 29.73330, MAE = 18.61040, MAPE = 8.00981
Step 3 RMSE = 31.24891, MAE = 19.45640, MAPE = 8.35425
Step 4 RMSE = 32.35157, MAE = 20.07401, MAPE = 8.60621
Step 5 RMSE = 33.28942, MAE = 20.60165, MAPE = 8.80627
Step 6 RMSE = 34.13059, MAE = 21.10907, MAPE = 9.01367
Step 7 RMSE = 34.92306, MAE = 21.61068, MAPE = 9.22514
Step 8 RMSE = 35.64329, MAE = 22.07656, MAPE = 9.42065
Step 9 RMSE = 36.30764, MAE = 22.51614, MAPE = 9.60712
Step 10 RMSE = 36.95818, MAE = 22.96213, MAPE = 9.79424
Step 11 RMSE = 37.66296, MAE = 23.46049, MAPE = 10.01674
Step 12 RMSE = 38.43624, MAE = 24.05041, MAPE = 10.29475
Inference time: 54.33 s
