METRLA
Trainset:	x-(23974, 12, 207, 2)	y-(23974, 12, 207, 1)
Valset:  	x-(3425, 12, 207, 2)  	y-(3425, 12, 207, 1)
Testset:	x-(6850, 12, 207, 2)	y-(6850, 12, 207, 1)

--------- DCRNN ---------
{
    "num_nodes": 207,
    "in_steps": 12,
    "out_steps": 12,
    "time_of_day": true,
    "runner": "dcrnn",
    "lr": 0.01,
    "eps": 0.001,
    "milestones": [
        20,
        30,
        40,
        50
    ],
    "clip_grad": 5,
    "batch_size": 64,
    "max_epochs": 200,
    "early_stop": 20,
    "pass_device": true,
    "model_args": {
        "num_nodes": 207,
        "adj_path": "../data/METRLA/adj_mx.pkl",
        "input_dim": 2,
        "output_dim": 1,
        "seq_len": 12,
        "horizon": 12,
        "rnn_units": 64,
        "num_rnn_layers": 2,
        "max_diffusion_step": 2,
        "filter_type": "dual_random_walk",
        "tf_decay_steps": 2000,
        "use_teacher_forcing": true,
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
DCRNN                                    [64, 12, 207, 1]          --
├─EncoderModel: 1-1                      [64, 13248]               --
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-1               [64, 13248]               --
│    │    └─DCGRUCell: 3-2               [64, 13248]               --
├─EncoderModel: 1-2                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-3               [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-4               [64, 13248]               (recursive)
├─EncoderModel: 1-3                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-5               [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-6               [64, 13248]               (recursive)
├─EncoderModel: 1-4                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-7               [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-8               [64, 13248]               (recursive)
├─EncoderModel: 1-5                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-9               [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-10              [64, 13248]               (recursive)
├─EncoderModel: 1-6                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-11              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-12              [64, 13248]               (recursive)
├─EncoderModel: 1-7                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-13              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-14              [64, 13248]               (recursive)
├─EncoderModel: 1-8                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-15              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-16              [64, 13248]               (recursive)
├─EncoderModel: 1-9                      [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-17              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-18              [64, 13248]               (recursive)
├─EncoderModel: 1-10                     [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-19              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-20              [64, 13248]               (recursive)
├─EncoderModel: 1-11                     [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-21              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-22              [64, 13248]               (recursive)
├─EncoderModel: 1-12                     [64, 13248]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-23              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-24              [64, 13248]               (recursive)
├─DecoderModel: 1-13                     [64, 207]                 --
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-25              [64, 13248]               --
│    │    └─DCGRUCell: 3-26              [64, 13248]               --
│    └─Linear: 2-14                      [13248, 1]                65
├─DecoderModel: 1-14                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-27              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-28              [64, 13248]               (recursive)
│    └─Linear: 2-16                      [13248, 1]                (recursive)
├─DecoderModel: 1-15                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-29              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-30              [64, 13248]               (recursive)
│    └─Linear: 2-18                      [13248, 1]                (recursive)
├─DecoderModel: 1-16                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-31              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-32              [64, 13248]               (recursive)
│    └─Linear: 2-20                      [13248, 1]                (recursive)
├─DecoderModel: 1-17                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-33              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-34              [64, 13248]               (recursive)
│    └─Linear: 2-22                      [13248, 1]                (recursive)
├─DecoderModel: 1-18                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-35              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-36              [64, 13248]               (recursive)
│    └─Linear: 2-24                      [13248, 1]                (recursive)
├─DecoderModel: 1-19                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-37              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-38              [64, 13248]               (recursive)
│    └─Linear: 2-26                      [13248, 1]                (recursive)
├─DecoderModel: 1-20                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-39              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-40              [64, 13248]               (recursive)
│    └─Linear: 2-28                      [13248, 1]                (recursive)
├─DecoderModel: 1-21                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-41              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-42              [64, 13248]               (recursive)
│    └─Linear: 2-30                      [13248, 1]                (recursive)
├─DecoderModel: 1-22                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-43              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-44              [64, 13248]               (recursive)
│    └─Linear: 2-32                      [13248, 1]                (recursive)
├─DecoderModel: 1-23                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-45              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-46              [64, 13248]               (recursive)
│    └─Linear: 2-34                      [13248, 1]                (recursive)
├─DecoderModel: 1-24                     [64, 207]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-47              [64, 13248]               (recursive)
│    │    └─DCGRUCell: 3-48              [64, 13248]               (recursive)
│    └─Linear: 2-36                      [13248, 1]                (recursive)
==========================================================================================
Total params: 65
Trainable params: 65
Non-trainable params: 0
Total mult-adds (T): 3.79
==========================================================================================
Input size (MB): 1.27
Forward/backward pass size (MB): 299.72
Params size (MB): 0.00
Estimated Total Size (MB): 300.99
==========================================================================================

Loss: MaskedMAELoss

2024-02-26 17:24:06.468881 Epoch 1  	Train Loss = 2.78750 Val Loss = 4.14579
2024-02-26 17:27:31.419484 Epoch 2  	Train Loss = 2.34597 Val Loss = 3.47316
2024-02-26 17:30:54.543332 Epoch 3  	Train Loss = 2.34296 Val Loss = 3.50363
2024-02-26 17:34:14.634495 Epoch 4  	Train Loss = 2.34346 Val Loss = 3.42599
2024-02-26 17:37:35.084996 Epoch 5  	Train Loss = 2.34347 Val Loss = 3.54933
2024-02-26 17:40:53.584379 Epoch 6  	Train Loss = 2.34347 Val Loss = 3.53184
2024-02-26 17:44:17.846220 Epoch 7  	Train Loss = 2.34522 Val Loss = 3.55409
2024-02-26 17:47:41.353345 Epoch 8  	Train Loss = 2.34271 Val Loss = 3.47580
2024-02-26 17:51:01.074923 Epoch 9  	Train Loss = 2.34337 Val Loss = 3.49480
2024-02-26 17:54:19.457234 Epoch 10  	Train Loss = 2.34352 Val Loss = 3.57030
2024-02-26 17:57:46.892919 Epoch 11  	Train Loss = 2.34482 Val Loss = 3.39083
2024-02-26 18:01:09.246125 Epoch 12  	Train Loss = 2.34441 Val Loss = 3.51558
2024-02-26 18:04:34.272419 Epoch 13  	Train Loss = 2.34421 Val Loss = 3.44036
2024-02-26 18:07:58.709639 Epoch 14  	Train Loss = 2.34526 Val Loss = 3.49912
2024-02-26 18:11:22.699889 Epoch 15  	Train Loss = 2.34622 Val Loss = 3.42063
2024-02-26 18:14:48.734721 Epoch 16  	Train Loss = 2.34681 Val Loss = 3.41101
2024-02-26 18:18:12.374252 Epoch 17  	Train Loss = 2.34767 Val Loss = 3.39234
2024-02-26 18:21:37.119690 Epoch 18  	Train Loss = 2.34858 Val Loss = 3.43151
2024-02-26 18:24:59.182284 Epoch 19  	Train Loss = 2.34875 Val Loss = 3.47271
2024-02-26 18:28:25.453530 Epoch 20  	Train Loss = 2.34881 Val Loss = 3.43051
2024-02-26 18:31:47.789239 Epoch 21  	Train Loss = 2.34904 Val Loss = 3.42452
2024-02-26 18:35:05.061297 Epoch 22  	Train Loss = 2.34995 Val Loss = 3.43710
2024-02-26 18:38:25.578282 Epoch 23  	Train Loss = 2.35116 Val Loss = 3.43458
2024-02-26 18:41:39.998870 Epoch 24  	Train Loss = 2.35584 Val Loss = 3.44622
2024-02-26 18:45:05.901046 Epoch 25  	Train Loss = 2.35587 Val Loss = 3.42691
2024-02-26 18:48:23.258714 Epoch 26  	Train Loss = 2.36100 Val Loss = 3.47672
2024-02-26 18:51:42.980720 Epoch 27  	Train Loss = 2.37149 Val Loss = 3.47585
2024-02-26 18:55:08.754013 Epoch 28  	Train Loss = 2.37500 Val Loss = 3.44754
2024-02-26 18:58:33.428723 Epoch 29  	Train Loss = 2.38113 Val Loss = 3.45079
2024-02-26 19:01:46.745913 Epoch 30  	Train Loss = 2.39339 Val Loss = 3.40465
2024-02-26 19:05:07.127575 Epoch 31  	Train Loss = 2.40294 Val Loss = 3.42213
Early stopping at epoch: 31
Best at epoch 11:
Train Loss = 2.34482
Train RMSE = 7.38309, MAE = 3.59169, MAPE = 9.77698
Val Loss = 3.39083
Val RMSE = 7.22705, MAE = 3.43216, MAPE = 9.60564
--------- Test ---------
All Steps RMSE = 7.74633, MAE = 3.81580, MAPE = 10.59190
Step 1 RMSE = 4.42071, MAE = 2.49563, MAPE = 6.21467
Step 2 RMSE = 5.43644, MAE = 2.85529, MAPE = 7.38619
Step 3 RMSE = 6.14946, MAE = 3.13187, MAPE = 8.29864
Step 4 RMSE = 6.72506, MAE = 3.37315, MAPE = 9.09884
Step 5 RMSE = 7.21059, MAE = 3.59115, MAPE = 9.83379
Step 6 RMSE = 7.64655, MAE = 3.79676, MAPE = 10.52839
Step 7 RMSE = 8.04244, MAE = 3.98703, MAPE = 11.16887
Step 8 RMSE = 8.41093, MAE = 4.16885, MAPE = 11.78068
Step 9 RMSE = 8.75605, MAE = 4.34333, MAPE = 12.35776
Step 10 RMSE = 9.08566, MAE = 4.51299, MAPE = 12.91643
Step 11 RMSE = 9.40486, MAE = 4.68258, MAPE = 13.47750
Step 12 RMSE = 9.71475, MAE = 4.85105, MAPE = 14.04149
Inference time: 22.55 s
