PEMSBAY
Trainset:	x-(36465, 12, 325, 2)	y-(36465, 12, 325, 1)
Valset:  	x-(5209, 12, 325, 2)  	y-(5209, 12, 325, 1)
Testset:	x-(10419, 12, 325, 2)	y-(10419, 12, 325, 1)

--------- DCRNN ---------
{
    "num_nodes": 325,
    "in_steps": 12,
    "out_steps": 12,
    "time_of_day": true,
    "runner": "dcrnn",
    "lr": 0.01,
    "eps": 0.001,
    "milestones": [
        20,
        30,
        40,
        50
    ],
    "clip_grad": 5,
    "batch_size": 64,
    "max_epochs": 200,
    "early_stop": 20,
    "pass_device": true,
    "model_args": {
        "num_nodes": 325,
        "adj_path": "../data/PEMSBAY/adj_mx_bay.pkl",
        "input_dim": 2,
        "output_dim": 1,
        "seq_len": 12,
        "horizon": 12,
        "rnn_units": 64,
        "num_rnn_layers": 2,
        "max_diffusion_step": 2,
        "filter_type": "dual_random_walk",
        "tf_decay_steps": 2000,
        "use_teacher_forcing": true,
        "device": "cuda:0"
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
DCRNN                                    [64, 12, 325, 1]          --
├─EncoderModel: 1-1                      [64, 20800]               --
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-1               [64, 20800]               --
│    │    └─DCGRUCell: 3-2               [64, 20800]               --
├─EncoderModel: 1-2                      [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-3               [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-4               [64, 20800]               (recursive)
├─EncoderModel: 1-3                      [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-5               [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-6               [64, 20800]               (recursive)
├─EncoderModel: 1-4                      [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-7               [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-8               [64, 20800]               (recursive)
├─EncoderModel: 1-5                      [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-9               [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-10              [64, 20800]               (recursive)
├─EncoderModel: 1-6                      [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-11              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-12              [64, 20800]               (recursive)
├─EncoderModel: 1-7                      [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-13              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-14              [64, 20800]               (recursive)
├─EncoderModel: 1-8                      [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-15              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-16              [64, 20800]               (recursive)
├─EncoderModel: 1-9                      [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-17              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-18              [64, 20800]               (recursive)
├─EncoderModel: 1-10                     [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-19              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-20              [64, 20800]               (recursive)
├─EncoderModel: 1-11                     [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-21              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-22              [64, 20800]               (recursive)
├─EncoderModel: 1-12                     [64, 20800]               (recursive)
│    └─ModuleList: 2-12                  --                        (recursive)
│    │    └─DCGRUCell: 3-23              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-24              [64, 20800]               (recursive)
├─DecoderModel: 1-13                     [64, 325]                 --
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-25              [64, 20800]               --
│    │    └─DCGRUCell: 3-26              [64, 20800]               --
│    └─Linear: 2-14                      [20800, 1]                65
├─DecoderModel: 1-14                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-27              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-28              [64, 20800]               (recursive)
│    └─Linear: 2-16                      [20800, 1]                (recursive)
├─DecoderModel: 1-15                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-29              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-30              [64, 20800]               (recursive)
│    └─Linear: 2-18                      [20800, 1]                (recursive)
├─DecoderModel: 1-16                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-31              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-32              [64, 20800]               (recursive)
│    └─Linear: 2-20                      [20800, 1]                (recursive)
├─DecoderModel: 1-17                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-33              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-34              [64, 20800]               (recursive)
│    └─Linear: 2-22                      [20800, 1]                (recursive)
├─DecoderModel: 1-18                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-35              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-36              [64, 20800]               (recursive)
│    └─Linear: 2-24                      [20800, 1]                (recursive)
├─DecoderModel: 1-19                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-37              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-38              [64, 20800]               (recursive)
│    └─Linear: 2-26                      [20800, 1]                (recursive)
├─DecoderModel: 1-20                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-39              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-40              [64, 20800]               (recursive)
│    └─Linear: 2-28                      [20800, 1]                (recursive)
├─DecoderModel: 1-21                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-41              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-42              [64, 20800]               (recursive)
│    └─Linear: 2-30                      [20800, 1]                (recursive)
├─DecoderModel: 1-22                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-43              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-44              [64, 20800]               (recursive)
│    └─Linear: 2-32                      [20800, 1]                (recursive)
├─DecoderModel: 1-23                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-45              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-46              [64, 20800]               (recursive)
│    └─Linear: 2-34                      [20800, 1]                (recursive)
├─DecoderModel: 1-24                     [64, 325]                 (recursive)
│    └─ModuleList: 2-35                  --                        (recursive)
│    │    └─DCGRUCell: 3-47              [64, 20800]               (recursive)
│    │    └─DCGRUCell: 3-48              [64, 20800]               (recursive)
│    └─Linear: 2-36                      [20800, 1]                (recursive)
==========================================================================================
Total params: 65
Trainable params: 65
Non-trainable params: 0
Total mult-adds (T): 5.95
==========================================================================================
Input size (MB): 2.00
Forward/backward pass size (MB): 470.58
Params size (MB): 0.00
Estimated Total Size (MB): 472.58
==========================================================================================

Loss: MaskedMAELoss

2024-03-09 11:19:13.954644 Epoch 1  	Train Loss = 1.00519 Val Loss = 2.58542
2024-03-09 11:26:13.416564 Epoch 2  	Train Loss = 0.86502 Val Loss = 2.09267
2024-03-09 11:33:11.618009 Epoch 3  	Train Loss = 0.85126 Val Loss = 2.02737
2024-03-09 11:40:08.716689 Epoch 4  	Train Loss = 0.84441 Val Loss = 1.94481
2024-03-09 11:47:06.782873 Epoch 5  	Train Loss = 0.83647 Val Loss = 2.10851
2024-03-09 11:54:03.730007 Epoch 6  	Train Loss = 0.83141 Val Loss = 1.98276
2024-03-09 12:01:01.523385 Epoch 7  	Train Loss = 0.82735 Val Loss = 1.94434
2024-03-09 12:07:58.712911 Epoch 8  	Train Loss = 0.82416 Val Loss = 1.87204
2024-03-09 12:14:55.315259 Epoch 9  	Train Loss = 0.82188 Val Loss = 1.84393
2024-03-09 12:21:53.046251 Epoch 10  	Train Loss = 0.81861 Val Loss = 1.89180
2024-03-09 12:28:49.997296 Epoch 11  	Train Loss = 0.81649 Val Loss = 1.87989
2024-03-09 12:35:48.017149 Epoch 12  	Train Loss = 0.81584 Val Loss = 1.88748
2024-03-09 12:42:45.890798 Epoch 13  	Train Loss = 0.81383 Val Loss = 1.86995
2024-03-09 12:49:44.360729 Epoch 14  	Train Loss = 0.81437 Val Loss = 1.80606
2024-03-09 12:56:41.462834 Epoch 15  	Train Loss = 0.81398 Val Loss = 1.85109
2024-03-09 13:03:39.947451 Epoch 16  	Train Loss = 0.81588 Val Loss = 1.81328
2024-03-09 13:10:37.814424 Epoch 17  	Train Loss = 0.81957 Val Loss = 1.79251
2024-03-09 13:17:35.753498 Epoch 18  	Train Loss = 0.82310 Val Loss = 1.85857
2024-03-09 13:24:34.105515 Epoch 19  	Train Loss = 0.83449 Val Loss = 1.79100
2024-03-09 13:31:32.153666 Epoch 20  	Train Loss = 0.84002 Val Loss = 2.12827
2024-03-09 13:38:30.444464 Epoch 21  	Train Loss = 0.83754 Val Loss = 1.70273
2024-03-09 13:45:29.258213 Epoch 22  	Train Loss = 0.84669 Val Loss = 1.71958
2024-03-09 13:52:26.875265 Epoch 23  	Train Loss = 0.86372 Val Loss = 1.68555
2024-03-09 13:59:24.878344 Epoch 24  	Train Loss = 0.88648 Val Loss = 1.68935
2024-03-09 14:06:23.448424 Epoch 25  	Train Loss = 0.90934 Val Loss = 1.69315
2024-03-09 14:13:22.737284 Epoch 26  	Train Loss = 0.93635 Val Loss = 1.68140
2024-03-09 14:20:20.933295 Epoch 27  	Train Loss = 0.97577 Val Loss = 1.66449
2024-03-09 14:27:17.762748 Epoch 28  	Train Loss = 1.01980 Val Loss = 1.67351
2024-03-09 14:34:15.276625 Epoch 29  	Train Loss = 1.06863 Val Loss = 1.66864
2024-03-09 14:41:12.191687 Epoch 30  	Train Loss = 1.11077 Val Loss = 1.66110
2024-03-09 14:48:08.946058 Epoch 31  	Train Loss = 1.14178 Val Loss = 1.62937
2024-03-09 14:55:05.772642 Epoch 32  	Train Loss = 1.18601 Val Loss = 1.63152
2024-03-09 15:02:02.699993 Epoch 33  	Train Loss = 1.23800 Val Loss = 1.62526
2024-03-09 15:09:00.631098 Epoch 34  	Train Loss = 1.27744 Val Loss = 1.62679
2024-03-09 15:15:58.030095 Epoch 35  	Train Loss = 1.30903 Val Loss = 1.62155
2024-03-09 15:22:55.046652 Epoch 36  	Train Loss = 1.33284 Val Loss = 1.62202
2024-03-09 15:29:51.956122 Epoch 37  	Train Loss = 1.35957 Val Loss = 1.62012
2024-03-09 15:36:49.100283 Epoch 38  	Train Loss = 1.36224 Val Loss = 1.62366
2024-03-09 15:43:47.265154 Epoch 39  	Train Loss = 1.38349 Val Loss = 1.61955
2024-03-09 15:50:46.507151 Epoch 40  	Train Loss = 1.39112 Val Loss = 1.61978
2024-03-09 15:57:44.342369 Epoch 41  	Train Loss = 1.40423 Val Loss = 1.61473
2024-03-09 16:04:41.162779 Epoch 42  	Train Loss = 1.40624 Val Loss = 1.61495
2024-03-09 16:11:38.109919 Epoch 43  	Train Loss = 1.40889 Val Loss = 1.61516
2024-03-09 16:18:34.588151 Epoch 44  	Train Loss = 1.41500 Val Loss = 1.61462
2024-03-09 16:25:31.628682 Epoch 45  	Train Loss = 1.41889 Val Loss = 1.61487
2024-03-09 16:32:28.673745 Epoch 46  	Train Loss = 1.42007 Val Loss = 1.61430
2024-03-09 16:39:25.744716 Epoch 47  	Train Loss = 1.42051 Val Loss = 1.61355
2024-03-09 16:46:24.309140 Epoch 48  	Train Loss = 1.42169 Val Loss = 1.61483
2024-03-09 16:53:23.064640 Epoch 49  	Train Loss = 1.42126 Val Loss = 1.61499
2024-03-09 17:00:22.167817 Epoch 50  	Train Loss = 1.42228 Val Loss = 1.61390
2024-03-09 17:07:20.117417 Epoch 51  	Train Loss = 1.42315 Val Loss = 1.61414
2024-03-09 17:14:19.069454 Epoch 52  	Train Loss = 1.42323 Val Loss = 1.61439
2024-03-09 17:21:16.889175 Epoch 53  	Train Loss = 1.42204 Val Loss = 1.61437
2024-03-09 17:28:13.189392 Epoch 54  	Train Loss = 1.42337 Val Loss = 1.61424
2024-03-09 17:35:11.260510 Epoch 55  	Train Loss = 1.42333 Val Loss = 1.61426
2024-03-09 17:42:10.935434 Epoch 56  	Train Loss = 1.42289 Val Loss = 1.61466
2024-03-09 17:49:08.082248 Epoch 57  	Train Loss = 1.42366 Val Loss = 1.61434
2024-03-09 17:56:06.730645 Epoch 58  	Train Loss = 1.42368 Val Loss = 1.61452
2024-03-09 18:03:06.222063 Epoch 59  	Train Loss = 1.42343 Val Loss = 1.61453
2024-03-09 18:10:01.933077 Epoch 60  	Train Loss = 1.42350 Val Loss = 1.61451
2024-03-09 18:16:58.234582 Epoch 61  	Train Loss = 1.42359 Val Loss = 1.61454
2024-03-09 18:23:54.490598 Epoch 62  	Train Loss = 1.42320 Val Loss = 1.61425
2024-03-09 18:30:51.752777 Epoch 63  	Train Loss = 1.42353 Val Loss = 1.61452
2024-03-09 18:37:49.734492 Epoch 64  	Train Loss = 1.42326 Val Loss = 1.61428
2024-03-09 18:44:47.501639 Epoch 65  	Train Loss = 1.42341 Val Loss = 1.61496
2024-03-09 18:51:44.140128 Epoch 66  	Train Loss = 1.42316 Val Loss = 1.61451
2024-03-09 18:58:41.976482 Epoch 67  	Train Loss = 1.42303 Val Loss = 1.61444
Early stopping at epoch: 67
Best at epoch 47:
Train Loss = 1.42051
Train RMSE = 3.18610, MAE = 1.42510, MAPE = 3.04195
Val Loss = 1.61355
Val RMSE = 3.72322, MAE = 1.60299, MAPE = 3.66609
--------- Test ---------
All Steps RMSE = 3.69641, MAE = 1.59003, MAPE = 3.60365
Step 1 RMSE = 1.54221, MAE = 0.85205, MAPE = 1.63892
Step 2 RMSE = 2.23245, MAE = 1.12504, MAPE = 2.26231
Step 3 RMSE = 2.76761, MAE = 1.31339, MAPE = 2.73840
Step 4 RMSE = 3.18468, MAE = 1.45510, MAPE = 3.13243
Step 5 RMSE = 3.50771, MAE = 1.56398, MAPE = 3.45622
Step 6 RMSE = 3.76232, MAE = 1.65142, MAPE = 3.72741
Step 7 RMSE = 3.97072, MAE = 1.72379, MAPE = 3.95996
Step 8 RMSE = 4.14416, MAE = 1.78520, MAPE = 4.16368
Step 9 RMSE = 4.28917, MAE = 1.83814, MAPE = 4.33950
Step 10 RMSE = 4.40979, MAE = 1.88399, MAPE = 4.48750
Step 11 RMSE = 4.51212, MAE = 1.92480, MAPE = 4.61249
Step 12 RMSE = 4.60382, MAE = 1.96345, MAPE = 4.72503
Inference time: 55.91 s
