PEMS03
Trainset:	x-(15711, 12, 358, 1)	y-(15711, 12, 358, 1)
Valset:  	x-(5237, 12, 358, 1)  	y-(5237, 12, 358, 1)
Testset:	x-(5237, 12, 358, 1)	y-(5237, 12, 358, 1)

--------- STGCN ---------
{
    "num_nodes": 358,
    "in_steps": 12,
    "out_steps": 12,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        30,
        50
    ],
    "clip_grad": 5,
    "batch_size": 64,
    "max_epochs": 200,
    "early_stop": 20,
    "model_args": {
        "n_vertex": 358,
        "adj_path": "../data/PEMS03/adj_PEMS03.pkl",
        "Kt": 3,
        "Ks": 3,
        "blocks": [
            [
                1
            ],
            [
                64,
                16,
                64
            ],
            [
                64,
                16,
                64
            ],
            [
                128,
                128
            ],
            [
                12
            ]
        ],
        "T": 12,
        "act_func": "glu",
        "graph_conv_type": "cheb_graph_conv",
        "bias": true,
        "droprate": 0.5
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STGCN                                    [64, 12, 358, 1]          --
├─Sequential: 1-1                        [64, 64, 4, 358]          --
│    └─STConvBlock: 2-1                  [64, 64, 8, 358]          --
│    │    └─TemporalConvLayer: 3-1       [64, 64, 10, 358]         640
│    │    └─GraphConvLayer: 3-2          [64, 16, 10, 358]         1,824
│    │    └─ReLU: 3-3                    [64, 16, 10, 358]         --
│    │    └─TemporalConvLayer: 3-4       [64, 64, 8, 358]          7,360
│    │    └─LayerNorm: 3-5               [64, 8, 358, 64]          45,824
│    │    └─Dropout: 3-6                 [64, 64, 8, 358]          --
│    └─STConvBlock: 2-2                  [64, 64, 4, 358]          --
│    │    └─TemporalConvLayer: 3-7       [64, 64, 6, 358]          28,864
│    │    └─GraphConvLayer: 3-8          [64, 16, 6, 358]          1,824
│    │    └─ReLU: 3-9                    [64, 16, 6, 358]          --
│    │    └─TemporalConvLayer: 3-10      [64, 64, 4, 358]          7,360
│    │    └─LayerNorm: 3-11              [64, 4, 358, 64]          45,824
│    │    └─Dropout: 3-12                [64, 64, 4, 358]          --
├─OutputBlock: 1-2                       [64, 12, 1, 358]          --
│    └─TemporalConvLayer: 2-3            [64, 128, 1, 358]         --
│    │    └─Align: 3-13                  [64, 128, 4, 358]         8,320
│    │    └─CausalConv2d: 3-14           [64, 256, 1, 358]         65,792
│    │    └─Sigmoid: 3-15                [64, 128, 1, 358]         --
│    └─LayerNorm: 2-4                    [64, 1, 358, 128]         91,648
│    └─Linear: 2-5                       [64, 1, 358, 128]         16,512
│    └─ReLU: 2-6                         [64, 1, 358, 128]         --
│    └─Linear: 2-7                       [64, 1, 358, 12]          1,548
==========================================================================================
Total params: 323,340
Trainable params: 323,340
Non-trainable params: 0
Total mult-adds (G): 7.71
==========================================================================================
Input size (MB): 1.10
Forward/backward pass size (MB): 987.60
Params size (MB): 1.23
Estimated Total Size (MB): 989.93
==========================================================================================

Loss: HuberLoss

2023-09-24 10:39:25.791175 Epoch 1  	Train Loss = 29.79897 Val Loss = 22.13937
2023-09-24 10:40:02.735506 Epoch 2  	Train Loss = 21.76947 Val Loss = 20.39656
2023-09-24 10:40:44.006904 Epoch 3  	Train Loss = 20.07810 Val Loss = 19.23874
2023-09-24 10:41:25.906177 Epoch 4  	Train Loss = 19.01970 Val Loss = 18.22843
2023-09-24 10:42:08.540884 Epoch 5  	Train Loss = 18.20677 Val Loss = 17.46910
2023-09-24 10:42:51.137745 Epoch 6  	Train Loss = 17.63358 Val Loss = 17.52034
2023-09-24 10:43:34.528157 Epoch 7  	Train Loss = 17.39248 Val Loss = 17.36321
2023-09-24 10:44:17.127991 Epoch 8  	Train Loss = 17.13627 Val Loss = 16.90303
2023-09-24 10:45:00.425634 Epoch 9  	Train Loss = 16.83493 Val Loss = 16.26631
2023-09-24 10:45:42.785701 Epoch 10  	Train Loss = 16.49097 Val Loss = 17.10561
2023-09-24 10:46:25.382242 Epoch 11  	Train Loss = 16.30572 Val Loss = 16.58043
2023-09-24 10:47:08.395577 Epoch 12  	Train Loss = 16.08691 Val Loss = 16.10536
2023-09-24 10:47:50.425535 Epoch 13  	Train Loss = 15.91529 Val Loss = 16.51681
2023-09-24 10:48:32.744909 Epoch 14  	Train Loss = 15.81079 Val Loss = 17.27107
2023-09-24 10:49:15.188042 Epoch 15  	Train Loss = 15.68442 Val Loss = 16.06062
2023-09-24 10:49:57.840067 Epoch 16  	Train Loss = 15.58655 Val Loss = 15.92665
2023-09-24 10:50:40.310821 Epoch 17  	Train Loss = 15.52199 Val Loss = 16.11177
2023-09-24 10:51:22.556345 Epoch 18  	Train Loss = 15.38195 Val Loss = 15.52167
2023-09-24 10:52:04.893501 Epoch 19  	Train Loss = 15.43804 Val Loss = 16.12002
2023-09-24 10:52:47.298407 Epoch 20  	Train Loss = 15.29527 Val Loss = 15.60504
2023-09-24 10:53:29.748312 Epoch 21  	Train Loss = 15.27546 Val Loss = 15.49136
2023-09-24 10:54:12.388005 Epoch 22  	Train Loss = 15.11520 Val Loss = 15.23872
2023-09-24 10:54:55.228590 Epoch 23  	Train Loss = 15.09570 Val Loss = 15.94598
2023-09-24 10:55:38.555298 Epoch 24  	Train Loss = 14.98149 Val Loss = 15.28815
2023-09-24 10:56:21.050224 Epoch 25  	Train Loss = 15.00012 Val Loss = 16.51746
2023-09-24 10:57:03.281598 Epoch 26  	Train Loss = 14.93761 Val Loss = 15.12675
2023-09-24 10:57:45.529934 Epoch 27  	Train Loss = 14.82730 Val Loss = 15.30335
2023-09-24 10:58:27.581603 Epoch 28  	Train Loss = 14.78517 Val Loss = 14.91773
2023-09-24 10:59:09.806788 Epoch 29  	Train Loss = 14.71580 Val Loss = 14.85832
2023-09-24 10:59:52.561955 Epoch 30  	Train Loss = 14.65875 Val Loss = 15.04906
2023-09-24 11:00:35.100617 Epoch 31  	Train Loss = 14.31296 Val Loss = 14.84036
2023-09-24 11:01:18.869181 Epoch 32  	Train Loss = 14.27915 Val Loss = 14.77801
2023-09-24 11:02:05.002967 Epoch 33  	Train Loss = 14.26017 Val Loss = 14.68976
2023-09-24 11:02:48.455504 Epoch 34  	Train Loss = 14.24736 Val Loss = 14.68072
2023-09-24 11:03:32.408335 Epoch 35  	Train Loss = 14.23122 Val Loss = 14.77485
2023-09-24 11:04:14.790921 Epoch 36  	Train Loss = 14.22528 Val Loss = 14.70164
2023-09-24 11:04:57.093778 Epoch 37  	Train Loss = 14.21904 Val Loss = 14.78259
2023-09-24 11:05:39.401822 Epoch 38  	Train Loss = 14.21177 Val Loss = 14.69860
2023-09-24 11:06:17.968501 Epoch 39  	Train Loss = 14.18742 Val Loss = 14.72826
2023-09-24 11:06:55.152015 Epoch 40  	Train Loss = 14.18296 Val Loss = 14.68881
2023-09-24 11:07:31.988723 Epoch 41  	Train Loss = 14.17383 Val Loss = 14.57493
2023-09-24 11:08:10.823992 Epoch 42  	Train Loss = 14.17138 Val Loss = 14.61718
2023-09-24 11:08:47.561153 Epoch 43  	Train Loss = 14.15853 Val Loss = 14.55379
2023-09-24 11:09:24.271409 Epoch 44  	Train Loss = 14.15975 Val Loss = 14.63251
2023-09-24 11:10:03.356739 Epoch 45  	Train Loss = 14.14060 Val Loss = 14.70575
2023-09-24 11:10:40.580369 Epoch 46  	Train Loss = 14.14145 Val Loss = 14.59233
2023-09-24 11:11:17.475866 Epoch 47  	Train Loss = 14.13205 Val Loss = 14.71314
2023-09-24 11:11:54.429557 Epoch 48  	Train Loss = 14.13135 Val Loss = 14.63055
2023-09-24 11:12:33.314604 Epoch 49  	Train Loss = 14.12955 Val Loss = 14.72409
2023-09-24 11:13:09.639057 Epoch 50  	Train Loss = 14.11177 Val Loss = 14.60843
2023-09-24 11:13:46.578398 Epoch 51  	Train Loss = 14.07915 Val Loss = 14.62085
2023-09-24 11:14:23.434852 Epoch 52  	Train Loss = 14.06324 Val Loss = 14.59167
2023-09-24 11:15:00.163683 Epoch 53  	Train Loss = 14.07182 Val Loss = 14.60055
2023-09-24 11:15:37.109644 Epoch 54  	Train Loss = 14.06434 Val Loss = 14.59084
2023-09-24 11:16:13.992569 Epoch 55  	Train Loss = 14.06363 Val Loss = 14.59526
2023-09-24 11:16:50.646298 Epoch 56  	Train Loss = 14.06489 Val Loss = 14.59350
2023-09-24 11:17:27.310776 Epoch 57  	Train Loss = 14.05675 Val Loss = 14.58877
2023-09-24 11:18:04.053460 Epoch 58  	Train Loss = 14.06389 Val Loss = 14.60022
2023-09-24 11:18:40.876900 Epoch 59  	Train Loss = 14.06141 Val Loss = 14.56401
2023-09-24 11:19:17.963486 Epoch 60  	Train Loss = 14.06244 Val Loss = 14.60568
2023-09-24 11:19:54.955655 Epoch 61  	Train Loss = 14.06012 Val Loss = 14.56369
2023-09-24 11:20:32.047955 Epoch 62  	Train Loss = 14.06089 Val Loss = 14.58241
2023-09-24 11:21:08.696666 Epoch 63  	Train Loss = 14.05295 Val Loss = 14.58199
Early stopping at epoch: 63
Best at epoch 43:
Train Loss = 14.15853
Train RMSE = 22.93700, MAE = 14.47889, MAPE = 14.11214
Val Loss = 14.55379
Val RMSE = 23.67199, MAE = 15.11440, MAPE = 14.44463
--------- Test ---------
All Steps RMSE = 27.67564, MAE = 16.16632, MAPE = 15.44690
Step 1 RMSE = 23.40121, MAE = 13.85378, MAPE = 14.00255
Step 2 RMSE = 24.56336, MAE = 14.47083, MAPE = 14.37704
Step 3 RMSE = 25.55519, MAE = 15.00168, MAPE = 14.71492
Step 4 RMSE = 26.32543, MAE = 15.41218, MAPE = 14.97985
Step 5 RMSE = 26.98849, MAE = 15.75093, MAPE = 15.15709
Step 6 RMSE = 27.63828, MAE = 16.08984, MAPE = 15.32354
Step 7 RMSE = 28.24548, MAE = 16.43648, MAPE = 15.48261
Step 8 RMSE = 28.75175, MAE = 16.76817, MAPE = 15.73265
Step 9 RMSE = 29.17946, MAE = 17.06520, MAPE = 15.97127
Step 10 RMSE = 29.56335, MAE = 17.32421, MAPE = 16.17286
Step 11 RMSE = 30.06280, MAE = 17.66641, MAPE = 16.53271
Step 12 RMSE = 30.79434, MAE = 18.15625, MAPE = 16.91582
Inference time: 5.16 s
