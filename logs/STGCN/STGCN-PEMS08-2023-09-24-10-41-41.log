PEMS08
Trainset:	x-(10700, 12, 170, 1)	y-(10700, 12, 170, 1)
Valset:  	x-(3567, 12, 170, 1)  	y-(3567, 12, 170, 1)
Testset:	x-(3566, 12, 170, 1)	y-(3566, 12, 170, 1)

--------- STGCN ---------
{
    "num_nodes": 170,
    "in_steps": 12,
    "out_steps": 12,
    "lr": 0.001,
    "weight_decay": 0.0001,
    "milestones": [
        30,
        50
    ],
    "clip_grad": 5,
    "batch_size": 64,
    "max_epochs": 200,
    "early_stop": 20,
    "model_args": {
        "n_vertex": 170,
        "adj_path": "../data/PEMS08/adj_PEMS08.pkl",
        "Kt": 3,
        "Ks": 3,
        "blocks": [
            [
                1
            ],
            [
                64,
                16,
                64
            ],
            [
                64,
                16,
                64
            ],
            [
                128,
                128
            ],
            [
                12
            ]
        ],
        "T": 12,
        "act_func": "glu",
        "graph_conv_type": "cheb_graph_conv",
        "bias": true,
        "droprate": 0.5
    }
}
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
STGCN                                    [64, 12, 170, 1]          --
├─Sequential: 1-1                        [64, 64, 4, 170]          --
│    └─STConvBlock: 2-1                  [64, 64, 8, 170]          --
│    │    └─TemporalConvLayer: 3-1       [64, 64, 10, 170]         640
│    │    └─GraphConvLayer: 3-2          [64, 16, 10, 170]         1,824
│    │    └─ReLU: 3-3                    [64, 16, 10, 170]         --
│    │    └─TemporalConvLayer: 3-4       [64, 64, 8, 170]          7,360
│    │    └─LayerNorm: 3-5               [64, 8, 170, 64]          21,760
│    │    └─Dropout: 3-6                 [64, 64, 8, 170]          --
│    └─STConvBlock: 2-2                  [64, 64, 4, 170]          --
│    │    └─TemporalConvLayer: 3-7       [64, 64, 6, 170]          28,864
│    │    └─GraphConvLayer: 3-8          [64, 16, 6, 170]          1,824
│    │    └─ReLU: 3-9                    [64, 16, 6, 170]          --
│    │    └─TemporalConvLayer: 3-10      [64, 64, 4, 170]          7,360
│    │    └─LayerNorm: 3-11              [64, 4, 170, 64]          21,760
│    │    └─Dropout: 3-12                [64, 64, 4, 170]          --
├─OutputBlock: 1-2                       [64, 12, 1, 170]          --
│    └─TemporalConvLayer: 2-3            [64, 128, 1, 170]         --
│    │    └─Align: 3-13                  [64, 128, 4, 170]         8,320
│    │    └─CausalConv2d: 3-14           [64, 256, 1, 170]         65,792
│    │    └─Sigmoid: 3-15                [64, 128, 1, 170]         --
│    └─LayerNorm: 2-4                    [64, 1, 170, 128]         43,520
│    └─Linear: 2-5                       [64, 1, 170, 128]         16,512
│    └─ReLU: 2-6                         [64, 1, 170, 128]         --
│    └─Linear: 2-7                       [64, 1, 170, 12]          1,548
==========================================================================================
Total params: 227,084
Trainable params: 227,084
Non-trainable params: 0
Total mult-adds (G): 3.66
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 468.97
Params size (MB): 0.85
Estimated Total Size (MB): 470.34
==========================================================================================

Loss: HuberLoss

2023-09-24 10:41:55.252031 Epoch 1  	Train Loss = 33.67655 Val Loss = 28.97423
2023-09-24 10:42:06.602241 Epoch 2  	Train Loss = 23.70769 Val Loss = 22.30925
2023-09-24 10:42:17.935154 Epoch 3  	Train Loss = 22.46088 Val Loss = 22.77723
2023-09-24 10:42:29.249657 Epoch 4  	Train Loss = 20.96431 Val Loss = 20.45326
2023-09-24 10:42:40.496661 Epoch 5  	Train Loss = 20.88424 Val Loss = 20.73281
2023-09-24 10:42:51.889482 Epoch 6  	Train Loss = 20.01695 Val Loss = 19.94539
2023-09-24 10:43:03.197409 Epoch 7  	Train Loss = 19.73617 Val Loss = 20.09893
2023-09-24 10:43:14.533833 Epoch 8  	Train Loss = 19.27834 Val Loss = 21.52981
2023-09-24 10:43:25.437663 Epoch 9  	Train Loss = 19.12721 Val Loss = 19.47808
2023-09-24 10:43:36.093190 Epoch 10  	Train Loss = 18.78605 Val Loss = 18.20649
2023-09-24 10:43:46.492612 Epoch 11  	Train Loss = 18.66250 Val Loss = 19.09762
2023-09-24 10:43:57.518710 Epoch 12  	Train Loss = 18.71098 Val Loss = 18.66277
2023-09-24 10:44:08.954180 Epoch 13  	Train Loss = 18.15456 Val Loss = 19.71939
2023-09-24 10:44:20.410236 Epoch 14  	Train Loss = 18.24054 Val Loss = 17.52964
2023-09-24 10:44:31.596660 Epoch 15  	Train Loss = 17.94653 Val Loss = 18.11589
2023-09-24 10:44:43.089229 Epoch 16  	Train Loss = 17.77490 Val Loss = 17.56591
2023-09-24 10:44:54.549244 Epoch 17  	Train Loss = 17.87501 Val Loss = 17.83582
2023-09-24 10:45:05.996002 Epoch 18  	Train Loss = 17.58108 Val Loss = 17.45586
2023-09-24 10:45:17.314039 Epoch 19  	Train Loss = 17.51285 Val Loss = 17.82022
2023-09-24 10:45:28.607953 Epoch 20  	Train Loss = 17.54096 Val Loss = 19.41972
2023-09-24 10:45:39.975990 Epoch 21  	Train Loss = 17.31437 Val Loss = 17.77279
2023-09-24 10:45:51.330831 Epoch 22  	Train Loss = 17.11210 Val Loss = 17.44065
2023-09-24 10:46:01.841812 Epoch 23  	Train Loss = 17.18715 Val Loss = 18.07006
2023-09-24 10:46:12.441380 Epoch 24  	Train Loss = 17.05911 Val Loss = 17.48800
2023-09-24 10:46:23.481781 Epoch 25  	Train Loss = 16.88137 Val Loss = 16.97879
2023-09-24 10:46:35.030822 Epoch 26  	Train Loss = 16.95064 Val Loss = 16.98466
2023-09-24 10:46:46.729880 Epoch 27  	Train Loss = 16.87910 Val Loss = 16.77983
2023-09-24 10:46:58.193225 Epoch 28  	Train Loss = 16.77681 Val Loss = 17.13954
2023-09-24 10:47:09.699369 Epoch 29  	Train Loss = 16.65322 Val Loss = 17.01976
2023-09-24 10:47:20.998439 Epoch 30  	Train Loss = 16.63013 Val Loss = 17.13791
2023-09-24 10:47:32.458706 Epoch 31  	Train Loss = 16.14195 Val Loss = 16.63656
2023-09-24 10:47:44.130224 Epoch 32  	Train Loss = 16.08501 Val Loss = 16.67602
2023-09-24 10:47:55.615686 Epoch 33  	Train Loss = 16.06609 Val Loss = 16.57977
2023-09-24 10:48:07.161548 Epoch 34  	Train Loss = 16.03722 Val Loss = 16.57087
2023-09-24 10:48:17.917848 Epoch 35  	Train Loss = 16.01267 Val Loss = 16.63900
2023-09-24 10:48:28.555337 Epoch 36  	Train Loss = 16.00350 Val Loss = 16.56758
2023-09-24 10:48:38.980846 Epoch 37  	Train Loss = 16.00542 Val Loss = 16.62683
2023-09-24 10:48:50.362697 Epoch 38  	Train Loss = 15.99987 Val Loss = 16.58159
2023-09-24 10:49:01.796482 Epoch 39  	Train Loss = 15.98062 Val Loss = 16.61564
2023-09-24 10:49:13.291219 Epoch 40  	Train Loss = 15.95992 Val Loss = 16.51450
2023-09-24 10:49:24.686691 Epoch 41  	Train Loss = 15.93948 Val Loss = 16.62937
2023-09-24 10:49:36.141582 Epoch 42  	Train Loss = 15.94295 Val Loss = 16.73094
2023-09-24 10:49:47.596454 Epoch 43  	Train Loss = 15.92909 Val Loss = 16.59580
2023-09-24 10:49:59.207382 Epoch 44  	Train Loss = 15.91865 Val Loss = 16.55432
2023-09-24 10:50:10.619413 Epoch 45  	Train Loss = 15.90919 Val Loss = 16.57268
2023-09-24 10:50:22.031420 Epoch 46  	Train Loss = 15.90631 Val Loss = 16.47317
2023-09-24 10:50:33.718179 Epoch 47  	Train Loss = 15.88175 Val Loss = 16.54124
2023-09-24 10:50:44.638848 Epoch 48  	Train Loss = 15.87963 Val Loss = 16.56812
2023-09-24 10:50:55.307816 Epoch 49  	Train Loss = 15.87213 Val Loss = 16.52072
2023-09-24 10:51:06.104298 Epoch 50  	Train Loss = 15.86708 Val Loss = 16.63463
2023-09-24 10:51:17.670181 Epoch 51  	Train Loss = 15.82696 Val Loss = 16.45719
2023-09-24 10:51:29.134542 Epoch 52  	Train Loss = 15.79761 Val Loss = 16.44978
2023-09-24 10:51:40.792071 Epoch 53  	Train Loss = 15.80400 Val Loss = 16.44461
2023-09-24 10:51:52.306138 Epoch 54  	Train Loss = 15.79741 Val Loss = 16.48026
2023-09-24 10:52:04.045672 Epoch 55  	Train Loss = 15.79866 Val Loss = 16.45859
2023-09-24 10:52:15.447325 Epoch 56  	Train Loss = 15.78183 Val Loss = 16.45218
2023-09-24 10:52:27.166290 Epoch 57  	Train Loss = 15.80177 Val Loss = 16.44671
2023-09-24 10:52:38.612254 Epoch 58  	Train Loss = 15.80302 Val Loss = 16.43260
2023-09-24 10:52:50.207757 Epoch 59  	Train Loss = 15.80472 Val Loss = 16.45523
2023-09-24 10:53:01.265948 Epoch 60  	Train Loss = 15.79643 Val Loss = 16.44360
2023-09-24 10:53:11.901242 Epoch 61  	Train Loss = 15.81007 Val Loss = 16.46951
2023-09-24 10:53:22.527656 Epoch 62  	Train Loss = 15.78133 Val Loss = 16.45076
2023-09-24 10:53:33.991075 Epoch 63  	Train Loss = 15.80003 Val Loss = 16.43886
2023-09-24 10:53:45.494865 Epoch 64  	Train Loss = 15.79995 Val Loss = 16.45371
2023-09-24 10:53:56.914939 Epoch 65  	Train Loss = 15.79088 Val Loss = 16.45319
2023-09-24 10:54:08.427840 Epoch 66  	Train Loss = 15.78652 Val Loss = 16.43216
2023-09-24 10:54:19.761745 Epoch 67  	Train Loss = 15.77505 Val Loss = 16.43261
2023-09-24 10:54:31.021142 Epoch 68  	Train Loss = 15.78856 Val Loss = 16.47032
2023-09-24 10:54:42.395953 Epoch 69  	Train Loss = 15.78260 Val Loss = 16.42888
2023-09-24 10:54:53.873198 Epoch 70  	Train Loss = 15.77565 Val Loss = 16.41098
2023-09-24 10:55:05.371443 Epoch 71  	Train Loss = 15.79666 Val Loss = 16.46592
2023-09-24 10:55:16.960740 Epoch 72  	Train Loss = 15.77502 Val Loss = 16.40142
2023-09-24 10:55:27.716547 Epoch 73  	Train Loss = 15.78000 Val Loss = 16.45427
2023-09-24 10:55:38.293158 Epoch 74  	Train Loss = 15.76742 Val Loss = 16.43287
2023-09-24 10:55:49.068753 Epoch 75  	Train Loss = 15.79299 Val Loss = 16.43375
2023-09-24 10:56:00.608313 Epoch 76  	Train Loss = 15.79597 Val Loss = 16.44074
2023-09-24 10:56:12.221358 Epoch 77  	Train Loss = 15.78839 Val Loss = 16.41460
2023-09-24 10:56:23.812142 Epoch 78  	Train Loss = 15.77869 Val Loss = 16.40194
2023-09-24 10:56:35.465408 Epoch 79  	Train Loss = 15.76560 Val Loss = 16.42426
2023-09-24 10:56:46.959453 Epoch 80  	Train Loss = 15.77287 Val Loss = 16.42482
2023-09-24 10:56:58.583668 Epoch 81  	Train Loss = 15.77739 Val Loss = 16.43079
2023-09-24 10:57:10.057267 Epoch 82  	Train Loss = 15.77244 Val Loss = 16.42244
2023-09-24 10:57:21.633579 Epoch 83  	Train Loss = 15.77826 Val Loss = 16.42813
2023-09-24 10:57:33.094877 Epoch 84  	Train Loss = 15.77168 Val Loss = 16.42473
2023-09-24 10:57:44.384250 Epoch 85  	Train Loss = 15.77169 Val Loss = 16.40936
2023-09-24 10:57:54.972615 Epoch 86  	Train Loss = 15.76985 Val Loss = 16.40111
2023-09-24 10:58:05.506822 Epoch 87  	Train Loss = 15.76882 Val Loss = 16.43712
2023-09-24 10:58:16.661937 Epoch 88  	Train Loss = 15.75490 Val Loss = 16.40473
2023-09-24 10:58:28.211459 Epoch 89  	Train Loss = 15.75868 Val Loss = 16.41795
2023-09-24 10:58:39.756471 Epoch 90  	Train Loss = 15.76767 Val Loss = 16.43404
2023-09-24 10:58:50.832110 Epoch 91  	Train Loss = 15.75716 Val Loss = 16.40666
2023-09-24 10:59:01.179580 Epoch 92  	Train Loss = 15.75949 Val Loss = 16.41982
2023-09-24 10:59:11.514717 Epoch 93  	Train Loss = 15.77912 Val Loss = 16.40745
2023-09-24 10:59:21.398966 Epoch 94  	Train Loss = 15.74793 Val Loss = 16.45267
2023-09-24 10:59:32.388005 Epoch 95  	Train Loss = 15.75739 Val Loss = 16.41220
2023-09-24 10:59:43.231757 Epoch 96  	Train Loss = 15.75293 Val Loss = 16.38982
2023-09-24 10:59:54.156921 Epoch 97  	Train Loss = 15.74591 Val Loss = 16.39105
2023-09-24 11:00:05.601424 Epoch 98  	Train Loss = 15.75591 Val Loss = 16.37259
2023-09-24 11:00:16.012861 Epoch 99  	Train Loss = 15.75364 Val Loss = 16.40201
2023-09-24 11:00:26.762301 Epoch 100  	Train Loss = 15.74813 Val Loss = 16.42714
2023-09-24 11:00:38.028372 Epoch 101  	Train Loss = 15.75376 Val Loss = 16.40850
2023-09-24 11:00:49.364273 Epoch 102  	Train Loss = 15.75283 Val Loss = 16.40872
2023-09-24 11:01:00.715328 Epoch 103  	Train Loss = 15.74173 Val Loss = 16.40771
2023-09-24 11:01:11.511163 Epoch 104  	Train Loss = 15.75393 Val Loss = 16.42037
2023-09-24 11:01:22.870296 Epoch 105  	Train Loss = 15.75072 Val Loss = 16.38112
2023-09-24 11:01:34.143792 Epoch 106  	Train Loss = 15.73923 Val Loss = 16.40439
2023-09-24 11:01:45.613075 Epoch 107  	Train Loss = 15.74569 Val Loss = 16.41925
2023-09-24 11:01:56.795068 Epoch 108  	Train Loss = 15.75135 Val Loss = 16.40117
2023-09-24 11:02:08.590631 Epoch 109  	Train Loss = 15.74948 Val Loss = 16.43766
2023-09-24 11:02:19.934541 Epoch 110  	Train Loss = 15.73392 Val Loss = 16.41673
2023-09-24 11:02:31.327833 Epoch 111  	Train Loss = 15.74082 Val Loss = 16.41752
2023-09-24 11:02:42.010337 Epoch 112  	Train Loss = 15.74784 Val Loss = 16.41034
2023-09-24 11:02:52.796028 Epoch 113  	Train Loss = 15.72944 Val Loss = 16.43538
2023-09-24 11:03:04.363431 Epoch 114  	Train Loss = 15.74229 Val Loss = 16.36851
2023-09-24 11:03:15.683249 Epoch 115  	Train Loss = 15.74507 Val Loss = 16.42190
2023-09-24 11:03:27.346314 Epoch 116  	Train Loss = 15.74182 Val Loss = 16.39824
2023-09-24 11:03:39.033839 Epoch 117  	Train Loss = 15.72989 Val Loss = 16.40867
2023-09-24 11:03:50.361001 Epoch 118  	Train Loss = 15.72922 Val Loss = 16.41401
2023-09-24 11:04:01.871188 Epoch 119  	Train Loss = 15.73350 Val Loss = 16.42756
2023-09-24 11:04:13.616300 Epoch 120  	Train Loss = 15.74727 Val Loss = 16.41322
2023-09-24 11:04:25.040530 Epoch 121  	Train Loss = 15.73006 Val Loss = 16.38851
2023-09-24 11:04:36.404588 Epoch 122  	Train Loss = 15.74254 Val Loss = 16.38827
2023-09-24 11:04:47.811988 Epoch 123  	Train Loss = 15.73500 Val Loss = 16.38953
2023-09-24 11:04:58.399188 Epoch 124  	Train Loss = 15.72786 Val Loss = 16.38953
2023-09-24 11:05:08.845810 Epoch 125  	Train Loss = 15.72470 Val Loss = 16.42676
2023-09-24 11:05:20.129536 Epoch 126  	Train Loss = 15.72598 Val Loss = 16.40555
2023-09-24 11:05:31.409454 Epoch 127  	Train Loss = 15.72398 Val Loss = 16.38600
2023-09-24 11:05:42.977381 Epoch 128  	Train Loss = 15.73023 Val Loss = 16.39477
2023-09-24 11:05:54.300687 Epoch 129  	Train Loss = 15.73169 Val Loss = 16.39363
2023-09-24 11:06:05.632552 Epoch 130  	Train Loss = 15.70816 Val Loss = 16.41151
2023-09-24 11:06:16.826415 Epoch 131  	Train Loss = 15.71584 Val Loss = 16.40006
2023-09-24 11:06:27.885700 Epoch 132  	Train Loss = 15.72261 Val Loss = 16.39266
2023-09-24 11:06:39.138707 Epoch 133  	Train Loss = 15.70266 Val Loss = 16.38906
2023-09-24 11:06:50.617487 Epoch 134  	Train Loss = 15.72669 Val Loss = 16.39453
Early stopping at epoch: 134
Best at epoch 114:
Train Loss = 15.74229
Train RMSE = 25.62744, MAE = 15.76413, MAPE = 10.26973
Val Loss = 16.36851
Val RMSE = 27.05016, MAE = 16.84656, MAPE = 13.97733
--------- Test ---------
All Steps RMSE = 25.58992, MAE = 16.40524, MAPE = 10.81599
Step 1 RMSE = 21.46852, MAE = 14.09120, MAPE = 9.76242
Step 2 RMSE = 22.68807, MAE = 14.74678, MAPE = 10.00962
Step 3 RMSE = 23.61798, MAE = 15.26159, MAPE = 10.21610
Step 4 RMSE = 24.31811, MAE = 15.63079, MAPE = 10.44256
Step 5 RMSE = 24.92466, MAE = 15.97017, MAPE = 10.56860
Step 6 RMSE = 25.49975, MAE = 16.31062, MAPE = 10.74807
Step 7 RMSE = 26.09677, MAE = 16.69386, MAPE = 10.92945
Step 8 RMSE = 26.61695, MAE = 17.04235, MAPE = 11.08271
Step 9 RMSE = 27.03350, MAE = 17.31833, MAPE = 11.22927
Step 10 RMSE = 27.41987, MAE = 17.56917, MAPE = 11.37946
Step 11 RMSE = 27.86345, MAE = 17.87839, MAPE = 11.57596
Step 12 RMSE = 28.51833, MAE = 18.34970, MAPE = 11.84772
Inference time: 1.68 s
